var xo=Object.defineProperty;var Eo=(e,t,r)=>t in e?xo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var kt=(e,t,r)=>(Eo(e,typeof t!="symbol"?t+"":t,r),r);import{u as So,a as Oo,r as Q,c as Co,b as Cn,g as la,i as Do,d as Io,j as lt,e as Vt,f as Ke,h as ca,k as ua,o as da,m as Dn,l as Ye,n as Ao,p as Po,q as jo,A as Ro,P as fa,s as In,B as ha,t as pa,v as Er,R as No,_ as Bo,w as se}from"./input.js";function Fo(e){const{theme:t}=So(),r=Oo();return Q.useMemo(()=>Co(t.direction,{...r,...e}),[e,t.direction,r])}function To(e){return Q.Children.toArray(e).filter(t=>Q.isValidElement(t))}function yn(e,t,r,n){const i=Cn(r);return Q.useEffect(()=>{const a=typeof e=="function"?e():e??document;if(!(!r||!a))return a.addEventListener(t,i,n),()=>{a.removeEventListener(t,i,n)}},[t,e,n,i,r]),()=>{const a=typeof e=="function"?e():e??document;a==null||a.removeEventListener(t,i,n)}}var ma={exports:{}},zo="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Wo=zo,Lo=Wo;function ya(){}function ga(){}ga.resetWarningCache=ya;var Mo=function(){function e(n,i,a,s,o,l){if(l!==Lo){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ga,resetWarningCache:ya};return r.PropTypes=r,r};ma.exports=Mo();var Uo=ma.exports;const ye=la(Uo);function Ko(e){const t=e.ownerDocument.defaultView||window,{overflow:r,overflowX:n,overflowY:i}=t.getComputedStyle(e);return/auto|scroll|overlay|hidden/.test(r+i+n)}function $o(e){return e.localName==="html"?e:e.assignedSlot||e.parentElement||e.ownerDocument.documentElement}function va(e){return["html","body","#document"].includes(e.localName)?e.ownerDocument.body:Do(e)&&Ko(e)?e:va($o(e))}function qo(e,t){return Array.isArray(e)?e.map(r=>r===null?null:t(r)):Io(e)?Object.keys(e).reduce((r,n)=>(r[n]=t(e[n]),r),{}):e!=null?t(e):null}var wa=e=>lt.jsx(Vt.div,{className:"chakra-stack__item",...e,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...e.__css}});wa.displayName="StackItem";function Ho(e){const{spacing:t,direction:r}=e,n={column:{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:t,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:t,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":qo(r,i=>n[i])}}var ui=Ke((e,t)=>{const{isInline:r,direction:n,align:i,justify:a,spacing:s="0.5rem",wrap:o,children:l,divider:d,className:c,shouldWrapChildren:h,...p}=e,u=r?"row":n??"column",b=Q.useMemo(()=>Ho({spacing:s,direction:u}),[s,u]),f=!!d,v=!h&&!f,y=Q.useMemo(()=>{const _=To(l);return v?_:_.map((k,x)=>{const I=typeof k.key<"u"?k.key:x,O=x+1===_.length,D=h?lt.jsx(wa,{children:k},I):k;if(!f)return D;const j=Q.cloneElement(d,{__css:b}),M=O?null:j;return lt.jsxs(Q.Fragment,{children:[D,M]},I)})},[d,b,f,v,h,l]),w=ca("chakra-stack",c);return lt.jsx(Vt.div,{ref:t,display:"flex",alignItems:i,justifyContent:a,flexDirection:u,flexWrap:o,gap:f?void 0:s,className:w,...p,children:y})});ui.displayName="Stack";var ba=Ke((e,t)=>lt.jsx(ui,{align:"center",...e,direction:"row",ref:t}));ba.displayName="HStack";var _a=Ke(function(t,r){const n=ua("Heading",t),{className:i,...a}=da(t);return lt.jsx(Vt.h2,{ref:r,className:ca("chakra-heading",t.className),...a,__css:n})});_a.displayName="Heading";var di=Vt("div");di.displayName="Box";var ka=Ke(function(t,r){const{size:n,centerContent:i=!0,...a}=t,s=i?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return lt.jsx(di,{ref:r,boxSize:n,__css:{...s,flexShrink:0,flexGrow:0},...a})});ka.displayName="Square";var Zo=Ke(function(t,r){const{size:n,...i}=t;return lt.jsx(ka,{size:n,ref:r,borderRadius:"9999px",...i})});Zo.displayName="Circle";var Pe=(e,t)=>({var:e,varRef:t?`var(${e}, ${t})`:`var(${e})`}),Ct={arrowShadowColor:Pe("--popper-arrow-shadow-color"),arrowSize:Pe("--popper-arrow-size","8px"),arrowSizeHalf:Pe("--popper-arrow-size-half"),arrowBg:Pe("--popper-arrow-bg"),transformOrigin:Pe("--popper-transform-origin"),arrowOffset:Pe("--popper-arrow-offset")};function Vo(e){if(e.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(e.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var Yo={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},Go=e=>Yo[e],Ni={scroll:!0,resize:!0};function Jo(e){let t;return typeof e=="object"?t={enabled:!0,options:{...Ni,...e}}:t={enabled:e,options:Ni},t}var Xo={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:e})=>{e.styles.popper.width=`${e.rects.reference.width}px`},effect:({state:e})=>()=>{const t=e.elements.reference;e.elements.popper.style.width=`${t.offsetWidth}px`}},Qo={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:e})=>{Bi(e)},effect:({state:e})=>()=>{Bi(e)}},Bi=e=>{e.elements.popper.style.setProperty(Ct.transformOrigin.var,Go(e.placement))},ts={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:e})=>{es(e)}},es=e=>{var t;if(!e.placement)return;const r=rs(e.placement);if((t=e.elements)!=null&&t.arrow&&r){Object.assign(e.elements.arrow.style,{[r.property]:r.value,width:Ct.arrowSize.varRef,height:Ct.arrowSize.varRef,zIndex:-1});const n={[Ct.arrowSizeHalf.var]:`calc(${Ct.arrowSize.varRef} / 2 - 1px)`,[Ct.arrowOffset.var]:`calc(${Ct.arrowSizeHalf.varRef} * -1)`};for(const i in n)e.elements.arrow.style.setProperty(i,n[i])}},rs=e=>{if(e.startsWith("top"))return{property:"bottom",value:Ct.arrowOffset.varRef};if(e.startsWith("bottom"))return{property:"top",value:Ct.arrowOffset.varRef};if(e.startsWith("left"))return{property:"right",value:Ct.arrowOffset.varRef};if(e.startsWith("right"))return{property:"left",value:Ct.arrowOffset.varRef}},ns={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:e})=>{Fi(e)},effect:({state:e})=>()=>{Fi(e)}},Fi=e=>{if(!e.elements.arrow)return;const t=e.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!t)return;const r=Vo(e.placement);r&&t.style.setProperty("--popper-arrow-default-shadow",r),Object.assign(t.style,{transform:"rotate(45deg)",background:Ct.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},is={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},as={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function os(e,t="ltr"){var r,n;const i=((r=is[e])==null?void 0:r[t])||e;return t==="ltr"?i:(n=as[e])!=null?n:i}var jt="top",Ut="bottom",Kt="right",Rt="left",fi="auto",gr=[jt,Ut,Kt,Rt],ze="start",sr="end",ss="clippingParents",xa="viewport",Ge="popper",ls="reference",Ti=gr.reduce(function(e,t){return e.concat([t+"-"+ze,t+"-"+sr])},[]),Ea=[].concat(gr,[fi]).reduce(function(e,t){return e.concat([t,t+"-"+ze,t+"-"+sr])},[]),cs="beforeRead",us="read",ds="afterRead",fs="beforeMain",hs="main",ps="afterMain",ms="beforeWrite",ys="write",gs="afterWrite",vs=[cs,us,ds,fs,hs,ps,ms,ys,gs];function Gt(e){return e?(e.nodeName||"").toLowerCase():null}function Tt(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Oe(e){var t=Tt(e).Element;return e instanceof t||e instanceof Element}function Mt(e){var t=Tt(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function hi(e){if(typeof ShadowRoot>"u")return!1;var t=Tt(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function ws(e){var t=e.state;Object.keys(t.elements).forEach(function(r){var n=t.styles[r]||{},i=t.attributes[r]||{},a=t.elements[r];!Mt(a)||!Gt(a)||(Object.assign(a.style,n),Object.keys(i).forEach(function(s){var o=i[s];o===!1?a.removeAttribute(s):a.setAttribute(s,o===!0?"":o)}))})}function bs(e){var t=e.state,r={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,r.popper),t.styles=r,t.elements.arrow&&Object.assign(t.elements.arrow.style,r.arrow),function(){Object.keys(t.elements).forEach(function(n){var i=t.elements[n],a=t.attributes[n]||{},s=Object.keys(t.styles.hasOwnProperty(n)?t.styles[n]:r[n]),o=s.reduce(function(l,d){return l[d]="",l},{});!Mt(i)||!Gt(i)||(Object.assign(i.style,o),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const _s={name:"applyStyles",enabled:!0,phase:"write",fn:ws,effect:bs,requires:["computeStyles"]};function Yt(e){return e.split("-")[0]}var be=Math.max,Vr=Math.min,We=Math.round;function An(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function Sa(){return!/^((?!chrome|android).)*safari/i.test(An())}function Le(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),i=1,a=1;t&&Mt(e)&&(i=e.offsetWidth>0&&We(n.width)/e.offsetWidth||1,a=e.offsetHeight>0&&We(n.height)/e.offsetHeight||1);var s=Oe(e)?Tt(e):window,o=s.visualViewport,l=!Sa()&&r,d=(n.left+(l&&o?o.offsetLeft:0))/i,c=(n.top+(l&&o?o.offsetTop:0))/a,h=n.width/i,p=n.height/a;return{width:h,height:p,top:c,right:d+h,bottom:c+p,left:d,x:d,y:c}}function pi(e){var t=Le(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function Oa(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&hi(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ae(e){return Tt(e).getComputedStyle(e)}function ks(e){return["table","td","th"].indexOf(Gt(e))>=0}function me(e){return((Oe(e)?e.ownerDocument:e.document)||window.document).documentElement}function fn(e){return Gt(e)==="html"?e:e.assignedSlot||e.parentNode||(hi(e)?e.host:null)||me(e)}function zi(e){return!Mt(e)||ae(e).position==="fixed"?null:e.offsetParent}function xs(e){var t=/firefox/i.test(An()),r=/Trident/i.test(An());if(r&&Mt(e)){var n=ae(e);if(n.position==="fixed")return null}var i=fn(e);for(hi(i)&&(i=i.host);Mt(i)&&["html","body"].indexOf(Gt(i))<0;){var a=ae(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function vr(e){for(var t=Tt(e),r=zi(e);r&&ks(r)&&ae(r).position==="static";)r=zi(r);return r&&(Gt(r)==="html"||Gt(r)==="body"&&ae(r).position==="static")?t:r||xs(e)||t}function mi(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function tr(e,t,r){return be(e,Vr(t,r))}function Es(e,t,r){var n=tr(e,t,r);return n>r?r:n}function Ca(){return{top:0,right:0,bottom:0,left:0}}function Da(e){return Object.assign({},Ca(),e)}function Ia(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var Ss=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,Da(typeof t!="number"?t:Ia(t,gr))};function Os(e){var t,r=e.state,n=e.name,i=e.options,a=r.elements.arrow,s=r.modifiersData.popperOffsets,o=Yt(r.placement),l=mi(o),d=[Rt,Kt].indexOf(o)>=0,c=d?"height":"width";if(!(!a||!s)){var h=Ss(i.padding,r),p=pi(a),u=l==="y"?jt:Rt,b=l==="y"?Ut:Kt,f=r.rects.reference[c]+r.rects.reference[l]-s[l]-r.rects.popper[c],v=s[l]-r.rects.reference[l],y=vr(a),w=y?l==="y"?y.clientHeight||0:y.clientWidth||0:0,_=f/2-v/2,k=h[u],x=w-p[c]-h[b],I=w/2-p[c]/2+_,O=tr(k,I,x),R=l;r.modifiersData[n]=(t={},t[R]=O,t.centerOffset=O-I,t)}}function Cs(e){var t=e.state,r=e.options,n=r.element,i=n===void 0?"[data-popper-arrow]":n;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||Oa(t.elements.popper,i)&&(t.elements.arrow=i))}const Ds={name:"arrow",enabled:!0,phase:"main",fn:Os,effect:Cs,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Me(e){return e.split("-")[1]}var Is={top:"auto",right:"auto",bottom:"auto",left:"auto"};function As(e,t){var r=e.x,n=e.y,i=t.devicePixelRatio||1;return{x:We(r*i)/i||0,y:We(n*i)/i||0}}function Wi(e){var t,r=e.popper,n=e.popperRect,i=e.placement,a=e.variation,s=e.offsets,o=e.position,l=e.gpuAcceleration,d=e.adaptive,c=e.roundOffsets,h=e.isFixed,p=s.x,u=p===void 0?0:p,b=s.y,f=b===void 0?0:b,v=typeof c=="function"?c({x:u,y:f}):{x:u,y:f};u=v.x,f=v.y;var y=s.hasOwnProperty("x"),w=s.hasOwnProperty("y"),_=Rt,k=jt,x=window;if(d){var I=vr(r),O="clientHeight",R="clientWidth";if(I===Tt(r)&&(I=me(r),ae(I).position!=="static"&&o==="absolute"&&(O="scrollHeight",R="scrollWidth")),I=I,i===jt||(i===Rt||i===Kt)&&a===sr){k=Ut;var D=h&&I===x&&x.visualViewport?x.visualViewport.height:I[O];f-=D-n.height,f*=l?1:-1}if(i===Rt||(i===jt||i===Ut)&&a===sr){_=Kt;var j=h&&I===x&&x.visualViewport?x.visualViewport.width:I[R];u-=j-n.width,u*=l?1:-1}}var M=Object.assign({position:o},d&&Is),C=c===!0?As({x:u,y:f},Tt(r)):{x:u,y:f};if(u=C.x,f=C.y,l){var B;return Object.assign({},M,(B={},B[k]=w?"0":"",B[_]=y?"0":"",B.transform=(x.devicePixelRatio||1)<=1?"translate("+u+"px, "+f+"px)":"translate3d("+u+"px, "+f+"px, 0)",B))}return Object.assign({},M,(t={},t[k]=w?f+"px":"",t[_]=y?u+"px":"",t.transform="",t))}function Ps(e){var t=e.state,r=e.options,n=r.gpuAcceleration,i=n===void 0?!0:n,a=r.adaptive,s=a===void 0?!0:a,o=r.roundOffsets,l=o===void 0?!0:o,d={placement:Yt(t.placement),variation:Me(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Wi(Object.assign({},d,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Wi(Object.assign({},d,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const js={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ps,data:{}};var Sr={passive:!0};function Rs(e){var t=e.state,r=e.instance,n=e.options,i=n.scroll,a=i===void 0?!0:i,s=n.resize,o=s===void 0?!0:s,l=Tt(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&d.forEach(function(c){c.addEventListener("scroll",r.update,Sr)}),o&&l.addEventListener("resize",r.update,Sr),function(){a&&d.forEach(function(c){c.removeEventListener("scroll",r.update,Sr)}),o&&l.removeEventListener("resize",r.update,Sr)}}const Ns={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Rs,data:{}};var Bs={left:"right",right:"left",bottom:"top",top:"bottom"};function Br(e){return e.replace(/left|right|bottom|top/g,function(t){return Bs[t]})}var Fs={start:"end",end:"start"};function Li(e){return e.replace(/start|end/g,function(t){return Fs[t]})}function yi(e){var t=Tt(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function gi(e){return Le(me(e)).left+yi(e).scrollLeft}function Ts(e,t){var r=Tt(e),n=me(e),i=r.visualViewport,a=n.clientWidth,s=n.clientHeight,o=0,l=0;if(i){a=i.width,s=i.height;var d=Sa();(d||!d&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:a,height:s,x:o+gi(e),y:l}}function zs(e){var t,r=me(e),n=yi(e),i=(t=e.ownerDocument)==null?void 0:t.body,a=be(r.scrollWidth,r.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=be(r.scrollHeight,r.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),o=-n.scrollLeft+gi(e),l=-n.scrollTop;return ae(i||r).direction==="rtl"&&(o+=be(r.clientWidth,i?i.clientWidth:0)-a),{width:a,height:s,x:o,y:l}}function vi(e){var t=ae(e),r=t.overflow,n=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+i+n)}function Aa(e){return["html","body","#document"].indexOf(Gt(e))>=0?e.ownerDocument.body:Mt(e)&&vi(e)?e:Aa(fn(e))}function er(e,t){var r;t===void 0&&(t=[]);var n=Aa(e),i=n===((r=e.ownerDocument)==null?void 0:r.body),a=Tt(n),s=i?[a].concat(a.visualViewport||[],vi(n)?n:[]):n,o=t.concat(s);return i?o:o.concat(er(fn(s)))}function Pn(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Ws(e,t){var r=Le(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function Mi(e,t,r){return t===xa?Pn(Ts(e,r)):Oe(t)?Ws(t,r):Pn(zs(me(e)))}function Ls(e){var t=er(fn(e)),r=["absolute","fixed"].indexOf(ae(e).position)>=0,n=r&&Mt(e)?vr(e):e;return Oe(n)?t.filter(function(i){return Oe(i)&&Oa(i,n)&&Gt(i)!=="body"}):[]}function Ms(e,t,r,n){var i=t==="clippingParents"?Ls(e):[].concat(t),a=[].concat(i,[r]),s=a[0],o=a.reduce(function(l,d){var c=Mi(e,d,n);return l.top=be(c.top,l.top),l.right=Vr(c.right,l.right),l.bottom=Vr(c.bottom,l.bottom),l.left=be(c.left,l.left),l},Mi(e,s,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function Pa(e){var t=e.reference,r=e.element,n=e.placement,i=n?Yt(n):null,a=n?Me(n):null,s=t.x+t.width/2-r.width/2,o=t.y+t.height/2-r.height/2,l;switch(i){case jt:l={x:s,y:t.y-r.height};break;case Ut:l={x:s,y:t.y+t.height};break;case Kt:l={x:t.x+t.width,y:o};break;case Rt:l={x:t.x-r.width,y:o};break;default:l={x:t.x,y:t.y}}var d=i?mi(i):null;if(d!=null){var c=d==="y"?"height":"width";switch(a){case ze:l[d]=l[d]-(t[c]/2-r[c]/2);break;case sr:l[d]=l[d]+(t[c]/2-r[c]/2);break}}return l}function lr(e,t){t===void 0&&(t={});var r=t,n=r.placement,i=n===void 0?e.placement:n,a=r.strategy,s=a===void 0?e.strategy:a,o=r.boundary,l=o===void 0?ss:o,d=r.rootBoundary,c=d===void 0?xa:d,h=r.elementContext,p=h===void 0?Ge:h,u=r.altBoundary,b=u===void 0?!1:u,f=r.padding,v=f===void 0?0:f,y=Da(typeof v!="number"?v:Ia(v,gr)),w=p===Ge?ls:Ge,_=e.rects.popper,k=e.elements[b?w:p],x=Ms(Oe(k)?k:k.contextElement||me(e.elements.popper),l,c,s),I=Le(e.elements.reference),O=Pa({reference:I,element:_,strategy:"absolute",placement:i}),R=Pn(Object.assign({},_,O)),D=p===Ge?R:I,j={top:x.top-D.top+y.top,bottom:D.bottom-x.bottom+y.bottom,left:x.left-D.left+y.left,right:D.right-x.right+y.right},M=e.modifiersData.offset;if(p===Ge&&M){var C=M[i];Object.keys(j).forEach(function(B){var g=[Kt,Ut].indexOf(B)>=0?1:-1,L=[jt,Ut].indexOf(B)>=0?"y":"x";j[B]+=C[L]*g})}return j}function Us(e,t){t===void 0&&(t={});var r=t,n=r.placement,i=r.boundary,a=r.rootBoundary,s=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,d=l===void 0?Ea:l,c=Me(n),h=c?o?Ti:Ti.filter(function(b){return Me(b)===c}):gr,p=h.filter(function(b){return d.indexOf(b)>=0});p.length===0&&(p=h);var u=p.reduce(function(b,f){return b[f]=lr(e,{placement:f,boundary:i,rootBoundary:a,padding:s})[Yt(f)],b},{});return Object.keys(u).sort(function(b,f){return u[b]-u[f]})}function Ks(e){if(Yt(e)===fi)return[];var t=Br(e);return[Li(e),t,Li(t)]}function $s(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!0:s,l=r.fallbackPlacements,d=r.padding,c=r.boundary,h=r.rootBoundary,p=r.altBoundary,u=r.flipVariations,b=u===void 0?!0:u,f=r.allowedAutoPlacements,v=t.options.placement,y=Yt(v),w=y===v,_=l||(w||!b?[Br(v)]:Ks(v)),k=[v].concat(_).reduce(function(J,q){return J.concat(Yt(q)===fi?Us(t,{placement:q,boundary:c,rootBoundary:h,padding:d,flipVariations:b,allowedAutoPlacements:f}):q)},[]),x=t.rects.reference,I=t.rects.popper,O=new Map,R=!0,D=k[0],j=0;j<k.length;j++){var M=k[j],C=Yt(M),B=Me(M)===ze,g=[jt,Ut].indexOf(C)>=0,L=g?"width":"height",tt=lr(t,{placement:M,boundary:c,rootBoundary:h,altBoundary:p,padding:d}),A=g?B?Kt:Rt:B?Ut:jt;x[L]>I[L]&&(A=Br(A));var Z=Br(A),z=[];if(a&&z.push(tt[C]<=0),o&&z.push(tt[A]<=0,tt[Z]<=0),z.every(function(J){return J})){D=M,R=!1;break}O.set(M,z)}if(R)for(var H=b?3:1,F=function(q){var ht=k.find(function(vt){var st=O.get(vt);if(st)return st.slice(0,q).every(function(dt){return dt})});if(ht)return D=ht,"break"},N=H;N>0;N--){var nt=F(N);if(nt==="break")break}t.placement!==D&&(t.modifiersData[n]._skip=!0,t.placement=D,t.reset=!0)}}const qs={name:"flip",enabled:!0,phase:"main",fn:$s,requiresIfExists:["offset"],data:{_skip:!1}};function Ui(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Ki(e){return[jt,Kt,Ut,Rt].some(function(t){return e[t]>=0})}function Hs(e){var t=e.state,r=e.name,n=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,s=lr(t,{elementContext:"reference"}),o=lr(t,{altBoundary:!0}),l=Ui(s,n),d=Ui(o,i,a),c=Ki(l),h=Ki(d);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:d,isReferenceHidden:c,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}const Zs={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Hs};function Vs(e,t,r){var n=Yt(e),i=[Rt,jt].indexOf(n)>=0?-1:1,a=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,s=a[0],o=a[1];return s=s||0,o=(o||0)*i,[Rt,Kt].indexOf(n)>=0?{x:o,y:s}:{x:s,y:o}}function Ys(e){var t=e.state,r=e.options,n=e.name,i=r.offset,a=i===void 0?[0,0]:i,s=Ea.reduce(function(c,h){return c[h]=Vs(h,t.rects,a),c},{}),o=s[t.placement],l=o.x,d=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=d),t.modifiersData[n]=s}const Gs={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Ys};function Js(e){var t=e.state,r=e.name;t.modifiersData[r]=Pa({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const Xs={name:"popperOffsets",enabled:!0,phase:"read",fn:Js,data:{}};function Qs(e){return e==="x"?"y":"x"}function tl(e){var t=e.state,r=e.options,n=e.name,i=r.mainAxis,a=i===void 0?!0:i,s=r.altAxis,o=s===void 0?!1:s,l=r.boundary,d=r.rootBoundary,c=r.altBoundary,h=r.padding,p=r.tether,u=p===void 0?!0:p,b=r.tetherOffset,f=b===void 0?0:b,v=lr(t,{boundary:l,rootBoundary:d,padding:h,altBoundary:c}),y=Yt(t.placement),w=Me(t.placement),_=!w,k=mi(y),x=Qs(k),I=t.modifiersData.popperOffsets,O=t.rects.reference,R=t.rects.popper,D=typeof f=="function"?f(Object.assign({},t.rects,{placement:t.placement})):f,j=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),M=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,C={x:0,y:0};if(I){if(a){var B,g=k==="y"?jt:Rt,L=k==="y"?Ut:Kt,tt=k==="y"?"height":"width",A=I[k],Z=A+v[g],z=A-v[L],H=u?-R[tt]/2:0,F=w===ze?O[tt]:R[tt],N=w===ze?-R[tt]:-O[tt],nt=t.elements.arrow,J=u&&nt?pi(nt):{width:0,height:0},q=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Ca(),ht=q[g],vt=q[L],st=tr(0,O[tt],J[tt]),dt=_?O[tt]/2-H-st-ht-j.mainAxis:F-st-ht-j.mainAxis,_t=_?-O[tt]/2+H+st+vt+j.mainAxis:N+st+vt+j.mainAxis,mt=t.elements.arrow&&vr(t.elements.arrow),ft=mt?k==="y"?mt.clientTop||0:mt.clientLeft||0:0,bt=(B=M==null?void 0:M[k])!=null?B:0,m=A+dt-bt-ft,U=A+_t-bt,W=tr(u?Vr(Z,m):Z,A,u?be(z,U):z);I[k]=W,C[k]=W-A}if(o){var S,E=k==="x"?jt:Rt,P=k==="x"?Ut:Kt,K=I[x],$=x==="y"?"height":"width",T=K+v[E],V=K-v[P],et=[jt,Rt].indexOf(y)!==-1,Y=(S=M==null?void 0:M[x])!=null?S:0,it=et?T:K-O[$]-R[$]-Y+j.altAxis,pt=et?K+O[$]+R[$]-Y-j.altAxis:V,ut=u&&et?Es(it,K,pt):tr(u?it:T,K,u?pt:V);I[x]=ut,C[x]=ut-K}t.modifiersData[n]=C}}const el={name:"preventOverflow",enabled:!0,phase:"main",fn:tl,requiresIfExists:["offset"]};function rl(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function nl(e){return e===Tt(e)||!Mt(e)?yi(e):rl(e)}function il(e){var t=e.getBoundingClientRect(),r=We(t.width)/e.offsetWidth||1,n=We(t.height)/e.offsetHeight||1;return r!==1||n!==1}function al(e,t,r){r===void 0&&(r=!1);var n=Mt(t),i=Mt(t)&&il(t),a=me(t),s=Le(e,i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((Gt(t)!=="body"||vi(a))&&(o=nl(t)),Mt(t)?(l=Le(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):a&&(l.x=gi(a))),{x:s.left+o.scrollLeft-l.x,y:s.top+o.scrollTop-l.y,width:s.width,height:s.height}}function ol(e){var t=new Map,r=new Set,n=[];e.forEach(function(a){t.set(a.name,a)});function i(a){r.add(a.name);var s=[].concat(a.requires||[],a.requiresIfExists||[]);s.forEach(function(o){if(!r.has(o)){var l=t.get(o);l&&i(l)}}),n.push(a)}return e.forEach(function(a){r.has(a.name)||i(a)}),n}function sl(e){var t=ol(e);return vs.reduce(function(r,n){return r.concat(t.filter(function(i){return i.phase===n}))},[])}function ll(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function cl(e){var t=e.reduce(function(r,n){var i=r[n.name];return r[n.name]=i?Object.assign({},i,n,{options:Object.assign({},i.options,n.options),data:Object.assign({},i.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var $i={placement:"bottom",modifiers:[],strategy:"absolute"};function qi(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function ul(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,i=t.defaultOptions,a=i===void 0?$i:i;return function(o,l,d){d===void 0&&(d=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},$i,a),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},h=[],p=!1,u={state:c,setOptions:function(y){var w=typeof y=="function"?y(c.options):y;f(),c.options=Object.assign({},a,c.options,w),c.scrollParents={reference:Oe(o)?er(o):o.contextElement?er(o.contextElement):[],popper:er(l)};var _=sl(cl([].concat(n,c.options.modifiers)));return c.orderedModifiers=_.filter(function(k){return k.enabled}),b(),u.update()},forceUpdate:function(){if(!p){var y=c.elements,w=y.reference,_=y.popper;if(qi(w,_)){c.rects={reference:al(w,vr(_),c.options.strategy==="fixed"),popper:pi(_)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(j){return c.modifiersData[j.name]=Object.assign({},j.data)});for(var k=0;k<c.orderedModifiers.length;k++){if(c.reset===!0){c.reset=!1,k=-1;continue}var x=c.orderedModifiers[k],I=x.fn,O=x.options,R=O===void 0?{}:O,D=x.name;typeof I=="function"&&(c=I({state:c,options:R,name:D,instance:u})||c)}}}},update:ll(function(){return new Promise(function(v){u.forceUpdate(),v(c)})}),destroy:function(){f(),p=!0}};if(!qi(o,l))return u;u.setOptions(d).then(function(v){!p&&d.onFirstUpdate&&d.onFirstUpdate(v)});function b(){c.orderedModifiers.forEach(function(v){var y=v.name,w=v.options,_=w===void 0?{}:w,k=v.effect;if(typeof k=="function"){var x=k({state:c,name:y,instance:u,options:_}),I=function(){};h.push(x||I)}})}function f(){h.forEach(function(v){return v()}),h=[]}return u}}var dl=[Ns,Xs,js,_s,Gs,qs,el,Ds,Zs],fl=ul({defaultModifiers:dl});function hl(e={}){const{enabled:t=!0,modifiers:r,placement:n="bottom",strategy:i="absolute",arrowPadding:a=8,eventListeners:s=!0,offset:o,gutter:l=8,flip:d=!0,boundary:c="clippingParents",preventOverflow:h=!0,matchWidth:p,direction:u="ltr"}=e,b=Q.useRef(null),f=Q.useRef(null),v=Q.useRef(null),y=os(n,u),w=Q.useRef(()=>{}),_=Q.useCallback(()=>{var j;!t||!b.current||!f.current||((j=w.current)==null||j.call(w),v.current=fl(b.current,f.current,{placement:y,modifiers:[ns,ts,Qo,{...Xo,enabled:!!p},{name:"eventListeners",...Jo(s)},{name:"arrow",options:{padding:a}},{name:"offset",options:{offset:o??[0,l]}},{name:"flip",enabled:!!d,options:{padding:8}},{name:"preventOverflow",enabled:!!h,options:{boundary:c}},...r??[]],strategy:i}),v.current.forceUpdate(),w.current=v.current.destroy)},[y,t,r,p,s,a,o,l,d,h,c,i]);Q.useEffect(()=>()=>{var j;!b.current&&!f.current&&((j=v.current)==null||j.destroy(),v.current=null)},[]);const k=Q.useCallback(j=>{b.current=j,_()},[_]),x=Q.useCallback((j={},M=null)=>({...j,ref:Dn(k,M)}),[k]),I=Q.useCallback(j=>{f.current=j,_()},[_]),O=Q.useCallback((j={},M=null)=>({...j,ref:Dn(I,M),style:{...j.style,position:i,minWidth:p?void 0:"max-content",inset:"0 auto auto 0"}}),[i,I,p]),R=Q.useCallback((j={},M=null)=>{const{size:C,shadowColor:B,bg:g,style:L,...tt}=j;return{...tt,ref:M,"data-popper-arrow":"",style:pl(j)}},[]),D=Q.useCallback((j={},M=null)=>({...j,ref:M,"data-popper-arrow-inner":""}),[]);return{update(){var j;(j=v.current)==null||j.update()},forceUpdate(){var j;(j=v.current)==null||j.forceUpdate()},transformOrigin:Ct.transformOrigin.varRef,referenceRef:k,popperRef:I,getPopperProps:O,getArrowProps:R,getArrowInnerProps:D,getReferenceProps:x}}function pl(e){const{size:t,shadowColor:r,bg:n,style:i}=e,a={...i,position:"absolute"};return t&&(a["--popper-arrow-size"]=t),r&&(a["--popper-arrow-shadow-color"]=r),n&&(a["--popper-arrow-bg"]=n),a}function ml(e={}){const{onClose:t,onOpen:r,isOpen:n,id:i}=e,a=Cn(r),s=Cn(t),[o,l]=Q.useState(e.defaultIsOpen||!1),d=n!==void 0?n:o,c=n!==void 0,h=Q.useId(),p=i??`disclosure-${h}`,u=Q.useCallback(()=>{c||l(!1),s==null||s()},[c,s]),b=Q.useCallback(()=>{c||l(!0),a==null||a()},[c,a]),f=Q.useCallback(()=>{d?u():b()},[d,b,u]);function v(w={}){return{...w,"aria-expanded":d,"aria-controls":p,onClick(_){var k;(k=w.onClick)==null||k.call(w,_),f()}}}function y(w={}){return{...w,hidden:!d,id:p}}return{isOpen:d,onOpen:b,onClose:u,onToggle:f,isControlled:c,getButtonProps:v,getDisclosureProps:y}}var yl={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},jn=e=>{var t;return((t=e.current)==null?void 0:t.ownerDocument)||document},Fr=e=>{var t,r;return((r=(t=e.current)==null?void 0:t.ownerDocument)==null?void 0:r.defaultView)||window};function gl(e={}){const{openDelay:t=0,closeDelay:r=0,closeOnClick:n=!0,closeOnMouseDown:i,closeOnScroll:a,closeOnPointerDown:s=i,closeOnEsc:o=!0,onOpen:l,onClose:d,placement:c,id:h,isOpen:p,defaultIsOpen:u,arrowSize:b=10,arrowShadowColor:f,arrowPadding:v,modifiers:y,isDisabled:w,gutter:_,offset:k,direction:x,...I}=e,{isOpen:O,onOpen:R,onClose:D}=ml({isOpen:p,defaultIsOpen:u,onOpen:l,onClose:d}),{referenceRef:j,getPopperProps:M,getArrowInnerProps:C,getArrowProps:B}=hl({enabled:O,placement:c,arrowPadding:v,modifiers:y,gutter:_,offset:k,direction:x}),g=Q.useId(),tt=`tooltip-${h??g}`,A=Q.useRef(null),Z=Q.useRef(),z=Q.useCallback(()=>{Z.current&&(clearTimeout(Z.current),Z.current=void 0)},[]),H=Q.useRef(),F=Q.useCallback(()=>{H.current&&(clearTimeout(H.current),H.current=void 0)},[]),N=Q.useCallback(()=>{F(),D()},[D,F]),nt=vl(A,N),J=Q.useCallback(()=>{if(!w&&!Z.current){O&&nt();const ft=Fr(A);Z.current=ft.setTimeout(R,t)}},[nt,w,O,R,t]),q=Q.useCallback(()=>{z();const ft=Fr(A);H.current=ft.setTimeout(N,r)},[r,N,z]),ht=Q.useCallback(()=>{O&&n&&q()},[n,q,O]),vt=Q.useCallback(()=>{O&&s&&q()},[s,q,O]),st=Q.useCallback(ft=>{O&&ft.key==="Escape"&&q()},[O,q]);yn(()=>jn(A),"keydown",o?st:void 0),yn(()=>{if(!a)return null;const ft=A.current;if(!ft)return null;const bt=va(ft);return bt.localName==="body"?Fr(A):bt},"scroll",()=>{O&&a&&N()},{passive:!0,capture:!0}),Q.useEffect(()=>{w&&(z(),O&&D())},[w,O,D,z]),Q.useEffect(()=>()=>{z(),F()},[z,F]),yn(()=>A.current,"pointerleave",q);const dt=Q.useCallback((ft={},bt=null)=>({...ft,ref:Dn(A,bt,j),onPointerEnter:Ye(ft.onPointerEnter,U=>{U.pointerType!=="touch"&&J()}),onClick:Ye(ft.onClick,ht),onPointerDown:Ye(ft.onPointerDown,vt),onFocus:Ye(ft.onFocus,J),onBlur:Ye(ft.onBlur,q),"aria-describedby":O?tt:void 0}),[J,q,vt,O,tt,ht,j]),_t=Q.useCallback((ft={},bt=null)=>M({...ft,style:{...ft.style,[Ct.arrowSize.var]:b?`${b}px`:void 0,[Ct.arrowShadowColor.var]:f}},bt),[M,b,f]),mt=Q.useCallback((ft={},bt=null)=>{const m={...ft.style,position:"relative",transformOrigin:Ct.transformOrigin.varRef};return{ref:bt,...I,...ft,id:tt,role:"tooltip",style:m}},[I,tt]);return{isOpen:O,show:J,hide:q,getTriggerProps:dt,getTooltipProps:mt,getTooltipPositionerProps:_t,getArrowProps:B,getArrowInnerProps:C}}var gn="chakra-ui:close-tooltip";function vl(e,t){return Q.useEffect(()=>{const r=jn(e);return r.addEventListener(gn,t),()=>r.removeEventListener(gn,t)},[t,e]),()=>{const r=jn(e),n=Fr(e);r.dispatchEvent(new n.CustomEvent(gn))}}function wl(e,t=[]){const r=Object.assign({},e);for(const n of t)n in r&&delete r[n];return r}function bl(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}var _l=Vt(Ao.div),ja=Ke((e,t)=>{var r,n;const i=ua("Tooltip",e),a=da(e),s=Po(),{children:o,label:l,shouldWrapChildren:d,"aria-label":c,hasArrow:h,bg:p,portalProps:u,background:b,backgroundColor:f,bgColor:v,motionProps:y,...w}=a,_=(n=(r=b??f)!=null?r:p)!=null?n:v;if(_){i.bg=_;const M=jo(s,"colors",_);i[Ct.arrowBg.var]=M}const k=gl({...w,direction:s.direction}),x=typeof o=="string"||d;let I;if(x)I=lt.jsx(Vt.span,{display:"inline-block",tabIndex:0,...k.getTriggerProps(),children:o});else{const M=Q.Children.only(o);I=Q.cloneElement(M,k.getTriggerProps(M.props,M.ref))}const O=!!c,R=k.getTooltipProps({},t),D=O?wl(R,["role","id"]):R,j=bl(R,["role","id"]);return l?lt.jsxs(lt.Fragment,{children:[I,lt.jsx(Ro,{children:k.isOpen&&lt.jsx(fa,{...u,children:lt.jsx(Vt.div,{...k.getTooltipPositionerProps(),__css:{zIndex:i.zIndex,pointerEvents:"none"},children:lt.jsxs(_l,{variants:yl,initial:"exit",animate:"enter",exit:"exit",...y,...D,__css:i,children:[l,O&&lt.jsx(Vt.span,{srOnly:!0,...j,children:c}),h&&lt.jsx(Vt.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:lt.jsx(Vt.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:i.bg}})})]})})})})]}):lt.jsx(lt.Fragment,{children:o})});ja.displayName="Tooltip";const kl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let cr=(e=21)=>{let t="",r=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=kl[r[e]&63];return t};function St(e,t){if(In==null)throw console.error("api is null!"),new Error("api is null!");return In.fetchApi(e,t)}async function xl(e){console.warn("[workspace deprecated] getDB is deprecated",e);try{const t=await St(`/workspace/get_db?table=${e}`);return t.ok?await t.json():void 0}catch(t){console.error("Error fetching workspace:",t);return}}async function El(){const t=await(await St("/workspace/get_my_workflows_dir")).json();return t.error&&alert(`Failed to fetch my workflows path: ${t.error}`),t}const Sl="backup",Yr="workspace";let Or=null;function Ol(){return new Promise((e,t)=>{const r=indexedDB.open("WorkspaceDB",3);r.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(Yr)||i.createObjectStore(Yr,{keyPath:"id"})},r.onsuccess=n=>{e(n.target.result)},r.onerror=n=>{t(n.target.error)}})}async function Cl(){try{return Or==null&&(Or=await Ol()),new Promise((e,t)=>{if(Or==null)return t("indexDB is null");const i=Or.transaction([Yr],"readonly").objectStore(Yr).get(Sl);i.onsuccess=()=>{i.result?e(i.result.value):e(void 0)},i.onerror=()=>t(i.error)})}catch(e){console.error("Error while reading from database:",e)}}async function Dl(){try{return await Cl()}catch(e){console.error("Error retrieving data from IndexedDB:",e)}}const gt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Et=Object.keys,It=Array.isArray;function Pt(e,t){return typeof t!="object"||Et(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||gt.Promise||(gt.Promise=Promise);const ur=Object.getPrototypeOf,Il={}.hasOwnProperty;function zt(e,t){return Il.call(e,t)}function Ue(e,t){typeof t=="function"&&(t=t(ur(e))),(typeof Reflect>"u"?Et:Reflect.ownKeys)(t).forEach(r=>{ne(e,r,t[r])})}const Ra=Object.defineProperty;function ne(e,t,r,n){Ra(e,t,Pt(r&&zt(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Be(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ne(e.prototype,"constructor",e),{extend:Ue.bind(null,e.prototype)}}}}const Al=Object.getOwnPropertyDescriptor;function wi(e,t){let r;return Al(e,t)||(r=ur(e))&&wi(r,t)}const Pl=[].slice;function Gr(e,t,r){return Pl.call(e,t,r)}function Na(e,t){return t(e)}function Xe(e){if(!e)throw new Error("Assertion Failed")}function Ba(e){gt.setImmediate?setImmediate(e):setTimeout(e,0)}function Fa(e,t){return e.reduce((r,n,i)=>{var a=t(n,i);return a&&(r[a[0]]=a[1]),r},{})}function ie(e,t){if(zt(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,i=t.length;n<i;++n){var a=ie(e,t[n]);r.push(a)}return r}var s=t.indexOf(".");if(s!==-1){var o=e[t.substr(0,s)];return o===void 0?void 0:ie(o,t.substr(s+1))}}function $t(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Xe(typeof r!="string"&&"length"in r);for(var n=0,i=t.length;n<i;++n)$t(e,t[n],r[n])}else{var a=t.indexOf(".");if(a!==-1){var s=t.substr(0,a),o=t.substr(a+1);if(o==="")r===void 0?It(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=r;else{var l=e[s];l&&zt(e,s)||(l=e[s]={}),$t(l,o,r)}}else r===void 0?It(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Ta(e){var t={};for(var r in e)zt(e,r)&&(t[r]=e[r]);return t}const jl=[].concat;function za(e){return jl.apply([],e)}const Wa="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(za([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>gt[e]),Rl=Wa.map(e=>gt[e]);Fa(Wa,e=>[e,!0]);let ce=null;function wr(e){ce=typeof WeakMap<"u"&&new WeakMap;const t=Rn(e);return ce=null,t}function Rn(e){if(!e||typeof e!="object")return e;let t=ce&&ce.get(e);if(t)return t;if(It(e)){t=[],ce&&ce.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(Rn(e[r]))}else if(Rl.indexOf(e.constructor)>=0)t=e;else{const a=ur(e);for(var i in t=a===Object.prototype?{}:Object.create(a),ce&&ce.set(e,t),e)zt(e,i)&&(t[i]=Rn(e[i]))}return t}const{toString:Nl}={};function Nn(e){return Nl.call(e).slice(8,-1)}const Bn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Bl=typeof Bn=="symbol"?function(e){var t;return e!=null&&(t=e[Bn])&&t.apply(e)}:function(){return null},Ne={};function ee(e){var t,r,n,i;if(arguments.length===1){if(It(e))return e.slice();if(this===Ne&&typeof e=="string")return[e];if(i=Bl(e)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const bi=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var Jt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function La(e,t){Jt=e,Ma=t}var Ma=()=>!0;const Fl=!new Error("").stack;function Ie(){if(Fl)try{throw Ie.arguments,new Error}catch(e){return e}return new Error}function Fn(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(Ma).map(n=>`
`+n).join("")):""}var Ua=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],_i=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ua),Tl={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Fe(e,t){this._e=Ie(),this.name=e,this.message=t}function Ka(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,i)=>i.indexOf(r)===n).join(`
`)}function Jr(e,t,r,n){this._e=Ie(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=Ka(e,t)}function rr(e,t){this._e=Ie(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=Ka(e,t)}Be(Fe).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Fn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Be(Jr).from(Fe),Be(rr).from(Fe);var ki=_i.reduce((e,t)=>(e[t]=t+"Error",e),{});const zl=Fe;var ot=_i.reduce((e,t)=>{var r=t+"Error";function n(i,a){this._e=Ie(),this.name=r,i?typeof i=="string"?(this.message=`${i}${a?`
 `+a:""}`,this.inner=a||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=Tl[t]||r,this.inner=null)}return Be(n).from(zl),e[t]=n,e},{});ot.Syntax=SyntaxError,ot.Type=TypeError,ot.Range=RangeError;var Hi=Ua.reduce((e,t)=>(e[t+"Error"]=ot[t],e),{}),Tr=_i.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=ot[t]),e),{});function yt(){}function dr(e){return e}function Wl(e,t){return e==null||e===dr?t:function(r){return t(e(r))}}function Ce(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ll(e,t){return e===yt?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Ce(n,this.onsuccess):n),i&&(this.onerror=this.onerror?Ce(i,this.onerror):i),a!==void 0?a:r}}function Ml(e,t){return e===yt?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Ce(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Ce(n,this.onerror):n)}}function Ul(e,t){return e===yt?t:function(r){var n=e.apply(this,arguments);Pt(r,n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ce(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ce(a,this.onerror):a),n===void 0?s===void 0?void 0:s:Pt(n,s)}}function Kl(e,t){return e===yt?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function xi(e,t){return e===yt?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return r.then(function(){return t.apply(n,a)})}return t.apply(this,arguments)}}Tr.ModifyError=Jr,Tr.DexieError=Fe,Tr.BulkError=rr;var fr={};const $a=100,[Tn,Xr,zn]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,ur(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,ur(t),e]})(),qa=Xr&&Xr.then,zr=Tn&&Tn.constructor,Ei=!!zn;var Wn=!1,$l=zn?()=>{zn.then(Cr)}:gt.setImmediate?setImmediate.bind(null,Cr):gt.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Cr(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Cr,0)},nr=function(e,t){Qe.push([e,t]),Qr&&($l(),Qr=!1)},Ln=!0,Qr=!0,_e=[],Wr=[],Mn=null,Un=dr,Te={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Yi,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{Yi(e[0],e[1])}catch{}})}},at=Te,Qe=[],ke=0,Lr=[];function rt(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=yt,this._lib=!1;var t=this._PSD=at;if(Jt&&(this._stackHolder=Ie(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==fr)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&$n(this,this._value))}this._state=null,this._value=null,++t.ref,Za(this,e)}const Kn={get:function(){var e=at,t=tn;function r(n,i){var a=!e.global&&(e!==at||t!==tn);const s=a&&!oe();var o=new rt((l,d)=>{Si(this,new Ha(en(n,e,a,s),en(i,e,a,s),l,d,e))});return Jt&&Ga(o,this),o}return r.prototype=fr,r},set:function(e){ne(this,"then",e&&e.prototype===fr?Kn:{get:function(){return e},set:Kn.set})}};function Ha(e,t,r,n,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=i}function Za(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&br();r&&typeof r.then=="function"?Za(e,(i,a)=>{r instanceof rt?r._then(i,a):r.then(i,a)}):(e._state=!0,e._value=r,Va(e)),n&&_r()}},$n.bind(null,e))}catch(r){$n(e,r)}}function $n(e,t){if(Wr.push(t),e._state===null){var r=e._lib&&br();t=Un(t),e._state=!1,e._value=t,Jt&&t!==null&&typeof t=="object"&&!t._promise&&function(n,i,a){try{n.apply(null,a)}catch(s){i&&i(s)}}(()=>{var n=wi(t,"stack");t._promise=e,ne(t,"stack",{get:()=>Wn?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){_e.some(i=>i._value===n._value)||_e.push(n)}(e),Va(e),r&&_r()}}function Va(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)Si(e,t[r]);var i=e._PSD;--i.ref||i.finalize(),ke===0&&(++ke,nr(()=>{--ke==0&&Oi()},[]))}function Si(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ke,nr(ql,[r,e,t])}else e._listeners.push(t)}function ql(e,t,r){try{Mn=t;var n,i=t._value;t._state?n=e(i):(Wr.length&&(Wr=[]),n=e(i),Wr.indexOf(i)===-1&&function(a){for(var s=_e.length;s;)if(_e[--s]._value===a._value)return void _e.splice(s,1)}(t)),r.resolve(n)}catch(a){r.reject(a)}finally{Mn=null,--ke==0&&Oi(),--r.psd.ref||r.psd.finalize()}}function Ya(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var i,a,s=e._value;s!=null?(i=s.name||"Error",a=s.message||s,n=Fn(s,0)):(i=s,a=""),t.push(i+(a?": "+a:"")+n)}return Jt&&((n=Fn(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&Ya(e._prev,t,r)),t}function Ga(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Cr(){br()&&_r()}function br(){var e=Ln;return Ln=!1,Qr=!1,e}function _r(){var e,t,r;do for(;Qe.length>0;)for(e=Qe,Qe=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(Qe.length>0);Ln=!0,Qr=!0}function Oi(){var e=_e;_e=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=Lr.slice(0),r=t.length;r;)t[--r]()}function Dr(e){return new rt(fr,!1,e)}function wt(e,t){var r=at;return function(){var n=br(),i=at;try{return fe(r,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{fe(i,!1),n&&_r()}}}Ue(rt.prototype,{then:Kn,_then:function(e,t){Si(this,new Ha(null,null,e,t,at))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):Dr(n)):this.then(null,n=>n&&n.name===t?r(n):Dr(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),Dr(t)))},stack:{get:function(){if(this._stack)return this._stack;try{Wn=!0;var e=Ya(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Wn=!1}}},timeout:function(e,t){return e<1/0?new rt((r,n)=>{var i=setTimeout(()=>n(new ot.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,i))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ne(rt.prototype,Symbol.toStringTag,"Dexie.Promise"),Te.env=Ja(),Ue(rt,{all:function(){var e=ee.apply(null,arguments).map(Ir);return new rt(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((i,a)=>rt.resolve(i).then(s=>{e[a]=s,--n||t(e)},r))})},resolve:e=>{if(e instanceof rt)return e;if(e&&typeof e.then=="function")return new rt((r,n)=>{e.then(r,n)});var t=new rt(fr,!0,e);return Ga(t,Mn),t},reject:Dr,race:function(){var e=ee.apply(null,arguments).map(Ir);return new rt((t,r)=>{e.map(n=>rt.resolve(n).then(t,r))})},PSD:{get:()=>at,set:e=>at=e},totalEchoes:{get:()=>tn},newPSD:de,usePSD:qe,scheduler:{get:()=>nr,set:e=>{nr=e}},rejectionMapper:{get:()=>Un,set:e=>{Un=e}},follow:(e,t)=>new rt((r,n)=>de((i,a)=>{var s=at;s.unhandleds=[],s.onunhandled=a,s.finalize=Ce(function(){(function(o){function l(){o(),Lr.splice(Lr.indexOf(l),1)}Lr.push(l),++ke,nr(()=>{--ke==0&&Oi()},[])})(()=>{this.unhandleds.length===0?i():a(this.unhandleds[0])})},s.finalize),e()},t,r,n))}),zr&&(zr.allSettled&&ne(rt,"allSettled",function(){const e=ee.apply(null,arguments).map(Ir);return new rt(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((i,a)=>rt.resolve(i).then(s=>n[a]={status:"fulfilled",value:s},s=>n[a]={status:"rejected",reason:s}).then(()=>--r||t(n)))})}),zr.any&&typeof AggregateError<"u"&&ne(rt,"any",function(){const e=ee.apply(null,arguments).map(Ir);return new rt((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const i=new Array(n);e.forEach((a,s)=>rt.resolve(a).then(o=>t(o),o=>{i[s]=o,--n||r(new AggregateError(i))}))})}));const Dt={awaits:0,echoes:0,id:0};var Hl=0,Mr=[],vn=0,tn=0,Zl=0;function de(e,t,r,n){var i=at,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Zl;var s=Te.env;a.env=Ei?{Promise:rt,PromiseProp:{value:rt,configurable:!0,writable:!0},all:rt.all,race:rt.race,allSettled:rt.allSettled,any:rt.any,resolve:rt.resolve,reject:rt.reject,nthen:Zi(s.nthen,a),gthen:Zi(s.gthen,a)}:{},t&&Pt(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=qe(a,e,r,n);return a.ref===0&&a.finalize(),o}function $e(){return Dt.id||(Dt.id=++Hl),++Dt.awaits,Dt.echoes+=$a,Dt.id}function oe(){return!!Dt.awaits&&(--Dt.awaits==0&&(Dt.id=0),Dt.echoes=Dt.awaits*$a,!0)}function Ir(e){return Dt.echoes&&e&&e.constructor===zr?($e(),e.then(t=>(oe(),t),t=>(oe(),Ot(t)))):e}function Vl(e){++tn,Dt.echoes&&--Dt.echoes!=0||(Dt.echoes=Dt.id=0),Mr.push(at),fe(e,!0)}function Yl(){var e=Mr[Mr.length-1];Mr.pop(),fe(e,!1)}function fe(e,t){var r=at;if((t?!Dt.echoes||vn++&&e===at:!vn||--vn&&e===at)||Xa(t?Vl.bind(null,e):Yl),e!==at&&(at=e,r===Te&&(Te.env=Ja()),Ei)){var n=Te.env.Promise,i=e.env;Xr.then=i.nthen,n.prototype.then=i.gthen,(r.global||e.global)&&(Object.defineProperty(gt,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function Ja(){var e=gt.Promise;return Ei?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(gt,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Xr.then,gthen:e.prototype.then}:{}}function qe(e,t,r,n,i){var a=at;try{return fe(e,!0),t(r,n,i)}finally{fe(a,!1)}}function Xa(e){qa.call(Tn,e)}function en(e,t,r,n){return typeof e!="function"?e:function(){var i=at;r&&$e(),fe(t,!0);try{return e.apply(this,arguments)}finally{fe(i,!1),n&&Xa(oe)}}}function Zi(e,t){return function(r,n){return e.call(this,en(r,t),en(n,t))}}(""+qa).indexOf("[native code]")===-1&&($e=oe=yt);const Vi="unhandledrejection";function Yi(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,i={promise:t,reason:e};if(gt.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(Vi,!0,!0),Pt(n,i)):gt.CustomEvent&&Pt(n=new CustomEvent(Vi,{detail:i}),i),n&&gt.dispatchEvent&&(dispatchEvent(n),!gt.PromiseRejectionEvent&&gt.onunhandledrejection))try{gt.onunhandledrejection(n)}catch{}Jt&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var Ot=rt.reject;function qn(e,t,r,n){if(e.idbdb&&(e._state.openComplete||at.letThrough||e._vip)){var i=e._createTransaction(t,r,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===ki.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>qn(e,t,r,n))):Ot(a)}return i._promise(t,(a,s)=>de(()=>(at.trans=i,n(a,s,i)))).then(a=>i._completion.then(()=>a))}if(e._state.openComplete)return Ot(new ot.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Ot(new ot.DatabaseClosed);e.open().catch(yt)}return e._state.dbReadyPromise.then(()=>qn(e,t,r,n))}const Gi="3.2.4",we="",Hn=-1/0,Qt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Qa="String expected.",ir=[],hn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Gl=hn,Jl=hn,to=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),pn="__dbnames",wn="readonly",bn="readwrite";function De(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const eo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ar(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=wr(t))[e],t)}class Xl{_trans(t,r,n){const i=this._tx||at.trans,a=this.name;function s(l,d,c){if(!c.schema[a])throw new ot.NotFound("Table "+a+" not part of transaction");return r(c.idbtrans,c)}const o=br();try{return i&&i.db===this.db?i===at.trans?i._promise(t,s,n):de(()=>i._promise(t,s,n),{trans:i,transless:at.transless||at}):qn(this.db,t,[this.name],s)}finally{o&&_r()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(i=>this.hook.reading.fire(i))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(It(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Et(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(d=>d.compound&&r.every(c=>d.keyPath.indexOf(c)>=0)&&d.keyPath.every(c=>r.indexOf(c)>=0))[0];if(n&&this.db._maxKey!==we)return this.where(n.name).equals(n.keyPath.map(d=>t[d]));!n&&Jt&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:i}=this.schema,a=this.db._deps.indexedDB;function s(d,c){try{return a.cmp(d,c)===0}catch{return!1}}const[o,l]=r.reduce(([d,c],h)=>{const p=i[h],u=t[h];return[d||p,d||!p?De(c,p&&p.multi?b=>{const f=ie(b,h);return It(f)&&f.some(v=>s(u,v))}:b=>s(u,ie(b,h))):c]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,It(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const i=Object.create(t.prototype);for(var a in n)if(zt(n,a))try{i[a]=n[a]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){Pt(this,t)})}add(t,r){const{auto:n,keyPath:i}=this.schema.primKey;let a=t;return i&&n&&(a=Ar(i)(t)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"add",keys:r!=null?[r]:null,values:[a]})).then(s=>s.numFailures?rt.reject(s.failures[0]):s.lastResult).then(s=>{if(i)try{$t(t,i,s)}catch{}return s})}update(t,r){if(typeof t!="object"||It(t))return this.where(":id").equals(t).modify(r);{const n=ie(t,this.schema.primKey.keyPath);if(n===void 0)return Ot(new ot.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Et(r).forEach(i=>{$t(t,i,r[i])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:i}=this.schema.primKey;let a=t;return i&&n&&(a=Ar(i)(t)),this._trans("readwrite",s=>this.core.mutate({trans:s,type:"put",values:[a],keys:r!=null?[r]:null})).then(s=>s.numFailures?rt.reject(s.failures[0]):s.lastResult).then(s=>{if(i)try{$t(t,i,s)}catch{}return s})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?rt.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:eo})).then(t=>t.numFailures?rt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(i=>this.hook.reading.fire(i))))}bulkAdd(t,r,n){const i=Array.isArray(r)?r:void 0,a=(n=n||(i?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&i)throw new ot.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new ot.InvalidArgument("Arguments objects and keys must have the same length");const d=t.length;let c=l&&o?t.map(Ar(l)):t;return this.core.mutate({trans:s,type:"add",keys:i,values:c,wantResults:a}).then(({numFailures:h,results:p,lastResult:u,failures:b})=>{if(h===0)return a?p:u;throw new rr(`${this.name}.bulkAdd(): ${h} of ${d} operations failed`,b)})})}bulkPut(t,r,n){const i=Array.isArray(r)?r:void 0,a=(n=n||(i?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",s=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&i)throw new ot.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new ot.InvalidArgument("Arguments objects and keys must have the same length");const d=t.length;let c=l&&o?t.map(Ar(l)):t;return this.core.mutate({trans:s,type:"put",keys:i,values:c,wantResults:a}).then(({numFailures:h,results:p,lastResult:u,failures:b})=>{if(h===0)return a?p:u;throw new rr(`${this.name}.bulkPut(): ${h} of ${d} operations failed`,b)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:i,failures:a})=>{if(n===0)return i;throw new rr(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,a)})}}function ar(e){var t={},r=function(s,o){if(o){for(var l=arguments.length,d=new Array(l-1);--l;)d[l-1]=arguments[l];return t[s].subscribe.apply(null,d),e}if(typeof s=="string")return t[s]};r.addEventType=a;for(var n=1,i=arguments.length;n<i;++n)a(arguments[n]);return r;function a(s,o,l){if(typeof s!="object"){var d;o||(o=Kl),l||(l=yt);var c={subscribers:[],fire:l,subscribe:function(h){c.subscribers.indexOf(h)===-1&&(c.subscribers.push(h),c.fire=o(c.fire,h))},unsubscribe:function(h){c.subscribers=c.subscribers.filter(function(p){return p!==h}),c.fire=c.subscribers.reduce(o,l)}};return t[s]=r[s]=c,c}Et(d=s).forEach(function(h){var p=d[h];if(It(p))a(h,d[h][0],d[h][1]);else{if(p!=="asap")throw new ot.InvalidArgument("Invalid event config");var u=a(h,dr,function(){for(var b=arguments.length,f=new Array(b);b--;)f[b]=arguments[b];u.subscribers.forEach(function(v){Ba(function(){v.apply(null,f)})})})}})}}function Je(e,t){return Be(t).from({prototype:e}),t}function je(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function _n(e,t){e.filter=De(e.filter,t)}function kn(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>De(n(),t()):t,e.justLimit=r&&!n}function Ur(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new ot.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function Ji(e,t,r){const n=Ur(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function Pr(e,t,r,n){const i=e.replayFilter?De(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},s=(o,l,d)=>{if(!i||i(l,d,p=>l.stop(p),p=>l.fail(p))){var c=l.primaryKey,h=""+c;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(c)),zt(a,h)||(a[h]=!0,t(o,l,d))}};return Promise.all([e.or._iterate(s,r),Xi(Ji(e,n,r),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Xi(Ji(e,n,r),De(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Xi(e,t,r,n){var i=wt(n?(a,s,o)=>r(n(a),s,o):r);return e.then(a=>{if(a)return a.start(()=>{var s=()=>a.continue();t&&!t(a,o=>s=o,o=>{a.stop(o),s=yt},o=>{a.fail(o),s=yt})||i(a.value,a,o=>s=o),s()})})}function At(e,t){try{const r=Qi(e),n=Qi(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(i,a){const s=i.length,o=a.length,l=s<o?s:o;for(let d=0;d<l;++d)if(i[d]!==a[d])return i[d]<a[d]?-1:1;return s===o?0:s<o?-1:1}(ta(e),ta(t));case"Array":return function(i,a){const s=i.length,o=a.length,l=s<o?s:o;for(let d=0;d<l;++d){const c=At(i[d],a[d]);if(c!==0)return c}return s===o?0:s<o?-1:1}(e,t)}}catch{}return NaN}function Qi(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=Nn(e);return r==="ArrayBuffer"?"binary":r}function ta(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class Ql{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,Ot.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,Ot.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=De(r.algorithm,t)}_iterate(t,r){return Pr(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Pt(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>Pr(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,i=n.table.core;if(je(n,!0))return i.count({trans:r,query:{index:Ur(n,i.schema),range:n.range}}).then(s=>Math.min(s,n.limit));var a=0;return Pr(n,()=>(++a,!1),r,i).then(()=>a)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),i=n[0],a=n.length-1;function s(d,c){return c?s(d[n[c]],c-1):d[i]}var o=this._ctx.dir==="next"?1:-1;function l(d,c){var h=s(d,a),p=s(c,a);return h<p?-o:h>p?o:0}return this.toArray(function(d){return d.sort(l)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&je(n,!0)&&n.limit>0){const{valueMapper:i}=n,a=Ur(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:a,range:n.range}}).then(({result:s})=>i?s.map(i):s)}{const i=[];return Pr(n,a=>i.push(a),r,n.table.core).then(()=>i)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,je(r)?kn(r,()=>{var n=t;return(i,a)=>n===0||(n===1?(--n,!1):(a(()=>{i.advance(n),n=0}),!1))}):kn(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),kn(this._ctx,()=>{var r=t;return function(n,i,a){return--r<=0&&i(a),r>=0}},!0),this}until(t,r){return _n(this._ctx,function(n,i,a){return!t(n.value)||(i(a),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return _n(this._ctx,function(i){return t(i.value)}),r=this._ctx,n=t,r.isMatch=De(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){t(i.key,i)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){t(i.primaryKey,i)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,a){n.push(a.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&je(r,!0)&&r.limit>0)return this._read(i=>{var a=Ur(r,r.table.core.schema);return r.table.core.query({trans:i,values:!1,limit:r.limit,query:{index:a,range:r.range}})}).then(({result:i})=>i).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,a){n.push(a.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return _n(this._ctx,function(i){var a=i.primaryKey.toString(),s=zt(n,a);return n[a]=!0,!s}),this}modify(t){var r=this._ctx;return this._write(n=>{var i;if(typeof t=="function")i=t;else{var a=Et(t),s=a.length;i=function(f){for(var v=!1,y=0;y<s;++y){var w=a[y],_=t[w];ie(f,w)!==_&&($t(f,w,_),v=!0)}return v}}const o=r.table.core,{outbound:l,extractKey:d}=o.schema.primaryKey,c=this.db._options.modifyChunkSize||200,h=[];let p=0;const u=[],b=(f,v)=>{const{failures:y,numFailures:w}=v;p+=f-w;for(let _ of Et(y))h.push(y[_])};return this.clone().primaryKeys().then(f=>{const v=y=>{const w=Math.min(c,f.length-y);return o.getMany({trans:n,keys:f.slice(y,y+w),cache:"immutable"}).then(_=>{const k=[],x=[],I=l?[]:null,O=[];for(let D=0;D<w;++D){const j=_[D],M={value:wr(j),primKey:f[y+D]};i.call(M,M.value,M)!==!1&&(M.value==null?O.push(f[y+D]):l||At(d(j),d(M.value))===0?(x.push(M.value),l&&I.push(f[y+D])):(O.push(f[y+D]),k.push(M.value)))}const R=je(r)&&r.limit===1/0&&(typeof t!="function"||t===xn)&&{index:r.index,range:r.range};return Promise.resolve(k.length>0&&o.mutate({trans:n,type:"add",values:k}).then(D=>{for(let j in D.failures)O.splice(parseInt(j),1);b(k.length,D)})).then(()=>(x.length>0||R&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:I,values:x,criteria:R,changeSpec:typeof t!="function"&&t}).then(D=>b(x.length,D))).then(()=>(O.length>0||R&&t===xn)&&o.mutate({trans:n,type:"delete",keys:O,criteria:R}).then(D=>b(O.length,D))).then(()=>f.length>y+w&&v(y+c))})};return v(0).then(()=>{if(h.length>0)throw new Jr("Error modifying one or more objects",h,p,u);return f.length})})})}delete(){var t=this._ctx,r=t.range;return je(t)&&(t.isPrimKey&&!Jl||r.type===3)?this._write(n=>{const{primaryKey:i}=t.table.core.schema,a=r;return t.table.core.count({trans:n,query:{index:i,range:a}}).then(s=>t.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(({failures:o,lastResult:l,results:d,numFailures:c})=>{if(c)throw new Jr("Could not delete some values",Object.keys(o).map(h=>o[h]),s-c);return s-c}))}):this.modify(xn)}}const xn=(e,t)=>t.value=null;function tc(e,t){return e<t?-1:e===t?0:1}function ec(e,t){return e>t?-1:e===t?0:1}function Nt(e,t,r){var n=e instanceof no?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function Re(e){return new e.Collection(e,()=>ro("")).limit(0)}function rc(e,t,r,n,i,a){for(var s=Math.min(e.length,n.length),o=-1,l=0;l<s;++l){var d=t[l];if(d!==n[l])return i(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):i(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;i(e[l],d)<0&&(o=l)}return s<n.length&&a==="next"?e+r.substr(e.length):s<e.length&&a==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function jr(e,t,r,n){var i,a,s,o,l,d,c,h=r.length;if(!r.every(f=>typeof f=="string"))return Nt(e,Qa);function p(f){i=function(y){return y==="next"?w=>w.toUpperCase():w=>w.toLowerCase()}(f),a=function(y){return y==="next"?w=>w.toLowerCase():w=>w.toUpperCase()}(f),s=f==="next"?tc:ec;var v=r.map(function(y){return{lower:a(y),upper:i(y)}}).sort(function(y,w){return s(y.lower,w.lower)});o=v.map(function(y){return y.upper}),l=v.map(function(y){return y.lower}),d=f,c=f==="next"?"":n}p("next");var u=new e.Collection(e,()=>le(o[0],l[h-1]+n));u._ondirectionchange=function(f){p(f)};var b=0;return u._addAlgorithm(function(f,v,y){var w=f.key;if(typeof w!="string")return!1;var _=a(w);if(t(_,l,b))return!0;for(var k=null,x=b;x<h;++x){var I=rc(w,_,o[x],l[x],s,d);I===null&&k===null?b=x+1:(k===null||s(k,I)>0)&&(k=I)}return v(k!==null?function(){f.continue(k+c)}:y),!1}),u}function le(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function ro(e){return{type:1,lower:e,upper:e}}class no{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,i){n=n!==!1,i=i===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||i)&&(!n||!i)?Re(this):new this.Collection(this,()=>le(t,r,!n,!i))}catch{return Nt(this,Qt)}}equals(t){return t==null?Nt(this,Qt):new this.Collection(this,()=>ro(t))}above(t){return t==null?Nt(this,Qt):new this.Collection(this,()=>le(t,void 0,!0))}aboveOrEqual(t){return t==null?Nt(this,Qt):new this.Collection(this,()=>le(t,void 0,!1))}below(t){return t==null?Nt(this,Qt):new this.Collection(this,()=>le(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Nt(this,Qt):new this.Collection(this,()=>le(void 0,t))}startsWith(t){return typeof t!="string"?Nt(this,Qa):this.between(t,t+we,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):jr(this,(r,n)=>r.indexOf(n[0])===0,[t],we)}equalsIgnoreCase(t){return jr(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=ee.apply(Ne,arguments);return t.length===0?Re(this):jr(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=ee.apply(Ne,arguments);return t.length===0?Re(this):jr(this,(r,n)=>n.some(i=>r.indexOf(i)===0),t,we)}anyOf(){const t=ee.apply(Ne,arguments);let r=this._cmp;try{t.sort(r)}catch{return Nt(this,Qt)}if(t.length===0)return Re(this);const n=new this.Collection(this,()=>le(t[0],t[t.length-1]));n._ondirectionchange=a=>{r=a==="next"?this._ascending:this._descending,t.sort(r)};let i=0;return n._addAlgorithm((a,s,o)=>{const l=a.key;for(;r(l,t[i])>0;)if(++i,i===t.length)return s(o),!1;return r(l,t[i])===0||(s(()=>{a.continue(t[i])}),!1)}),n}notEqual(t){return this.inAnyRange([[Hn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=ee.apply(Ne,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Nt(this,Qt)}const r=t.reduce((n,i)=>n?n.concat([[n[n.length-1][1],i]]):[[Hn,i]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,i=this._ascending,a=this._descending,s=this._min,o=this._max;if(t.length===0)return Re(this);if(!t.every(w=>w[0]!==void 0&&w[1]!==void 0&&i(w[0],w[1])<=0))return Nt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ot.InvalidArgument);const l=!r||r.includeLowers!==!1,d=r&&r.includeUppers===!0;let c,h=i;function p(w,_){return h(w[0],_[0])}try{c=t.reduce(function(w,_){let k=0,x=w.length;for(;k<x;++k){const I=w[k];if(n(_[0],I[1])<0&&n(_[1],I[0])>0){I[0]=s(I[0],_[0]),I[1]=o(I[1],_[1]);break}}return k===x&&w.push(_),w},[]),c.sort(p)}catch{return Nt(this,Qt)}let u=0;const b=d?w=>i(w,c[u][1])>0:w=>i(w,c[u][1])>=0,f=l?w=>a(w,c[u][0])>0:w=>a(w,c[u][0])>=0;let v=b;const y=new this.Collection(this,()=>le(c[0][0],c[c.length-1][1],!l,!d));return y._ondirectionchange=w=>{w==="next"?(v=b,h=i):(v=f,h=a),c.sort(p)},y._addAlgorithm((w,_,k)=>{for(var x=w.key;v(x);)if(++u,u===c.length)return _(k),!1;return!!function(I){return!b(I)&&!f(I)}(x)||(this._cmp(x,c[u][1])===0||this._cmp(x,c[u][0])===0||_(()=>{h===i?w.continue(c[u][0]):w.continue(c[u][1])}),!1)}),y}startsWithAnyOf(){const t=ee.apply(Ne,arguments);return t.every(r=>typeof r=="string")?t.length===0?Re(this):this.inAnyRange(t.map(r=>[r,r+we])):Nt(this,"startsWithAnyOf() only works with strings")}}function Ht(e){return wt(function(t){return hr(t),e(t.target.error),!1})}function hr(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const pr="storagemutated",ue="x-storagemutated-1",he=ar(null,pr);class nc{_lock(){return Xe(!at.global),++this._reculock,this._reculock!==1||at.global||(at.lockOwnerFor=this),this}_unlock(){if(Xe(!at.global),--this._reculock==0)for(at.global||(at.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{qe(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&at.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(Xe(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new ot.DatabaseClosed(n);case"MissingAPIError":throw new ot.MissingAPI(n.message,n);default:throw new ot.OpenFailed(n)}if(!this.active)throw new ot.TransactionInactive;return Xe(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=wt(i=>{hr(i),this._reject(t.error)}),t.onabort=wt(i=>{hr(i),this.active&&this._reject(new ot.Abort(t.error)),this.active=!1,this.on("abort").fire(i)}),t.oncomplete=wt(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&he.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return Ot(new ot.ReadOnly("Transaction is readonly"));if(!this.active)return Ot(new ot.TransactionInactive);if(this._locked())return new rt((a,s)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(a,s)},at])});if(n)return de(()=>{var a=new rt((s,o)=>{this._lock();const l=r(s,o,this);l&&l.then&&l.then(s,o)});return a.finally(()=>this._unlock()),a._lib=!0,a});var i=new rt((a,s)=>{var o=r(a,s,this);o&&o.then&&o.then(a,s)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=rt.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var i=r.idbtrans.objectStore(r.storeNames[0]);(function s(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(i.get(-1/0).onsuccess=s)})()}var a=r._waitingFor;return new rt((s,o)=>{n.then(l=>r._waitingQueue.push(wt(s.bind(null,l))),l=>r._waitingQueue.push(wt(o.bind(null,l)))).finally(()=>{r._waitingFor===a&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ot.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(zt(r,t))return r[t];const n=this.schema[t];if(!n)throw new ot.NotFound("Table "+t+" not part of transaction");const i=new this.db.Table(t,n,this);return i.core=this.db.core.table(t),r[t]=i,i}}function Zn(e,t,r,n,i,a,s){return{name:e,keyPath:t,unique:r,multi:n,auto:i,compound:a,src:(r&&!s?"&":"")+(n?"*":"")+(i?"++":"")+io(t)}}function io(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function ao(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:Fa(r,n=>[n.name,n])}}let mr=e=>{try{return e.only([[]]),mr=()=>[[]],[[]]}catch{return mr=()=>we,we}};function Vn(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>ie(n,t)}(e):t=>ie(t,e)}function ea(e){return[].slice.call(e)}let ic=0;function or(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function ac(e,t,r){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:d,upper:c,lowerOpen:h,upperOpen:p}=l;return d===void 0?c===void 0?null:t.upperBound(c,!!p):c===void 0?t.lowerBound(d,!!h):t.bound(d,c,!!h,!!p)}const{schema:i,hasGetAll:a}=function(l,d){const c=ea(l.objectStoreNames);return{schema:{name:l.name,tables:c.map(h=>d.objectStore(h)).map(h=>{const{keyPath:p,autoIncrement:u}=h,b=It(p),f=p==null,v={},y={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:f,compound:b,keyPath:p,autoIncrement:u,unique:!0,extractKey:Vn(p)},indexes:ea(h.indexNames).map(w=>h.index(w)).map(w=>{const{name:_,unique:k,multiEntry:x,keyPath:I}=w,O={name:_,compound:It(I),keyPath:I,unique:k,multiEntry:x,extractKey:Vn(I)};return v[or(I)]=O,O}),getIndexByKeyPath:w=>v[or(w)]};return v[":id"]=y.primaryKey,p!=null&&(v[or(p)]=y.primaryKey),y})},hasGetAll:c.length>0&&"getAll"in d.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),s=i.tables.map(l=>function(d){const c=d.name;return{name:c,schema:d,mutate:function({trans:h,type:p,keys:u,values:b,range:f}){return new Promise((v,y)=>{v=wt(v);const w=h.objectStore(c),_=w.keyPath==null,k=p==="put"||p==="add";if(!k&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:x}=u||b||{length:1};if(u&&b&&u.length!==b.length)throw new Error("Given keys array must have same length as given values array.");if(x===0)return v({numFailures:0,failures:{},results:[],lastResult:void 0});let I;const O=[],R=[];let D=0;const j=C=>{++D,hr(C)};if(p==="deleteRange"){if(f.type===4)return v({numFailures:D,failures:R,results:[],lastResult:void 0});f.type===3?O.push(I=w.clear()):O.push(I=w.delete(n(f)))}else{const[C,B]=k?_?[b,u]:[b,null]:[u,null];if(k)for(let g=0;g<x;++g)O.push(I=B&&B[g]!==void 0?w[p](C[g],B[g]):w[p](C[g])),I.onerror=j;else for(let g=0;g<x;++g)O.push(I=w[p](C[g])),I.onerror=j}const M=C=>{const B=C.target.result;O.forEach((g,L)=>g.error!=null&&(R[L]=g.error)),v({numFailures:D,failures:R,results:p==="delete"?u:O.map(g=>g.result),lastResult:B})};I.onerror=C=>{j(C),M(C)},I.onsuccess=M})},getMany:({trans:h,keys:p})=>new Promise((u,b)=>{u=wt(u);const f=h.objectStore(c),v=p.length,y=new Array(v);let w,_=0,k=0;const x=O=>{const R=O.target;y[R._pos]=R.result,++k===_&&u(y)},I=Ht(b);for(let O=0;O<v;++O)p[O]!=null&&(w=f.get(p[O]),w._pos=O,w.onsuccess=x,w.onerror=I,++_);_===0&&u(y)}),get:({trans:h,key:p})=>new Promise((u,b)=>{u=wt(u);const f=h.objectStore(c).get(p);f.onsuccess=v=>u(v.target.result),f.onerror=Ht(b)}),query:function(h){return p=>new Promise((u,b)=>{u=wt(u);const{trans:f,values:v,limit:y,query:w}=p,_=y===1/0?void 0:y,{index:k,range:x}=w,I=f.objectStore(c),O=k.isPrimaryKey?I:I.index(k.name),R=n(x);if(y===0)return u({result:[]});if(h){const D=v?O.getAll(R,_):O.getAllKeys(R,_);D.onsuccess=j=>u({result:j.target.result}),D.onerror=Ht(b)}else{let D=0;const j=v||!("openKeyCursor"in O)?O.openCursor(R):O.openKeyCursor(R),M=[];j.onsuccess=C=>{const B=j.result;return B?(M.push(v?B.value:B.primaryKey),++D===y?u({result:M}):void B.continue()):u({result:M})},j.onerror=Ht(b)}})}(a),openCursor:function({trans:h,values:p,query:u,reverse:b,unique:f}){return new Promise((v,y)=>{v=wt(v);const{index:w,range:_}=u,k=h.objectStore(c),x=w.isPrimaryKey?k:k.index(w.name),I=b?f?"prevunique":"prev":f?"nextunique":"next",O=p||!("openKeyCursor"in x)?x.openCursor(n(_),I):x.openKeyCursor(n(_),I);O.onerror=Ht(y),O.onsuccess=wt(R=>{const D=O.result;if(!D)return void v(null);D.___id=++ic,D.done=!1;const j=D.continue.bind(D);let M=D.continuePrimaryKey;M&&(M=M.bind(D));const C=D.advance.bind(D),B=()=>{throw new Error("Cursor not stopped")};D.trans=h,D.stop=D.continue=D.continuePrimaryKey=D.advance=()=>{throw new Error("Cursor not started")},D.fail=wt(y),D.next=function(){let g=1;return this.start(()=>g--?this.continue():this.stop()).then(()=>this)},D.start=g=>{const L=new Promise((A,Z)=>{A=wt(A),O.onerror=Ht(Z),D.fail=Z,D.stop=z=>{D.stop=D.continue=D.continuePrimaryKey=D.advance=B,A(z)}}),tt=()=>{if(O.result)try{g()}catch(A){D.fail(A)}else D.done=!0,D.start=()=>{throw new Error("Cursor behind last entry")},D.stop()};return O.onsuccess=wt(A=>{O.onsuccess=tt,tt()}),D.continue=j,D.continuePrimaryKey=M,D.advance=C,tt(),L},v(D)},y)})},count({query:h,trans:p}){const{index:u,range:b}=h;return new Promise((f,v)=>{const y=p.objectStore(c),w=u.isPrimaryKey?y:y.index(u.name),_=n(b),k=_?w.count(_):w.count();k.onsuccess=wt(x=>f(x.target.result)),k.onerror=Ht(v)})}}}(l)),o={};return s.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:e.transaction.bind(e),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:mr(t),schema:i}}function Yn({_novip:e},t){const r=t.db,n=function(i,a,{IDBKeyRange:s,indexedDB:o},l){return{dbcore:function(c,h){return h.reduce((p,{create:u})=>({...p,...u(p)}),c)}(ac(a,s,l),i.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(i=>{const a=i.name;e.core.schema.tables.some(s=>s.name===a)&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function rn({_novip:e},t,r,n){r.forEach(i=>{const a=n[i];t.forEach(s=>{const o=wi(s,i);(!o||"value"in o&&o.value===void 0)&&(s===e.Transaction.prototype||s instanceof e.Transaction?ne(s,i,{get(){return this.table(i)},set(l){Ra(this,i,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):s[i]=new e.Table(i,a))})})}function Gn({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function oc(e,t){return e._cfg.version-t._cfg.version}function sc(e,t,r,n){const i=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,i);a.create(r),a._completion.catch(n);const s=a._reject.bind(a),o=at.transless||at;de(()=>{at.trans=a,at.transless=o,t===0?(Et(i).forEach(l=>{En(r,l,i[l].primKey,i[l].indexes)}),Yn(e,r),rt.follow(()=>e.on.populate.fire(a)).catch(s)):function({_novip:l},d,c,h){const p=[],u=l._versions;let b=l._dbSchema=Xn(l,l.idbdb,h),f=!1;const v=u.filter(w=>w._cfg.version>=d);function y(){return p.length?rt.resolve(p.shift()(c.idbtrans)).then(y):rt.resolve()}return v.forEach(w=>{p.push(()=>{const _=b,k=w._cfg.dbschema;Qn(l,_,h),Qn(l,k,h),b=l._dbSchema=k;const x=oo(_,k);x.add.forEach(O=>{En(h,O[0],O[1].primKey,O[1].indexes)}),x.change.forEach(O=>{if(O.recreate)throw new ot.Upgrade("Not yet support for changing primary key");{const R=h.objectStore(O.name);O.add.forEach(D=>Jn(R,D)),O.change.forEach(D=>{R.deleteIndex(D.name),Jn(R,D)}),O.del.forEach(D=>R.deleteIndex(D))}});const I=w._cfg.contentUpgrade;if(I&&w._cfg.version>d){Yn(l,h),c._memoizedTables={},f=!0;let O=Ta(k);x.del.forEach(M=>{O[M]=_[M]}),Gn(l,[l.Transaction.prototype]),rn(l,[l.Transaction.prototype],Et(O),O),c.schema=O;const R=bi(I);let D;R&&$e();const j=rt.follow(()=>{if(D=I(c),D&&R){var M=oe.bind(null,null);D.then(M,M)}});return D&&typeof D.then=="function"?rt.resolve(D):j.then(()=>D)}}),p.push(_=>{(!f||!Gl)&&function(k,x){[].slice.call(x.db.objectStoreNames).forEach(I=>k[I]==null&&x.db.deleteObjectStore(I))}(w._cfg.dbschema,_),Gn(l,[l.Transaction.prototype]),rn(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),c.schema=l._dbSchema})}),y().then(()=>{var w,_;_=h,Et(w=b).forEach(k=>{_.db.objectStoreNames.contains(k)||En(_,k,w[k].primKey,w[k].indexes)})})}(e,t,a,r).catch(s)})}function oo(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const i=e[n],a=t[n];if(i){const s={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto&&!hn)s.recreate=!0,r.change.push(s);else{const o=i.idxByName,l=a.idxByName;let d;for(d in o)l[d]||s.del.push(d);for(d in l){const c=o[d],h=l[d];c?c.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}else r.add.push([n,a])}return r}function En(e,t,r,n){const i=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(a=>Jn(i,a)),i}function Jn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Xn(e,t,r){const n={};return Gr(t.objectStoreNames,0).forEach(i=>{const a=r.objectStore(i);let s=a.keyPath;const o=Zn(io(s),s||"",!1,!1,!!a.autoIncrement,s&&typeof s!="string",!0),l=[];for(let c=0;c<a.indexNames.length;++c){const h=a.index(a.indexNames[c]);s=h.keyPath;var d=Zn(h.name,s,!!h.unique,!!h.multiEntry,!1,s&&typeof s!="string",!1);l.push(d)}n[i]=ao(i,o,l)}),n}function Qn({_novip:e},t,r){const n=r.db.objectStoreNames;for(let i=0;i<n.length;++i){const a=n[i],s=r.objectStore(a);e._hasGetAll="getAll"in s;for(let o=0;o<s.indexNames.length;++o){const l=s.indexNames[o],d=s.index(l).keyPath,c=typeof d=="string"?d:"["+Gr(d).join("+")+"]";if(t[a]){const h=t[a].idxByName[c];h&&(h.name=l,delete t[a].idxByName[c],t[a].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&gt.WorkerGlobalScope&&gt instanceof gt.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class lc{_parseStoresSpec(t,r){Et(t).forEach(n=>{if(t[n]!==null){var i=t[n].split(",").map((s,o)=>{const l=(s=s.trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return Zn(l,d||null,/\&/.test(s),/\*/.test(s),/\+\+/.test(s),It(d),o===0)}),a=i.shift();if(a.multi)throw new ot.Schema("Primary key cannot be multi-valued");i.forEach(s=>{if(s.auto)throw new ot.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new ot.Schema("Index must have a name and cannot be an empty string")}),r[n]=ao(n,a,i)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Pt(this._cfg.storesSource,t):t;const n=r._versions,i={};let a={};return n.forEach(s=>{Pt(i,s._cfg.storesSource),a=s._cfg.dbschema={},s._parseStoresSpec(i,a)}),r._dbSchema=a,Gn(r,[r._allTables,r,r.Transaction.prototype]),rn(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Et(a),a),r._storeNames=Et(a),this}upgrade(t){return this._cfg.contentUpgrade=xi(this._cfg.contentUpgrade||yt,t),this}}function Ci(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new xe(pn,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function Di(e){return e&&typeof e.databases=="function"}function ti(e){return de(function(){return at.letThrough=!0,e()})}function cc(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function uc(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Ot(t.dbOpenError):e);Jt&&(t.openCanceller._stackHolder=Ie()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function i(){if(t.openCanceller!==n)throw new ot.DatabaseClosed("db.open() was cancelled")}let a=t.dbReadyResolve,s=null,o=!1;return rt.race([n,(typeof navigator>"u"?rt.resolve():cc()).then(()=>new rt((l,d)=>{if(i(),!r)throw new ot.MissingAPI;const c=e.name,h=t.autoSchema?r.open(c):r.open(c,Math.round(10*e.verno));if(!h)throw new ot.MissingAPI;h.onerror=Ht(d),h.onblocked=wt(e._fireOnBlocked),h.onupgradeneeded=wt(p=>{if(s=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=hr,s.abort(),h.result.close();const b=r.deleteDatabase(c);b.onsuccess=b.onerror=wt(()=>{d(new ot.NoSuchDatabase(`Database ${c} doesnt exist`))})}else{s.onerror=Ht(d);var u=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;o=u<1,e._novip.idbdb=h.result,sc(e,u/10,s,d)}},d),h.onsuccess=wt(()=>{s=null;const p=e._novip.idbdb=h.result,u=Gr(p.objectStoreNames);if(u.length>0)try{const f=p.transaction((b=u).length===1?b[0]:b,"readonly");t.autoSchema?function({_novip:v},y,w){v.verno=y.version/10;const _=v._dbSchema=Xn(0,y,w);v._storeNames=Gr(y.objectStoreNames,0),rn(v,[v._allTables],Et(_),_)}(e,p,f):(Qn(e,e._dbSchema,f),function(v,y){const w=oo(Xn(0,v.idbdb,y),v._dbSchema);return!(w.add.length||w.change.some(_=>_.add.length||_.change.length))}(e,f)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Yn(e,f)}catch{}var b;ir.push(e),p.onversionchange=wt(f=>{t.vcFired=!0,e.on("versionchange").fire(f)}),p.onclose=wt(f=>{e.on("close").fire(f)}),o&&function({indexedDB:f,IDBKeyRange:v},y){!Di(f)&&y!==pn&&Ci(f,v).put({name:y}).catch(yt)}(e._deps,c),l()},d)}))]).then(()=>(i(),t.onReadyBeingFired=[],rt.resolve(ti(()=>e.on.ready.fire(e.vip))).then(function l(){if(t.onReadyBeingFired.length>0){let d=t.onReadyBeingFired.reduce(xi,yt);return t.onReadyBeingFired=[],rt.resolve(ti(()=>d(e.vip))).then(l)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(l=>{t.dbOpenError=l;try{s&&s.abort()}catch{}return n===t.openCanceller&&e._close(),Ot(l)}).finally(()=>{t.openComplete=!0,a()})}function ei(e){var t=a=>e.next(a),r=i(t),n=i(a=>e.throw(a));function i(a){return s=>{var o=a(s),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(r,n):It(l)?Promise.all(l).then(r,n):r(l)}}return i(t)()}function dc(e,t,r){var n=arguments.length;if(n<2)throw new ot.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];return r=i.pop(),[e,za(i),r]}function so(e,t,r,n,i){return rt.resolve().then(()=>{const a=at.transless||at,s=e._createTransaction(t,r,e._dbSchema,n),o={trans:s,transless:a};if(n)s.idbtrans=n.idbtrans;else try{s.create(),e._state.PR1398_maxLoop=3}catch(h){return h.name===ki.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>so(e,t,r,null,i))):Ot(h)}const l=bi(i);let d;l&&$e();const c=rt.follow(()=>{if(d=i.call(s,s),d)if(l){var h=oe.bind(null,null);d.then(h,h)}else typeof d.next=="function"&&typeof d.throw=="function"&&(d=ei(d))},o);return(d&&typeof d.then=="function"?rt.resolve(d).then(h=>s.active?h:Ot(new ot.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):c.then(()=>d)).then(h=>(n&&s._resolve(),s._completion.then(()=>h))).catch(h=>(s._reject(h),Ot(h)))})}function Rr(e,t,r){const n=It(e)?e.slice():[e];for(let i=0;i<r;++i)n.push(t);return n}const fc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,i={},a=[];function s(c,h,p){const u=or(c),b=i[u]=i[u]||[],f=c==null?0:typeof c=="string"?1:c.length,v=h>0,y={...p,isVirtual:v,keyTail:h,keyLength:f,extractKey:Vn(c),unique:!v&&p.unique};return b.push(y),y.isPrimaryKey||a.push(y),f>1&&s(f===2?c[0]:c.slice(0,f-1),h+1,p),b.sort((w,_)=>w.keyTail-_.keyTail),y}const o=s(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[o];for(const c of n.indexes)s(c.keyPath,0,c);function l(c){const h=c.query.index;return h.isVirtual?{...c,query:{index:h,range:(p=c.query.range,u=h.keyTail,{type:p.type===1?2:p.type,lower:Rr(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,u),lowerOpen:!0,upper:Rr(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,u),upperOpen:!0})}}:c;var p,u}return{...r,schema:{...n,primaryKey:o,indexes:a,getIndexByKeyPath:function(c){const h=i[or(c)];return h&&h[0]}},count:c=>r.count(l(c)),query:c=>r.query(l(c)),openCursor(c){const{keyTail:h,isVirtual:p,keyLength:u}=c.query.index;return p?r.openCursor(l(c)).then(b=>b&&function(f){return Object.create(f,{continue:{value:function(y){y!=null?f.continue(Rr(y,c.reverse?e.MAX_KEY:e.MIN_KEY,h)):c.unique?f.continue(f.key.slice(0,u).concat(c.reverse?e.MIN_KEY:e.MAX_KEY,h)):f.continue()}},continuePrimaryKey:{value(y,w){f.continuePrimaryKey(Rr(y,e.MAX_KEY,h),w)}},primaryKey:{get:()=>f.primaryKey},key:{get(){const y=f.key;return u===1?y[0]:y.slice(0,u)}},value:{get:()=>f.value}})}(b)):r.openCursor(c)}}}}}};function Ii(e,t,r,n){return r=r||{},n=n||"",Et(e).forEach(i=>{if(zt(t,i)){var a=e[i],s=t[i];if(typeof a=="object"&&typeof s=="object"&&a&&s){const o=Nn(a);o!==Nn(s)?r[n+i]=t[i]:o==="Object"?Ii(a,s,r,n+i+"."):a!==s&&(r[n+i]=t[i])}else a!==s&&(r[n+i]=t[i])}else r[n+i]=void 0}),Et(t).forEach(i=>{zt(e,i)||(r[n+i]=t[i])}),r}const hc={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(a){const s=at.trans,{deleting:o,creating:l,updating:d}=s.table(t).hook;switch(a.type){case"add":if(l.fire===yt)break;return s._promise("readwrite",()=>c(a),!0);case"put":if(l.fire===yt&&d.fire===yt)break;return s._promise("readwrite",()=>c(a),!0);case"delete":if(o.fire===yt)break;return s._promise("readwrite",()=>c(a),!0);case"deleteRange":if(o.fire===yt)break;return s._promise("readwrite",()=>function(p){return h(p.trans,p.range,1e4)}(a),!0)}return r.mutate(a);function c(p){const u=at.trans,b=p.keys||function(f,v){return v.type==="delete"?v.keys:v.keys||v.values.map(f.extractKey)}(n,p);if(!b)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:b}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(f,v,y){return v.type==="add"?Promise.resolve([]):f.getMany({trans:v.trans,keys:y,cache:"immutable"})}(r,p,b).then(f=>{const v=b.map((y,w)=>{const _=f[w],k={onerror:null,onsuccess:null};if(p.type==="delete")o.fire.call(k,y,_,u);else if(p.type==="add"||_===void 0){const x=l.fire.call(k,y,p.values[w],u);y==null&&x!=null&&(y=x,p.keys[w]=y,n.outbound||$t(p.values[w],n.keyPath,y))}else{const x=Ii(_,p.values[w]),I=d.fire.call(k,x,y,_,u);if(I){const O=p.values[w];Object.keys(I).forEach(R=>{zt(O,R)?O[R]=I[R]:$t(O,R,I[R])})}}return k});return r.mutate(p).then(({failures:y,results:w,numFailures:_,lastResult:k})=>{for(let x=0;x<b.length;++x){const I=w?w[x]:b[x],O=v[x];I==null?O.onerror&&O.onerror(y[x]):O.onsuccess&&O.onsuccess(p.type==="put"&&f[x]?p.values[x]:I)}return{failures:y,results:w,numFailures:_,lastResult:k}}).catch(y=>(v.forEach(w=>w.onerror&&w.onerror(y)),Promise.reject(y)))})}function h(p,u,b){return r.query({trans:p,values:!1,query:{index:n,range:u},limit:b}).then(({result:f})=>c({type:"delete",keys:f,trans:p}).then(v=>v.numFailures>0?Promise.reject(v.failures[0]):f.length<b?{failures:[],numFailures:0,lastResult:void 0}:h(p,{...u,lower:f[f.length-1],lowerOpen:!0},b)))}}}}})};function lo(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let i=0,a=0;i<t.keys.length&&a<e.length;++i)At(t.keys[i],e[a])===0&&(n.push(r?wr(t.values[i]):t.values[i]),++a);return n.length===e.length?n:null}catch{return null}}const pc={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const i=lo(n.keys,n.trans._cache,n.cache==="clone");return i?rt.resolve(i):r.getMany(n).then(a=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?wr(a):a},a))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function Ai(e){return!("from"in e)}const te=function(e,t){if(!this){const r=new te;return e&&"d"in e&&Pt(r,e),r}Pt(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function yr(e,t,r){const n=At(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(Ai(e))return Pt(e,{from:t,to:r,d:1});const i=e.l,a=e.r;if(At(r,e.from)<0)return i?yr(i,t,r):e.l={from:t,to:r,d:1,l:null,r:null},ra(e);if(At(t,e.to)>0)return a?yr(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},ra(e);At(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),At(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const s=!e.r;i&&!e.l&&nn(e,i),a&&s&&nn(e,a)}function nn(e,t){Ai(t)||function r(n,{from:i,to:a,l:s,r:o}){yr(n,i,a),s&&r(n,s),o&&r(n,o)}(e,t)}function mc(e,t){const r=ri(t);let n=r.next();if(n.done)return!1;let i=n.value;const a=ri(e);let s=a.next(i.from),o=s.value;for(;!n.done&&!s.done;){if(At(o.from,i.to)<=0&&At(o.to,i.from)>=0)return!0;At(i.from,o.from)<0?i=(n=r.next(o.from)).value:o=(s=a.next(i.from)).value}return!1}function ri(e){let t=Ai(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&At(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||At(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function ra(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){const a=i==="r"?"l":"r",s={...e},o=e[i];e.from=o.from,e.to=o.to,e[i]=o[i],s[i]=o[a],e[a]=s,s.d=na(s)}e.d=na(e)}function na({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Ue(te.prototype,{add(e){return nn(this,e),this},addKey(e){return yr(this,e,e),this},addKeys(e){return e.forEach(t=>yr(this,t,t)),this},[Bn](){return ri(this)}});const yc={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new te(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const i=e.table(n),{schema:a}=i,{primaryKey:s}=a,{extractKey:o,outbound:l}=s,d={...i,mutate:p=>{const u=p.trans,b=u.mutatedParts||(u.mutatedParts={}),f=I=>{const O=`idb://${t}/${n}/${I}`;return b[O]||(b[O]=new te)},v=f(""),y=f(":dels"),{type:w}=p;let[_,k]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const x=p.trans._cache;return i.mutate(p).then(I=>{if(It(_)){w!=="delete"&&(_=I.results),v.addKeys(_);const O=lo(_,x);O||w==="add"||y.addKeys(_),(O||k)&&function(R,D,j,M){function C(B){const g=R(B.name||"");function L(A){return A!=null?B.extractKey(A):null}const tt=A=>B.multiEntry&&It(A)?A.forEach(Z=>g.addKey(Z)):g.addKey(A);(j||M).forEach((A,Z)=>{const z=j&&L(j[Z]),H=M&&L(M[Z]);At(z,H)!==0&&(z!=null&&tt(z),H!=null&&tt(H))})}D.indexes.forEach(C)}(f,a,O,k)}else if(_){const O={from:_.lower,to:_.upper};y.add(O),v.add(O)}else v.add(r),y.add(r),a.indexes.forEach(O=>f(O.name).add(r));return I})}},c=({query:{index:p,range:u}})=>{var b,f;return[p,new te((b=u.lower)!==null&&b!==void 0?b:e.MIN_KEY,(f=u.upper)!==null&&f!==void 0?f:e.MAX_KEY)]},h={get:p=>[s,new te(p.key)],getMany:p=>[s,new te().addKeys(p.keys)],count:c,query:c,openCursor:c};return Et(h).forEach(p=>{d[p]=function(u){const{subscr:b}=at;if(b){const f=k=>{const x=`idb://${t}/${n}/${k}`;return b[x]||(b[x]=new te)},v=f(""),y=f(":dels"),[w,_]=h[p](u);if(f(w.name||"").add(_),!w.isPrimaryKey){if(p!=="count"){const k=p==="query"&&l&&u.values&&i.query({...u,values:!1});return i[p].apply(this,arguments).then(x=>{if(p==="query"){if(l&&u.values)return k.then(({result:O})=>(v.addKeys(O),x));const I=u.values?x.result.map(o):x.result;u.values?v.addKeys(I):y.addKeys(I)}else if(p==="openCursor"){const I=x,O=u.values;return I&&Object.create(I,{key:{get:()=>(y.addKey(I.primaryKey),I.key)},primaryKey:{get(){const R=I.primaryKey;return y.addKey(R),R}},value:{get:()=>(O&&v.addKey(I.primaryKey),I.value)}})}return x})}y.add(r)}}return i[p].apply(this,arguments)}}),d}}}};class xe{constructor(t,r){this._middlewares={},this.verno=0;const n=xe.dependencies;this._options=r={addons:xe.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:i}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:yt,dbReadyPromise:null,cancelOpen:yt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var s;a.dbReadyPromise=new rt(o=>{a.dbReadyResolve=o}),a.openCanceller=new rt((o,l)=>{a.cancelOpen=l}),this._state=a,this.name=t,this.on=ar(this,"populate","blocked","versionchange","close",{ready:[xi,yt]}),this.on.ready.subscribe=Na(this.on.ready.subscribe,o=>(l,d)=>{xe.vip(()=>{const c=this._state;if(c.openComplete)c.dbOpenError||rt.resolve().then(l),d&&o(l);else if(c.onReadyBeingFired)c.onReadyBeingFired.push(l),d&&o(l);else{o(l);const h=this;d||o(function p(){h.on.ready.unsubscribe(l),h.on.ready.unsubscribe(p)})}})}),this.Collection=(s=this,Je(Ql.prototype,function(o,l){this.db=s;let d=eo,c=null;if(l)try{d=l()}catch(b){c=b}const h=o._ctx,p=h.table,u=p.hook.reading.fire;this._ctx={table:p,index:h.index,isPrimKey:!h.index||p.schema.primKey.keyPath&&h.index===p.schema.primKey.name,range:d,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:h.or,valueMapper:u!==dr?u:null}})),this.Table=function(o){return Je(Xl.prototype,function(l,d,c){this.db=o,this._tx=c,this.name=l,this.schema=d,this.hook=o._allTables[l]?o._allTables[l].hook:ar(null,{creating:[Ll,yt],reading:[Wl,dr],updating:[Ul,yt],deleting:[Ml,yt]})})}(this),this.Transaction=function(o){return Je(nc.prototype,function(l,d,c,h,p){this.db=o,this.mode=l,this.storeNames=d,this.schema=c,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=ar(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new rt((u,b)=>{this._resolve=u,this._reject=b}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},u=>{var b=this.active;return this.active=!1,this.on.error.fire(u),this.parent?this.parent._reject(u):b&&this.idbtrans&&this.idbtrans.abort(),Ot(u)})})}(this),this.Version=function(o){return Je(lc.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return Je(no.prototype,function(l,d,c){this.db=o,this._ctx={table:l,index:d===":id"?null:d,or:c};const h=o._deps.indexedDB;if(!h)throw new ot.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(p,u)=>h.cmp(u,p),this._max=(p,u)=>h.cmp(p,u)>0?p:u,this._min=(p,u)=>h.cmp(p,u)<0?p:u,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=mr(r.IDBKeyRange),this._createTransaction=(o,l,d,c)=>new this.Transaction(o,l,d,this._options.chromeTransactionDurability,c),this._fireOnBlocked=o=>{this.on("blocked").fire(o),ir.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(fc),this.use(hc),this.use(yc),this.use(pc),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new ot.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new ot.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(i=>i._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(oc),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||at.letThrough||this._vip)?t():new rt((r,n)=>{if(this._state.openComplete)return n(new ot.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new ot.DatabaseClosed);this.open().catch(yt)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:i}){i&&this.unuse({stack:t,name:i});const a=this._middlewares[t]||(this._middlewares[t]=[]);return a.push({stack:t,create:r,level:n??10,name:i}),a.sort((s,o)=>s.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(i=>n?i.create!==n:!!r&&i.name!==r)),this}open(){return uc(this)}_close(){const t=this._state,r=ir.indexOf(this);if(r>=0&&ir.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new rt(n=>{t.dbReadyResolve=n}),t.openCanceller=new rt((n,i)=>{t.cancelOpen=i})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new ot.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new rt((n,i)=>{const a=()=>{this.close();var s=this._deps.indexedDB.deleteDatabase(this.name);s.onsuccess=wt(()=>{(function({indexedDB:o,IDBKeyRange:l},d){!Di(o)&&d!==pn&&Ci(o,l).delete(d).catch(yt)})(this._deps,this.name),n()}),s.onerror=Ht(i),s.onblocked=this._fireOnBlocked};if(t)throw new ot.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Et(this._allTables).map(t=>this._allTables[t])}transaction(){const t=dc.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let i=at.trans;i&&i.db===this&&t.indexOf("!")===-1||(i=null);const a=t.indexOf("?")!==-1;let s,o;t=t.replace("!","").replace("?","");try{if(o=r.map(d=>{var c=d instanceof this.Table?d.name:d;if(typeof c!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return c}),t=="r"||t===wn)s=wn;else{if(t!="rw"&&t!=bn)throw new ot.InvalidArgument("Invalid transaction mode: "+t);s=bn}if(i){if(i.mode===wn&&s===bn){if(!a)throw new ot.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&o.forEach(d=>{if(i&&i.storeNames.indexOf(d)===-1){if(!a)throw new ot.SubTransaction("Table "+d+" not included in parent transaction.");i=null}}),a&&i&&!i.active&&(i=null)}}catch(d){return i?i._promise(null,(c,h)=>{h(d)}):Ot(d)}const l=so.bind(null,this,s,o,i,n);return i?i._promise(s,l,"lock"):at.trans?qe(at.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!zt(this._allTables,t))throw new ot.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const gc=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class vc{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[gc](){return this}}function co(e,t){return Et(t).forEach(r=>{nn(e[r]||(e[r]=new te),t[r])}),e}function wc(e){let t,r=!1;const n=new vc(i=>{const a=bi(e);let s=!1,o={},l={};const d={get closed(){return s},unsubscribe:()=>{s=!0,he.storagemutated.unsubscribe(u)}};i.start&&i.start(d);let c=!1,h=!1;function p(){return Et(l).some(f=>o[f]&&mc(o[f],l[f]))}const u=f=>{co(o,f),p()&&b()},b=()=>{if(c||s)return;o={};const f={},v=function(y){a&&$e();const w=()=>de(e,{subscr:y,trans:null}),_=at.trans?qe(at.transless,w):w();return a&&_.then(oe,oe),_}(f);h||(he(pr,u),h=!0),c=!0,Promise.resolve(v).then(y=>{r=!0,t=y,c=!1,s||(p()?b():(o={},l=f,i.next&&i.next(y)))},y=>{c=!1,r=!1,i.error&&i.error(y),d.unsubscribe()})};return b(),d});return n.hasValue=()=>r,n.getValue=()=>t,n}let ni;try{ni={indexedDB:gt.indexedDB||gt.mozIndexedDB||gt.webkitIndexedDB||gt.msIndexedDB,IDBKeyRange:gt.IDBKeyRange||gt.webkitIDBKeyRange}}catch{ni={indexedDB:null,IDBKeyRange:null}}const ge=xe;function Kr(e){let t=re;try{re=!0,he.storagemutated.fire(e)}finally{re=t}}Ue(ge,{...Tr,delete:e=>new ge(e,{addons:[]}).delete(),exists:e=>new ge(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return Di(t)?Promise.resolve(t.databases()).then(n=>n.map(i=>i.name).filter(i=>i!==pn)):Ci(t,r).toCollection().primaryKeys()}(ge.dependencies).then(e)}catch{return Ot(new ot.MissingAPI)}},defineClass:()=>function(e){Pt(this,e)},ignoreTransaction:e=>at.trans?qe(at.transless,e):e(),vip:ti,async:function(e){return function(){try{var t=ei(e.apply(this,arguments));return t&&typeof t.then=="function"?t:rt.resolve(t)}catch(r){return Ot(r)}}},spawn:function(e,t,r){try{var n=ei(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:rt.resolve(n)}catch(i){return Ot(i)}},currentTransaction:{get:()=>at.trans||null},waitFor:function(e,t){const r=rt.resolve(typeof e=="function"?ge.ignoreTransaction(e):e).timeout(t||6e4);return at.trans?at.trans.waitFor(r):r},Promise:rt,debug:{get:()=>Jt,set:e=>{La(e,e==="dexie"?()=>!0:to)}},derive:Be,extend:Pt,props:Ue,override:Na,Events:ar,on:he,liveQuery:wc,extendObservabilitySet:co,getByKeyPath:ie,setByKeyPath:$t,delByKeyPath:function(e,t){typeof t=="string"?$t(e,t,void 0):"length"in t&&[].map.call(t,function(r){$t(e,r,void 0)})},shallowClone:Ta,deepClone:wr,getObjectDiff:Ii,cmp:At,asap:Ba,minKey:Hn,addons:[],connections:ir,errnames:ki,dependencies:ni,semVer:Gi,version:Gi.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),ge.maxKey=mr(ge.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(he(pr,e=>{if(!re){let t;hn?(t=document.createEvent("CustomEvent"),t.initCustomEvent(ue,!0,!0,e)):t=new CustomEvent(ue,{detail:e}),re=!0,dispatchEvent(t),re=!1}}),addEventListener(ue,({detail:e})=>{re||Kr(e)}));let re=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(ue);typeof e.unref=="function"&&e.unref(),he(pr,t=>{re||e.postMessage(t)}),e.onmessage=t=>{t.data&&Kr(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){he(pr,t=>{try{re||(typeof localStorage<"u"&&localStorage.setItem(ue,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:ue,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===ue){const r=JSON.parse(t.newValue);r&&Kr(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===ue&&Kr(t.changedParts)})}rt.rejectionMapper=function(e,t){if(!e||e instanceof Fe||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Hi[e.name])return e;var r=new Hi[e.name](t||e.message,e);return"stack"in e&&ne(r,"stack",{get:function(){return this.inner.stack}}),r},La(Jt,to);var $r=(e=>(e.MOVE_TO_ROOT_FOLDER="moveToRootFolder",e.DELETE="delete",e))($r||{});const bc="comfyui_workspace_db";class _c extends xe{constructor(){super(bc);kt(this,"workflows");kt(this,"changelogs");kt(this,"media");kt(this,"folders");kt(this,"tags");kt(this,"userSettings");kt(this,"models");kt(this,"cache");kt(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(r=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID,cloudID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID,cloudID"}).upgrade(r=>{})}}const ct=new _c;class Ae{constructor(t){kt(this,"tableName");this.tableName=t}async saveDiskDB(){}async add(t){return t.id||(t.id=cr()),t.createTime||(t.createTime=Date.now()),await ct[this.tableName].add(t),t}async put(t){return await ct[this.tableName].put(t),t}async bulkPut(t){await ct[this.tableName].bulkPut(t)}async update(t,r){return await ct[this.tableName].update(t,r),await this.get(t)??null}async listAll(){return await ct[this.tableName].toArray()}async filter(t){return await ct[this.tableName].filter(t).toArray()}async batchQuery(t){return await ct[this.tableName].bulkGet(t)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const t=await xl(this.tableName);let r;try{r=t!=null?JSON.parse(t):null}catch{}if(r==null){const n=await Dl()??"{}";r=JSON.parse(n)[this.tableName]}return r??{}}async get(t){return await ct[this.tableName].get(t)}async delete(t){await ct[this.tableName].delete(t)}async listByIndex(t,r){return await ct[this.tableName].where(t).equals(r).toArray()}}const kc=80,on=class on extends Ae{constructor(){super("changelogs")}static async load(){return new on}async listByWorkflowID(t){return await ct.changelogs.where("workflowID").equals(t).reverse().sortBy("createTime")}async getLastestByWorkflowID(t){return(await this.listByWorkflowID(t))[0]}async create(t){const r=await this.getLastestByWorkflowID(t.workflowID);if(r!=null&&r.json===t.json)return null;const n={id:cr(),json:t.json,workflowID:t.workflowID,createTime:Date.now(),isAutoSave:t.isAutoSave};return await ct.changelogs.add(n),await this.deleteLogsExceedLimit(t.workflowID),n}async deleteLogsExceedLimit(t){var i;const r=await ct.changelogs.where("workflowID").equals(t).reverse().sortBy("createTime"),n=((i=X==null?void 0:X.settings)==null?void 0:i.maximumChangelogNumber)??kc;if(r.length>n){const a=r.slice(n);await ct.changelogs.bulkDelete(a.map(s=>s.id))}}};kt(on,"TABLE_NAME","changelogs");let ii=on;var Zt=(e=>(e.RECENTLY_OPENED="recentlyOpened",e.RECENTLY_MODIFIED="newest",e.OLDEST_MODIFIED="oldest",e.AZ="name A-Z",e.ZA="name Z-A",e))(Zt||{});function xc(e,t=!0,r=!1,n="-"){const i=new Date(e),a=String(i.getDate()).padStart(2,"0"),s=String(i.getMonth()+1).padStart(2,"0"),o=i.getFullYear(),l=String(i.getHours()).padStart(2,"0"),d=String(i.getMinutes()).padStart(2,"0"),c=String(i.getSeconds()).padStart(2,"0"),h=`${s}${n}${a}${n}${o}`;return t?h+` ${l}:${d}`:r?h+`:${c}`:h}const qr=(e,t=Zt.RECENTLY_MODIFIED)=>{const r=[...e];switch(t){case Zt.AZ:r.sort((n,i)=>n.name.localeCompare(i.name));break;case Zt.ZA:r.sort((n,i)=>i.name.localeCompare(n.name));break;case Zt.RECENTLY_MODIFIED:r.sort((n,i)=>i.updateTime-n.updateTime);break;case Zt.OLDEST_MODIFIED:r.sort((n,i)=>n.updateTime-i.updateTime);break;case Zt.RECENTLY_OPENED:r.sort((n,i)=>(i.lastOpenedTime??0)-(n.lastOpenedTime??0));break}return r};function Ec(e){return`/workspace/view_media?filename=${e}`}function ia(){const t=window.location.hash.slice(1).split("/").find(r=>r.includes("workspaceId@"));return t?t.split("@")[1]:null}function uo(e){const t=window.location.hash.slice(1).split("/"),r=t.findIndex(i=>i.includes("workspaceId@")),n=`workspaceId@${e}`;return r>=0?t[r]=n:t.push(n),`${t.join("/")}`}const Sc=e=>{const t=uo(e);window.open(`${window.location.origin}/#${t}`)},fo={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4},Bt="workspace_info",Oc=9999999,aa="upgrade_to_2way_sync",ho={os:null};function Hr(...e){const t=e.filter(r=>r!=="").join("/");return pe(t)}function pe(e){const t=e.split("/").filter(n=>n!=="").join("/");let r=t.replace(/\\/g,"/");return r=r.replace(/^\/+/,""),ho.os==="Windows"&&(r=t.replace(/\//g,"\\")),r}function Sn(e){return Hr(e.parentFolderID??"",e.name+".json")}var Lt;(e=>{async function t(l,d){try{const h=await(await St("/workspace/file/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Sn(l),newParentPath:d})})).json();return h.error?(alert("Error moving file: "+h.error),!1):!0}catch(c){console.error("Error deleting file:",c)}}e.moveWorkflow=t;async function r(l,d){try{const h=await(await St("/workspace/file/gen_unique_name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Hr(d??"",l)})})).json();return h.error?(console.error("Error getting unique name:",h.error),null):h.uniqueName}catch(c){console.error("Error deleting file:",c)}return null}e.genFileUniqueName=r;async function n({parentFolderID:l,name:d},c){try{const p=await(await St("/workspace/file/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Hr(l??"",d+".json"),newName:c})})).json();return p.error?(alert("Error rename file: "+p.error),!1):!0}catch(h){console.error("Error deleting file:",h)}}e.renameWorkflow=n;async function i(l){const d=l.json,c=JSON.parse(d);c.extra[Bt]==null&&(c.extra[Bt]={}),c.extra[Bt].id=l.id,c.extra[Bt].saveLock=l.saveLock,c.extra[Bt].cloudID=l.cloudID,c.extra[Bt].coverMediaPath=l.coverMediaPath;const p=await(await St("/workspace/file/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Sn(l),json:JSON.stringify(c)})})).json();if(p.error)throw console.error("Error saving file:",p.error),alert(`"Error saving file: ${p.error}
      
      Please try "Save as" from "Files" dropdown menu
      `),new Error(p.error);return p}e.saveWorkflow=i;async function a(l){try{return await(await St("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:Sn(l),deleteEmptyFolder:!1})})).text()}catch(d){alert("Error deleting workflow .json file: "+d),console.error("Error deleting file:",d)}}e.deleteWorkflow=a;async function s(l){var f;const{parentFolderID:d,name:c,json:h,id:p}=l;let u=JSON.parse(h);u.extra==null&&(u.extra={}),u.extra[Bt]==null&&(u.extra[Bt]={}),u.extra[Bt].id=p,u.extra[Bt].saveLock=l.saveLock,u.extra[Bt].cloudID=l.cloudID,u.extra[Bt].coverMediaPath=l.coverMediaPath;const b={parentFolderPath:pe(d??""),name:c,json:JSON.stringify(u)};try{const y=await(await St("/workspace/create_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).json();return y.name&&await((f=ct.workflows)==null?void 0:f.update(p,{name:y.name})),y}catch(v){return console.error(`Error creating file <${p}> at "${d}"`,v),alert(`Error creating file <${p}> at "${d}"`),{}}}e.createWorkflow=s;async function o({parentFolderID:l,name:d,id:c}){const h=Hr(l??"",d+".json");try{const u=await(await St("/workspace/get_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:h,id:c})})).json();return u.error&&(console.error(`Error getting file <${c}> at "${h}"`,u.error),alert({message:`Error getting file <${c}> at "${h}"`,level:"error"})),u}catch(p){return console.error(`Erro finding file <${c}> at "${h}"`,p),{}}}e.getFile=o})(Lt||(Lt={}));async function Pi(e,t=!1,r=!1){try{return await(await St("/workspace/file/scan_my_workflows_folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:pe(e),recursive:t,metaInfoOnly:r})})).json()}catch(n){return console.error("Error scan local new files:",n),[]}}async function Cc(e,t){const r=pe(e??""),i=(await Pi(r)).map(async o=>{var c;const l=o.name,d=[r,l].join("/");if(Dc(o))return{id:pe(d),name:o.name,parentFolderID:r,type:"folder",createTime:Date.now(),updateTime:Date.now()};{const h=await((c=ct.workflows)==null?void 0:c.get(o.id).catch(u=>(console.error("Error getting workflow from indexdb",o.id,d,u),null)));return{cloudID:o.cloudID,coverMediaPath:o.coverMediaPath,saveLock:o.saveLock,...h,id:o.id,json:o.json??"{}",name:l.replace(/\.json$/,""),parentFolderID:r,createTime:o.createTime,updateTime:o.updateTime}}}),a=await Promise.all(i);ct.workflows.bulkPut(a.filter(o=>!Ac(o)));const s=a.filter(o=>o!=null);return qr(s,t??Zt.RECENTLY_MODIFIED)}function Dc(e){return"type"in e&&e.type==="folder"}const sn=class sn extends Ae{constructor(){super("workflows");kt(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new sn}updateCurWorkflowID(r){if(r==null){this._curWorkflow=null;return}this.get(r).then(n=>{this._curWorkflow=n??null})}updateCurWorkflow(r){this._curWorkflow=r}async latestVersionCheck(){if(this._curWorkflow){const r=await ct.workflows.get(this._curWorkflow.id);return r?(r==null?void 0:r.updateTime)===this._curWorkflow.updateTime:!0}return!0}async listByIndex(r,n){const i=await super.listByIndex(r,n);return await(X==null?void 0:X.getSetting("twoWaySync"))?(await Promise.all(i.map(async o=>await this.get(o.id)))).filter(o=>o!=null):i}async generateUniqueName(r,n){if(await(X==null?void 0:X.getSetting("twoWaySync"))){const l=await Lt.genFileUniqueName((r??"Untitled Flow")+".json",n??"");return(l==null?void 0:l.replace(/\.json$/,""))??"Untitled Flow"}let a=r??"Untitled Flow";const o=(await this.listAll()??[]).filter(l=>l.parentFolderID==n).map(l=>l.name);if(o.includes(a)){let l=2,d=!0;for(;d;)o.includes(`${a} ${l}`)?l++:(a=`${a} ${l}`,d=!1)}return a}async createFlow(r){const{name:n}=r,i=await this.generateUniqueName(n,r.parentFolderID??void 0),a=Date.now(),s={...r,id:r.id??cr(),json:r.json??JSON.stringify(fo),name:i,updateTime:r.updateTime??a,createTime:r.createTime??a};return await ct.workflows.add(s),await(X==null?void 0:X.getSetting("twoWaySync"))?(await Lt.createWorkflow(s),await this.get(s.id)):s}async update(r,n){throw new Error("Method not allowed.")}async updateTopFields(r,n){return this._update(r,n)}async updateMetaInfo(r,n){return this._update(r,n)}async _update(r,n){await ct.workflows.update(r,n);const i=await ct.workflows.get(r)??null;return this._curWorkflow&&this._curWorkflow.id===r&&(this._curWorkflow=i),i}async updateFolder(r,n){const i=await(X==null?void 0:X.getSetting("twoWaySync")),a=await this.get(r);!await this.updateMetaInfo(r,n)||!a||i&&await Lt.moveWorkflow(a,n.parentFolderID)}async genLastManualSavedJson(r){const n=await(Se==null?void 0:Se.getLastestByWorkflowID(r));return n==null?void 0:n.json}async updateName(r,n){const i=await this.get(r);return await(X==null?void 0:X.getSetting("twoWaySync"))&&i&&await Lt.renameWorkflow(i,n.name+".json"),await this.updateMetaInfo(r,n)}async updateFlow(r,n){const i=await this.get(r,!1);if(i==null)return;const a=JSON.stringify(i.json),s=JSON.stringify(n.json);if(a===s)return;const o=await this._update(r,{updateTime:Date.now(),json:n.json});await(X==null?void 0:X.getSetting("twoWaySync"))&&o&&await Lt.saveWorkflow(o)}async batchCreateFlows(r=[],n=!1,i){var s,o;const a=[];for(const l of r){const d=l.name&&n?l.name:await this.generateUniqueName(l.name,i),c=cr(),h=Date.now(),p={id:c,name:d,json:l.json,parentFolderID:i,updateTime:h,createTime:h,tags:[]};if(a.push(p),await(X==null?void 0:X.getSetting("twoWaySync")))try{const b=JSON.parse(l.json),f=(o=(s=b==null?void 0:b.extra)==null?void 0:s[Bt])==null?void 0:o.id;f&&(await this.get(f)||(p.id=f)),Lt.createWorkflow(p)}catch(b){console.error("batchCreateFlows error",b)}}try{await ct.workflows.bulkAdd(a)}catch(l){console.error("batchCreateFlows error",l)}}async deleteFlow(r){const n=await this.get(r);n&&await(X==null?void 0:X.getSetting("twoWaySync"))&&await Lt.deleteWorkflow(n),await ct.workflows.delete(r)}async batchDeleteFlow(r){const n=await ct.workflows.bulkGet(r);for(const i of n){if(!i)return;await(X==null?void 0:X.getSetting("twoWaySync"))&&await Lt.deleteWorkflow(i)}await ct.workflows.bulkDelete(r)}async listFolderContent(r,n){if(await(X==null?void 0:X.getSetting("twoWaySync"))){const l=await Cc(r??null);return qr(l,n??Zt.RECENTLY_MODIFIED)}const a=await this.listAll().then(l=>l.filter(d=>d.parentFolderID==r))??[],s=await(Ee==null?void 0:Ee.listAll().then(l=>l.filter(d=>d.parentFolderID==r)))??[],o=[...a,...s];return qr(o,n??Zt.RECENTLY_MODIFIED)}async get(r,n=!0){const i=await(X==null?void 0:X.getSetting("twoWaySync")),a=await ct.workflows.get(r);if(!i||!n)return a;if(a==null)return;const s=await Lt.getFile({parentFolderID:a.parentFolderID??null,name:a.name,id:a.id});if(s.json)return{...a,json:JSON.stringify(s.json)}}async listAll(r){const n=await(X==null?void 0:X.getSetting("twoWaySync"));let i;if(n){const s=(await Pi("",!0)).filter(o=>(o==null?void 0:o.type)==="workflow").map(async o=>{const l=await ct.workflows.get(o.id);return o.updateTime=(l==null?void 0:l.updateTime)??Date.now(),l!=null&&l.lastOpenedTime&&(o.lastOpenedTime=l==null?void 0:l.lastOpenedTime),o});i=await Promise.all(s)}else i=await ct.workflows.toArray();return r?qr(i,r):i}async updateLastOpenedTime(r){await ct.workflows.update(r,{lastOpenedTime:Date.now()})}};kt(sn,"TABLE_NAME","workflows");let ai=sn;var ve;(e=>{async function t({parentFolderID:o,name:l}){return pe(`${o??""}/${l}`)}e.genFolderRelPath=t;async function r(o){await St("/workspace/folder/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:pe(o.id)})})}e.createFolder=r;async function n(o,l){const c=await(await St("/workspace/folder/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder:o,newParentPath:l})})).json();c.error&&alert("Failed to move folder: "+c.error)}e.moveFolder=n;async function i(o){try{return await(await St("/workspace/folder/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})})).text()}catch(l){console.error("Error deleting file:",l)}}e.deleteFolder=i;async function a(o){try{const d=await(await St("/workspace/file/count_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o})})).json();return d.error&&console.error("Error counting files:",d.error),d.count}catch(l){console.error("Error renaming file:",l)}return null}e.genFilesCountInFolder=a;async function s(o,l){try{const c=await(await St("/workspace/folder/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absPath:o,newName:l})})).json();c.error&&alert("Failed to rename folder: "+c.error)}catch(d){console.error("Error renaming file:",d)}}e.renameFolder=s})(ve||(ve={}));const ln=class ln extends Ae{constructor(){super("folders")}static async load(){return new ln}async create(t){const r=await this.generateUniqueName(t.name,t.parentFolderID),n=await(X==null?void 0:X.getSetting("twoWaySync")),i=await ve.genFolderRelPath({name:r,parentFolderID:t.parentFolderID??""}),a={id:n?i:cr(),name:r,parentFolderID:t.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return n?await ve.createFolder(a):(await ct.folders.add(a),this.saveDiskDB()),a}async update(t,r){if(await(X==null?void 0:X.getSetting("twoWaySync")))return"parentFolderID"in r&&await ve.moveFolder(t,r.parentFolderID??""),"name"in r&&await ve.renameFolder(t,r.name??""),null;const i=await this.get(t);if(i==null)return null;"name"in r&&r.name!=i.name;const a="parentFolderID"in r&&r.parentFolderID!=i.parentFolderID,s={...i,...r};return r.name!=null&&(s.updateTime=Date.now()),a&&(r.name=await this.generateUniqueName(s.name,s.parentFolderID??void 0)),await ct.folders.update(t,r),this.saveDiskDB(),s}async deleteFolder(t,r=$r.DELETE){if(await(X==null?void 0:X.getSetting("twoWaySync"))){await Pi(t,!0,!0).then(o=>{o.forEach(l=>{l.type==="workflow"&&(G==null||G.deleteFlow(l.id))})}),await ve.deleteFolder(t);return}const i=await(G==null?void 0:G.listAll())??[],a=await this.listAll(),s=[t];for(;s.length>0;){const o=s.shift();if(o){for(const d of i)if(d.parentFolderID===o)switch(r){case $r.DELETE:await(G==null?void 0:G.deleteFlow(d.id));break;case $r.MOVE_TO_ROOT_FOLDER:await(G==null?void 0:G.updateFolder(d.id,{parentFolderID:void 0}));break}await ct.folders.delete(o);const l=a.filter(d=>d.parentFolderID===o).map(d=>d.id);l.length&&s.push(...l)}}this.saveDiskDB()}async generateUniqueName(t,r){if(await(X==null?void 0:X.getSetting("twoWaySync")))return await Lt.genFileUniqueName(t??"New folder",r??"")??"New folder";let i=t??"New folder";const a=await this.listAll().then(s=>s.filter(o=>o.parentFolderID==r).map(o=>o.name));if(a.includes(i)){let s=2,o=!0;for(;o;)a.includes(`${i} ${s}`)?s++:(i=`${i} ${s}`,o=!1)}return i}};kt(ln,"TABLE_NAME","folders");let oi=ln;class po extends Ae{constructor(){super("media")}async listByWorkflowID(t){return await ct.media.where("workflowID").equals(t).reverse().sortBy("createTime")}async create(t){if(t.localPath.split(".").pop()==null)return null;const n={id:t.localPath,localPath:t.localPath,workflowID:t.workflowID,createTime:Date.now()};return await(G==null?void 0:G.updateMetaInfo(t.workflowID,{latestImage:n.localPath})),ct.media.put(n),n}async delete(t){var r,n;super.delete(t),((r=G==null?void 0:G.curWorkflow)==null?void 0:r.coverMediaPath)===t&&(G==null||G.updateMetaInfo(G.curWorkflow.id,{coverMediaPath:void 0})),((n=G==null?void 0:G.curWorkflow)==null?void 0:n.latestImage)===t&&(G==null||G.updateMetaInfo(G.curWorkflow.id,{latestImage:void 0}))}}kt(po,"TABLE_NAME","media");const Ic={Checkpoint:"checkpoints",TextualInversion:"embeddings",Hypernetwork:"hypernetworks",LORA:"loras",Controlnet:"controlnet",Upscaler:"upscale_models",VAE:"vae"},cn=class cn extends Ae{constructor(){super("userSettings");kt(this,"defaultSettings");kt(this,"DEFAULT_USER","guest");kt(this,"_settings");this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S",saveAs:"Control+Alt+S",openSpotlightSearch:"Control+P"},defaultFolders:Ic,autoSave:!1,autoSaveDuration:3,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.nodecafe.co",maximumChangelogNumber:80,hideCoverImage:!1,disableUnsavedWarning:!1}}get settings(){return this._settings}async getSetting(r){const n=await this.get(this.DEFAULT_USER);return r==="shortcuts"&&(n!=null&&n.shortcuts)?{...this.defaultSettings.shortcuts,...n.shortcuts}:(n==null?void 0:n[r])??this.defaultSettings[r]}async get(r){return await St("/workspace/get_settings",{headers:{"Content-Type":"application/json"}}).then(i=>i.json())}async upsert(r){const i={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...r};await St("/workspace/save_settings",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}),this._settings={...this.defaultSettings,...i}}static async load(){var i,a,s,o;const r=new cn,n=await El();return r.defaultSettings.myWorkflowsDir=n.path,await r.get(r.DEFAULT_USER).then(l=>{r._settings={...r.defaultSettings,...l}}),((a=(i=r._settings)==null?void 0:i.cloudHost)!=null&&a.includes("nodecafe.org")||(o=(s=r._settings)==null?void 0:s.cloudHost)!=null&&o.includes("comfyspace.art"))&&await r.upsert({cloudHost:r.defaultSettings.cloudHost}),r}};kt(cn,"TABLE_NAME","userSettings");let si=cn;const un=class un extends Ae{constructor(){super("tags")}static async load(){return new un}};kt(un,"TABLE_NAME","tags");let li=un;const dn=class dn extends Ae{constructor(){super("workflowVersions")}static async load(){return new dn}async listByWorkflowID(t){return await ct[this.tableName].where("workflowID").equals(t).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(t){const r=await this.listByWorkflowID(t);return r!=null&&r.length?r[0]:null}};kt(dn,"TABLE_NAME","workflowVersions");let ci=dn;function Ac(e){return"type"in e&&e.type==="folder"}let G=null,X=null,Ee=null,Se=null,Zr=null,Ft=null;async function Pc(){const e=async()=>{G=await ai.load()},t=async()=>{await li.load()},r=async()=>{X=await si.load()},n=async()=>{Ee=await oi.load()},i=async()=>{Se=await ii.load()},a=async()=>{Zr=new po},s=async()=>{Ft=await ci.load()};await Promise.all([e(),t(),r(),n(),i(),a(),s()])}const mo=Q.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:async()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{},route:"root",curVersion:null,setIsDirty:()=>{},setCurVersion:()=>{},setCurFlowIDAndName:()=>{},session:null,updateSession:()=>{}});Q.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}});const On={x:0,y:0};function jc({children:e,onDragEnd:t,dragIconId:r}){const n=Q.useRef(On),i=Q.useRef(!1),[a,s]=Q.useState(On),o=h=>{var p,u,b;if(!(!(h.target instanceof Element)||!(h.target.parentNode instanceof Element))&&[(p=h.target)==null?void 0:p.id,(b=(u=h.target)==null?void 0:u.parentNode)==null?void 0:b.id].includes(r)){n.current={x:h.clientX,y:h.clientY},i.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",d);const f=document.getElementsByTagName("body")[0];f.style.userSelect="none"}},l=Q.useCallback(h=>{const p={x:h.clientX-n.current.x,y:h.clientY-n.current.y};s(p)},[]),d=Q.useCallback(()=>{s(p=>(setTimeout(()=>{t(p)},0),On)),i.current=!1;const h=document.getElementsByTagName("body")[0];h.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",d)},[t,l]),c={transform:`translate(${a.x}px, ${a.y}px)`,zIndex:i.current?1e3:1};return lt.jsx("div",{style:c,onMouseDown:o,children:e})}var Rc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},Nc=Object.defineProperty,Bc=Object.defineProperties,Fc=Object.getOwnPropertyDescriptors,an=Object.getOwnPropertySymbols,yo=Object.prototype.hasOwnProperty,go=Object.prototype.propertyIsEnumerable,oa=(e,t,r)=>t in e?Nc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,sa=(e,t)=>{for(var r in t||(t={}))yo.call(t,r)&&oa(e,r,t[r]);if(an)for(var r of an(t))go.call(t,r)&&oa(e,r,t[r]);return e},Tc=(e,t)=>Bc(e,Fc(t)),zc=(e,t)=>{var r={};for(var n in e)yo.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&an)for(var n of an(e))t.indexOf(n)<0&&go.call(e,n)&&(r[n]=e[n]);return r},vo=(e,t,r)=>{const n=Q.forwardRef((i,a)=>{var s=i,{color:o="currentColor",size:l=24,stroke:d=2,children:c}=s,h=zc(s,["color","size","stroke","children"]);return Q.createElement("svg",sa(Tc(sa({ref:a},Rc),{width:l,height:l,stroke:o,strokeWidth:d,className:`tabler-icon tabler-icon-${e}`}),h),[...r.map(([p,u])=>Q.createElement(p,u)),...c||[]])});return n.propTypes={color:ye.string,size:ye.oneOfType([ye.string,ye.number]),stroke:ye.oneOfType([ye.string,ye.number])},n.displayName=`${t}`,n},Wc=vo("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),Lc=vo("message","IconMessage",[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]]);function Mc({onChatClick:e,showChat:t}){const[r,n]=Q.useState(),i=Q.useCallback((a,s=!1)=>{const{top:o=0,left:l=0}=r||{};let{top:d=0,left:c=0}=a??{};d+=o,c+=l;const h=document.documentElement.clientWidth,p=document.documentElement.clientHeight,u=document.getElementById("workspaceManagerPanel"),b=(u==null?void 0:u.offsetWidth)||392;d+36>p&&(d=p-36),c+b>=h&&(c=h-b),n({top:Math.max(0,d),left:Math.max(0,c)}),s&&(X==null||X.upsert({topBarStyle:{top:d,left:c}}))},[r]);return Q.useEffect(()=>{X==null||X.getSetting("topBarStyle").then(a=>{i(a,!1)})},[]),r?lt.jsx(jc,{onDragEnd:a=>{i({top:a.y,left:a.x},!0)},dragIconId:"dragPanelIcon",children:lt.jsx(ba,{style:{padding:2,position:"fixed",...r},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:lt.jsx(ja,{label:"Chat with AI about this workflow",children:lt.jsx(ha,{size:"sm",variant:"ghost",onClick:e,isActive:t,"aria-label":"Chat",children:lt.jsx(Lc,{size:20})})})})}):null}function Uc(){const{showDialog:e}=pa(),{loadWorkflowID:t}=Q.useContext(mo),r=async(i,a)=>{var d,c;const{workflow:s,version:o}=i.detail;if(!s.id||!o.id)return;const l=(d=await(G==null?void 0:G.listByIndex("cloudID",s.id)))==null?void 0:d.at(0);if(l){const h=(c=await(Ft==null?void 0:Ft.listByIndex("cloudID",o.id)))==null?void 0:c.at(0);if(h)await t(l.id,h.id);else{const p=await(Ft==null?void 0:Ft.add({id:o.id,cloudID:o.id,workflowID:l.id,cloudOrigin:a,name:o.name,authorID:o.authorID,json:o.json}));p&&t(l.id,p.id)}}else{const h=await(G==null?void 0:G.createFlow({cloudID:s.id,cloudOrigin:a,name:s.name,json:o.json,updateTime:Date.now()}));if(!h){alert("Failed to add workflow to local db");return}const p=await(Ft==null?void 0:Ft.put({id:o.id,cloudID:o.id,workflowID:h.id,cloudOrigin:a,name:o.name,json:o.json,authorID:o.authorID,createTime:Date.now()}));await t(h.id,p==null?void 0:p.id)}},n=async i=>{const a=i.data;if(Kc(a)){const s=i.origin;e(`Open workflow "${a.detail.workflow.name}", version "${a.detail.version.name}" from ${s}`,[{label:"Open",colorScheme:"teal",onClick:()=>{r(a,s)}}])}};return Q.useEffect(()=>{window.opener&&window.opener.postMessage("comfyui_workspace_manager_connected","*"),window.addEventListener("message",n)},[]),null}function Kc(e){return e.type==="workspace_open_workflow"}const $c=e=>typeof e=="function",qc=e=>{const[t,r]=Q.useState(e),n=Q.useRef(t),i=Q.useCallback(a=>{n.current=$c(a)?a(n.current):a,r(n.current)},[]);return[t,i,n]};function Nr(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wo={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,a){function s(d,c){if(!i[d]){if(!n[d]){var h=typeof Nr=="function"&&Nr;if(!c&&h)return h(d,!0);if(o)return o(d,!0);var p=new Error("Cannot find module '"+d+"'");throw p.code="MODULE_NOT_FOUND",p}var u=i[d]={exports:{}};n[d][0].call(u.exports,function(b){var f=n[d][1][b];return s(f||b)},u,u.exports,r,n,i,a)}return i[d].exports}for(var o=typeof Nr=="function"&&Nr,l=0;l<a.length;l++)s(a[l]);return s}({1:[function(r,n,i){var a=r("./utils"),s=r("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var d,c,h,p,u,b,f,v=[],y=0,w=l.length,_=w,k=a.getTypeOf(l)!=="string";y<l.length;)_=w-y,h=k?(d=l[y++],c=y<w?l[y++]:0,y<w?l[y++]:0):(d=l.charCodeAt(y++),c=y<w?l.charCodeAt(y++):0,y<w?l.charCodeAt(y++):0),p=d>>2,u=(3&d)<<4|c>>4,b=1<_?(15&c)<<2|h>>6:64,f=2<_?63&h:64,v.push(o.charAt(p)+o.charAt(u)+o.charAt(b)+o.charAt(f));return v.join("")},i.decode=function(l){var d,c,h,p,u,b,f=0,v=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var w,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&_--,l.charAt(l.length-2)===o.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=s.uint8array?new Uint8Array(0|_):new Array(0|_);f<l.length;)d=o.indexOf(l.charAt(f++))<<2|(p=o.indexOf(l.charAt(f++)))>>4,c=(15&p)<<4|(u=o.indexOf(l.charAt(f++)))>>2,h=(3&u)<<6|(b=o.indexOf(l.charAt(f++))),w[v++]=d,u!==64&&(w[v++]=c),b!==64&&(w[v++]=h);return w}},{"./support":30,"./utils":32}],2:[function(r,n,i){var a=r("./external"),s=r("./stream/DataWorker"),o=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function d(c,h,p,u,b){this.compressedSize=c,this.uncompressedSize=h,this.crc32=p,this.compression=u,this.compressedContent=b}d.prototype={getContentWorker:function(){var c=new s(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new s(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(c,h,p){return c.pipe(new o).pipe(new l("uncompressedSize")).pipe(h.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},n.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var a=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var a=r("./utils"),s=function(){for(var o,l=[],d=0;d<256;d++){o=d;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;l[d]=o}return l}();n.exports=function(o,l){return o!==void 0&&o.length?a.getTypeOf(o)!=="string"?function(d,c,h,p){var u=s,b=p+h;d^=-1;for(var f=p;f<b;f++)d=d>>>8^u[255&(d^c[f])];return-1^d}(0|l,o,o.length,0):function(d,c,h,p){var u=s,b=p+h;d^=-1;for(var f=p;f<b;f++)d=d>>>8^u[255&(d^c.charCodeAt(f))];return-1^d}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var a=null;a=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:a}},{lie:37}],7:[function(r,n,i){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),o=r("./utils"),l=r("./stream/GenericWorker"),d=a?"uint8array":"array";function c(h,p){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=p,this.meta={}}i.magic="\b\0",o.inherits(c,l),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(d,h.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(p){h.push({data:p,meta:h.meta})}},i.compressWorker=function(h){return new c("Deflate",h)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function a(u,b){var f,v="";for(f=0;f<b;f++)v+=String.fromCharCode(255&u),u>>>=8;return v}function s(u,b,f,v,y,w){var _,k,x=u.file,I=u.compression,O=w!==d.utf8encode,R=o.transformTo("string",w(x.name)),D=o.transformTo("string",d.utf8encode(x.name)),j=x.comment,M=o.transformTo("string",w(j)),C=o.transformTo("string",d.utf8encode(j)),B=D.length!==x.name.length,g=C.length!==j.length,L="",tt="",A="",Z=x.dir,z=x.date,H={crc32:0,compressedSize:0,uncompressedSize:0};b&&!f||(H.crc32=u.crc32,H.compressedSize=u.compressedSize,H.uncompressedSize=u.uncompressedSize);var F=0;b&&(F|=8),O||!B&&!g||(F|=2048);var N=0,nt=0;Z&&(N|=16),y==="UNIX"?(nt=798,N|=function(q,ht){var vt=q;return q||(vt=ht?16893:33204),(65535&vt)<<16}(x.unixPermissions,Z)):(nt=20,N|=function(q){return 63&(q||0)}(x.dosPermissions)),_=z.getUTCHours(),_<<=6,_|=z.getUTCMinutes(),_<<=5,_|=z.getUTCSeconds()/2,k=z.getUTCFullYear()-1980,k<<=4,k|=z.getUTCMonth()+1,k<<=5,k|=z.getUTCDate(),B&&(tt=a(1,1)+a(c(R),4)+D,L+="up"+a(tt.length,2)+tt),g&&(A=a(1,1)+a(c(M),4)+C,L+="uc"+a(A.length,2)+A);var J="";return J+=`
\0`,J+=a(F,2),J+=I.magic,J+=a(_,2),J+=a(k,2),J+=a(H.crc32,4),J+=a(H.compressedSize,4),J+=a(H.uncompressedSize,4),J+=a(R.length,2),J+=a(L.length,2),{fileRecord:h.LOCAL_FILE_HEADER+J+R+L,dirRecord:h.CENTRAL_FILE_HEADER+a(nt,2)+J+a(M.length,2)+"\0\0\0\0"+a(N,4)+a(v,4)+R+L+M}}var o=r("../utils"),l=r("../stream/GenericWorker"),d=r("../utf8"),c=r("../crc32"),h=r("../signature");function p(u,b,f,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=f,this.encodeFileName=v,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(p,l),p.prototype.push=function(u){var b=u.meta.percent||0,f=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,l.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:f?(b+100*(f-v-1))/f:100}}))},p.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var b=this.streamFiles&&!u.file.dir;if(b){var f=s(u,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:f.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(u){this.accumulate=!1;var b=this.streamFiles&&!u.file.dir,f=s(u,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(f.dirRecord),b)this.push({data:function(v){return h.DATA_DESCRIPTOR+a(v.crc32,4)+a(v.compressedSize,4)+a(v.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:f.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var u=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var f=this.bytesWritten-u,v=function(y,w,_,k,x){var I=o.transformTo("string",x(k));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(y,2)+a(y,2)+a(w,4)+a(_,4)+a(I.length,2)+I}(this.dirRecords.length,f,u,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(u){this._sources.push(u);var b=this;return u.on("data",function(f){b.processChunk(f)}),u.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),u.on("error",function(f){b.error(f)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(u){var b=this._sources;if(!l.prototype.error.call(this,u))return!1;for(var f=0;f<b.length;f++)try{b[f].error(u)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var u=this._sources,b=0;b<u.length;b++)u[b].lock()},n.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var a=r("../compressions"),s=r("./ZipFileWorker");i.generateWorker=function(o,l,d){var c=new s(l.streamFiles,d,l.platform,l.encodeFileName),h=0;try{o.forEach(function(p,u){h++;var b=function(w,_){var k=w||_,x=a[k];if(!x)throw new Error(k+" is not a valid compression method !");return x}(u.options.compression,l.compression),f=u.options.compressionOptions||l.compressionOptions||{},v=u.dir,y=u.date;u._compressWorker(b,f).withStreamInfo("file",{name:p,dir:v,date:y,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(c)}),c.entriesCount=h}catch(p){c.error(p)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new a;for(var o in this)typeof this[o]!="function"&&(s[o]=this[o]);return s}}(a.prototype=r("./object")).loadAsync=r("./load"),a.support=r("./support"),a.defaults=r("./defaults"),a.version="3.10.1",a.loadAsync=function(s,o){return new a().loadAsync(s,o)},a.external=r("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var a=r("./utils"),s=r("./external"),o=r("./utf8"),l=r("./zipEntries"),d=r("./stream/Crc32Probe"),c=r("./nodejsUtils");function h(p){return new s.Promise(function(u,b){var f=p.decompressed.getContentWorker().pipe(new d);f.on("error",function(v){b(v)}).on("end",function(){f.streamInfo.crc32!==p.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}n.exports=function(p,u){var b=this;return u=a.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(p)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",p,!0,u.optimizedBinaryString,u.base64).then(function(f){var v=new l(u);return v.load(f),v}).then(function(f){var v=[s.Promise.resolve(f)],y=f.files;if(u.checkCRC32)for(var w=0;w<y.length;w++)v.push(h(y[w]));return s.Promise.all(v)}).then(function(f){for(var v=f.shift(),y=v.files,w=0;w<y.length;w++){var _=y[w],k=_.fileNameStr,x=a.resolve(_.fileNameStr);b.file(x,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:u.createFolders}),_.dir||(b.file(x).unsafeOriginalName=k)}return v.zipComment.length&&(b.comment=v.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var a=r("../utils"),s=r("../stream/GenericWorker");function o(l,d){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(d)}a.inherits(o,s),o.prototype._bindStream=function(l){var d=this;(this._stream=l).pause(),l.on("data",function(c){d.push({data:c,meta:{percent:0}})}).on("error",function(c){d.isPaused?this.generatedError=c:d.error(c)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},o.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var a=r("readable-stream").Readable;function s(o,l,d){a.call(this,l),this._helper=o;var c=this;o.on("data",function(h,p){c.push(h)||c._helper.pause(),d&&d(p)}).on("error",function(h){c.emit("error",h)}).on("end",function(){c.push(null)})}r("../utils").inherits(s,a),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,s);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,s)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var s=new Buffer(a);return s.fill(0),s},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(r,n,i){function a(x,I,O){var R,D=o.getTypeOf(I),j=o.extend(O||{},c);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&16384&j.unixPermissions&&(j.dir=!0),j.dosPermissions&&16&j.dosPermissions&&(j.dir=!0),j.dir&&(x=y(x)),j.createFolders&&(R=v(x))&&w.call(this,R,!0);var M=D==="string"&&j.binary===!1&&j.base64===!1;O&&O.binary!==void 0||(j.binary=!M),(I instanceof h&&I.uncompressedSize===0||j.dir||!I||I.length===0)&&(j.base64=!1,j.binary=!0,I="",j.compression="STORE",D="string");var C=null;C=I instanceof h||I instanceof l?I:b.isNode&&b.isStream(I)?new f(x,I):o.prepareContent(x,I,j.binary,j.optimizedBinaryString,j.base64);var B=new p(x,C,j);this.files[x]=B}var s=r("./utf8"),o=r("./utils"),l=r("./stream/GenericWorker"),d=r("./stream/StreamHelper"),c=r("./defaults"),h=r("./compressedObject"),p=r("./zipObject"),u=r("./generate"),b=r("./nodejsUtils"),f=r("./nodejs/NodejsStreamInputAdapter"),v=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var I=x.lastIndexOf("/");return 0<I?x.substring(0,I):""},y=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},w=function(x,I){return I=I!==void 0?I:c.createFolders,x=y(x),this.files[x]||a.call(this,x,null,{dir:!0,createFolders:I}),this.files[x]};function _(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var I,O,R;for(I in this.files)R=this.files[I],(O=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&x(O,R)},filter:function(x){var I=[];return this.forEach(function(O,R){x(O,R)&&I.push(R)}),I},file:function(x,I,O){if(arguments.length!==1)return x=this.root+x,a.call(this,x,I,O),this;if(_(x)){var R=x;return this.filter(function(j,M){return!M.dir&&R.test(j)})}var D=this.files[this.root+x];return D&&!D.dir?D:null},folder:function(x){if(!x)return this;if(_(x))return this.filter(function(D,j){return j.dir&&x.test(D)});var I=this.root+x,O=w.call(this,I),R=this.clone();return R.root=O.name,R},remove:function(x){x=this.root+x;var I=this.files[x];if(I||(x.slice(-1)!=="/"&&(x+="/"),I=this.files[x]),I&&!I.dir)delete this.files[x];else for(var O=this.filter(function(D,j){return j.name.slice(0,x.length)===x}),R=0;R<O.length;R++)delete this.files[O[R].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var I,O={};try{if((O=o.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");o.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var R=O.comment||this.comment||"";I=u.generateWorker(this,O,R)}catch(D){(I=new l("error")).error(D)}return new d(I,O.type||"string",O.mimeType)},generateAsync:function(x,I){return this.generateInternalStream(x).accumulate(I)},generateNodeStream:function(x,I){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(I)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var a=r("./DataReader");function s(o){a.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}r("../utils").inherits(s,a),s.prototype.byteAt=function(o){return this.data[this.zero+o]},s.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),d=o.charCodeAt(1),c=o.charCodeAt(2),h=o.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===d&&this.data[p+2]===c&&this.data[p+3]===h)return p-this.zero;return-1},s.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),d=o.charCodeAt(1),c=o.charCodeAt(2),h=o.charCodeAt(3),p=this.readData(4);return l===p[0]&&d===p[1]&&c===p[2]&&h===p[3]},s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var a=r("../utils");function s(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,d=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)d=(d<<8)+this.byteAt(l);return this.index+=o,d},readString:function(o){return a.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=s},{"../utils":32}],19:[function(r,n,i){var a=r("./Uint8ArrayReader");function s(o){a.call(this,o)}r("../utils").inherits(s,a),s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var a=r("./DataReader");function s(o){a.call(this,o)}r("../utils").inherits(s,a),s.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},s.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},s.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},s.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var a=r("./ArrayReader");function s(o){a.call(this,o)}r("../utils").inherits(s,a),s.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var a=r("../utils"),s=r("../support"),o=r("./ArrayReader"),l=r("./StringReader"),d=r("./NodeBufferReader"),c=r("./Uint8ArrayReader");n.exports=function(h){var p=a.getTypeOf(h);return a.checkSupport(p),p!=="string"||s.uint8array?p==="nodebuffer"?new d(h):s.uint8array?new c(a.transformTo("uint8array",h)):new o(a.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var a=r("./GenericWorker"),s=r("../utils");function o(l){a.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(o,a),o.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var a=r("./GenericWorker"),s=r("../crc32");function o(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(o,a),o.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var a=r("../utils"),s=r("./GenericWorker");function o(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}a.inherits(o,s),o.prototype.processChunk=function(l){if(l){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+l.data.length}s.prototype.processChunk.call(this,l)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var a=r("../utils"),s=r("./GenericWorker");function o(l){s.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){d.dataIsReady=!0,d.data=c,d.max=c&&c.length||0,d.type=a.getTypeOf(c),d.isPaused||d._tickAndRepeat()},function(c){d.error(c)})}a.inherits(o,s),o.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,d);break;case"uint8array":l=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":l=this.data.slice(this.index,d)}return this.index=d,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function a(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,o){return this._listeners[s].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,o){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,o)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var o=this;return s.on("data",function(l){o.processChunk(l)}),s.on("end",function(){o.end()}),s.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,o){return this.extraStreamInfo[s]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=a},{}],29:[function(r,n,i){var a=r("../utils"),s=r("./ConvertWorker"),o=r("./GenericWorker"),l=r("../base64"),d=r("../support"),c=r("../external"),h=null;if(d.nodestream)try{h=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(b,f){return new c.Promise(function(v,y){var w=[],_=b._internalType,k=b._outputType,x=b._mimeType;b.on("data",function(I,O){w.push(I),f&&f(O)}).on("error",function(I){w=[],y(I)}).on("end",function(){try{var I=function(O,R,D){switch(O){case"blob":return a.newBlob(a.transformTo("arraybuffer",R),D);case"base64":return l.encode(R);default:return a.transformTo(O,R)}}(k,function(O,R){var D,j=0,M=null,C=0;for(D=0;D<R.length;D++)C+=R[D].length;switch(O){case"string":return R.join("");case"array":return Array.prototype.concat.apply([],R);case"uint8array":for(M=new Uint8Array(C),D=0;D<R.length;D++)M.set(R[D],j),j+=R[D].length;return M;case"nodebuffer":return Buffer.concat(R);default:throw new Error("concat : unsupported type '"+O+"'")}}(_,w),x);v(I)}catch(O){y(O)}w=[]}).resume()})}function u(b,f,v){var y=f;switch(f){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=f,this._mimeType=v,a.checkSupport(y),this._worker=b.pipe(new s(y)),b.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}u.prototype={accumulate:function(b){return p(this,b)},on:function(b,f){var v=this;return b==="data"?this._worker.on(b,function(y){f.call(v,y.data,y.meta)}):this._worker.on(b,function(){a.delay(f,arguments,v)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},b)}},n.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var a=new ArrayBuffer(0);try{i.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(a),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var a=r("./utils"),s=r("./support"),o=r("./nodejsUtils"),l=r("./stream/GenericWorker"),d=new Array(256),c=0;c<256;c++)d[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;d[254]=d[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}i.utf8encode=function(u){return s.nodebuffer?o.newBufferFrom(u,"utf-8"):function(b){var f,v,y,w,_,k=b.length,x=0;for(w=0;w<k;w++)(64512&(v=b.charCodeAt(w)))==55296&&w+1<k&&(64512&(y=b.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),w++),x+=v<128?1:v<2048?2:v<65536?3:4;for(f=s.uint8array?new Uint8Array(x):new Array(x),w=_=0;_<x;w++)(64512&(v=b.charCodeAt(w)))==55296&&w+1<k&&(64512&(y=b.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),w++),v<128?f[_++]=v:(v<2048?f[_++]=192|v>>>6:(v<65536?f[_++]=224|v>>>12:(f[_++]=240|v>>>18,f[_++]=128|v>>>12&63),f[_++]=128|v>>>6&63),f[_++]=128|63&v);return f}(u)},i.utf8decode=function(u){return s.nodebuffer?a.transformTo("nodebuffer",u).toString("utf-8"):function(b){var f,v,y,w,_=b.length,k=new Array(2*_);for(f=v=0;f<_;)if((y=b[f++])<128)k[v++]=y;else if(4<(w=d[y]))k[v++]=65533,f+=w-1;else{for(y&=w===2?31:w===3?15:7;1<w&&f<_;)y=y<<6|63&b[f++],w--;1<w?k[v++]=65533:y<65536?k[v++]=y:(y-=65536,k[v++]=55296|y>>10&1023,k[v++]=56320|1023&y)}return k.length!==v&&(k.subarray?k=k.subarray(0,v):k.length=v),a.applyFromCharCode(k)}(u=a.transformTo(s.uint8array?"uint8array":"array",u))},a.inherits(h,l),h.prototype.processChunk=function(u){var b=a.transformTo(s.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var f=b;(b=new Uint8Array(f.length+this.leftOver.length)).set(this.leftOver,0),b.set(f,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var v=function(w,_){var k;for((_=_||w.length)>w.length&&(_=w.length),k=_-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?_:k+d[w[k]]>_?k:_}(b),y=b;v!==b.length&&(s.uint8array?(y=b.subarray(0,v),this.leftOver=b.subarray(v,b.length)):(y=b.slice(0,v),this.leftOver=b.slice(v,b.length))),this.push({data:i.utf8decode(y),meta:u.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=h,a.inherits(p,l),p.prototype.processChunk=function(u){this.push({data:i.utf8encode(u.data),meta:u.meta})},i.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var a=r("./support"),s=r("./base64"),o=r("./nodejsUtils"),l=r("./external");function d(f){return f}function c(f,v){for(var y=0;y<f.length;++y)v[y]=255&f.charCodeAt(y);return v}r("setimmediate"),i.newBlob=function(f,v){i.checkSupport("blob");try{return new Blob([f],{type:v})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(f),y.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(f,v,y){var w=[],_=0,k=f.length;if(k<=y)return String.fromCharCode.apply(null,f);for(;_<k;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,f.slice(_,Math.min(_+y,k)))):w.push(String.fromCharCode.apply(null,f.subarray(_,Math.min(_+y,k)))),_+=y;return w.join("")},stringifyByChar:function(f){for(var v="",y=0;y<f.length;y++)v+=String.fromCharCode(f[y]);return v},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function p(f){var v=65536,y=i.getTypeOf(f),w=!0;if(y==="uint8array"?w=h.applyCanBeUsed.uint8array:y==="nodebuffer"&&(w=h.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return h.stringifyByChunk(f,y,v)}catch{v=Math.floor(v/2)}return h.stringifyByChar(f)}function u(f,v){for(var y=0;y<f.length;y++)v[y]=f[y];return v}i.applyFromCharCode=p;var b={};b.string={string:d,array:function(f){return c(f,new Array(f.length))},arraybuffer:function(f){return b.string.uint8array(f).buffer},uint8array:function(f){return c(f,new Uint8Array(f.length))},nodebuffer:function(f){return c(f,o.allocBuffer(f.length))}},b.array={string:p,array:d,arraybuffer:function(f){return new Uint8Array(f).buffer},uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(f)}},b.arraybuffer={string:function(f){return p(new Uint8Array(f))},array:function(f){return u(new Uint8Array(f),new Array(f.byteLength))},arraybuffer:d,uint8array:function(f){return new Uint8Array(f)},nodebuffer:function(f){return o.newBufferFrom(new Uint8Array(f))}},b.uint8array={string:p,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return f.buffer},uint8array:d,nodebuffer:function(f){return o.newBufferFrom(f)}},b.nodebuffer={string:p,array:function(f){return u(f,new Array(f.length))},arraybuffer:function(f){return b.nodebuffer.uint8array(f).buffer},uint8array:function(f){return u(f,new Uint8Array(f.length))},nodebuffer:d},i.transformTo=function(f,v){if(v=v||"",!f)return v;i.checkSupport(f);var y=i.getTypeOf(v);return b[y][f](v)},i.resolve=function(f){for(var v=f.split("/"),y=[],w=0;w<v.length;w++){var _=v[w];_==="."||_===""&&w!==0&&w!==v.length-1||(_===".."?y.pop():y.push(_))}return y.join("/")},i.getTypeOf=function(f){return typeof f=="string"?"string":Object.prototype.toString.call(f)==="[object Array]"?"array":a.nodebuffer&&o.isBuffer(f)?"nodebuffer":a.uint8array&&f instanceof Uint8Array?"uint8array":a.arraybuffer&&f instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(f){if(!a[f.toLowerCase()])throw new Error(f+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(f){var v,y,w="";for(y=0;y<(f||"").length;y++)w+="\\x"+((v=f.charCodeAt(y))<16?"0":"")+v.toString(16).toUpperCase();return w},i.delay=function(f,v,y){setImmediate(function(){f.apply(y||null,v||[])})},i.inherits=function(f,v){function y(){}y.prototype=v.prototype,f.prototype=new y},i.extend=function(){var f,v,y={};for(f=0;f<arguments.length;f++)for(v in arguments[f])Object.prototype.hasOwnProperty.call(arguments[f],v)&&y[v]===void 0&&(y[v]=arguments[f][v]);return y},i.prepareContent=function(f,v,y,w,_){return l.Promise.resolve(v).then(function(k){return a.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(x,I){var O=new FileReader;O.onload=function(R){x(R.target.result)},O.onerror=function(R){I(R.target.error)},O.readAsArrayBuffer(k)}):k}).then(function(k){var x=i.getTypeOf(k);return x?(x==="arraybuffer"?k=i.transformTo("uint8array",k):x==="string"&&(_?k=s.decode(k):y&&w!==!0&&(k=function(I){return c(I,a.uint8array?new Uint8Array(I.length):new Array(I.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+f+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var a=r("./reader/readerFor"),s=r("./utils"),o=r("./signature"),l=r("./zipEntry"),d=r("./support");function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(p)+", expected "+s.pretty(h)+")")}},isSignature:function(h,p){var u=this.reader.index;this.reader.setIndex(h);var b=this.reader.readString(4)===p;return this.reader.setIndex(u),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),p=d.uint8array?"uint8array":"array",u=s.transformTo(p,h);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,p,u,b=this.zip64EndOfCentralSize-44;0<b;)h=this.reader.readInt(2),p=this.reader.readInt(4),u=this.reader.readData(p),this.zip64ExtensibleData[h]={id:h,length:p,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,p;for(h=0;h<this.files.length;h++)p=this.files[h],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var p=h;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var b=p-u;if(0<b)this.isSignature(p,o.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(h){this.reader=a(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var a=r("./reader/readerFor"),s=r("./utils"),o=r("./compressedObject"),l=r("./crc32"),d=r("./utf8"),c=r("./compressions"),h=r("./support");function p(u,b){this.options=u,this.loadOptions=b}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var b,f;if(u.skip(22),this.fileNameLength=u.readInt(2),f=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(f),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(v){for(var y in c)if(Object.prototype.hasOwnProperty.call(c,y)&&c[y].magic===v)return c[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,b,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var b=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(b),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=a(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var b,f,v,y=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<y;)b=u.readInt(2),f=u.readInt(2),v=u.readData(f),this.extraFields[b]={id:b,length:f,value:v};u.setIndex(y)},handleUTF8:function(){var u=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var f=s.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(f)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var y=s.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var b=a(u.value);return b.readInt(1)!==1||l(this.fileName)!==b.readInt(4)?null:d.utf8decode(b.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var b=a(u.value);return b.readInt(1)!==1||l(this.fileComment)!==b.readInt(4)?null:d.utf8decode(b.readData(u.length-5))}return null}},n.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function a(b,f,v){this.name=b,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=f,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var s=r("./stream/StreamHelper"),o=r("./stream/DataWorker"),l=r("./utf8"),d=r("./compressedObject"),c=r("./stream/GenericWorker");a.prototype={internalStream:function(b){var f=null,v="string";try{if(!b)throw new Error("No output type specified.");var y=(v=b.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),f=this._decompressWorker();var w=!this._dataBinary;w&&!y&&(f=f.pipe(new l.Utf8EncodeWorker)),!w&&y&&(f=f.pipe(new l.Utf8DecodeWorker))}catch(_){(f=new c("error")).error(_)}return new s(f,v,"")},async:function(b,f){return this.internalStream(b).accumulate(f)},nodeStream:function(b,f){return this.internalStream(b||"nodebuffer").toNodejsStream(f)},_compressWorker:function(b,f){if(this._data instanceof d&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),d.createWorkerFrom(v,b,f)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof c?this._data:new o(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<h.length;u++)a.prototype[h[u]]=p;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(a){var s,o,l=a.MutationObserver||a.WebKitMutationObserver;if(l){var d=0,c=new l(b),h=a.document.createTextNode("");c.observe(h,{characterData:!0}),s=function(){h.data=d=++d%2}}else if(a.setImmediate||a.MessageChannel===void 0)s="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var f=a.document.createElement("script");f.onreadystatechange=function(){b(),f.onreadystatechange=null,f.parentNode.removeChild(f),f=null},a.document.documentElement.appendChild(f)}:function(){setTimeout(b,0)};else{var p=new a.MessageChannel;p.port1.onmessage=b,s=function(){p.port2.postMessage(0)}}var u=[];function b(){var f,v;o=!0;for(var y=u.length;y;){for(v=u,u=[],f=-1;++f<y;)v[f]();y=u.length}o=!1}n.exports=function(f){u.push(f)!==1||o||s()}}).call(this,typeof Er<"u"?Er:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var a=r("immediate");function s(){}var o={},l=["REJECTED"],d=["FULFILLED"],c=["PENDING"];function h(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,y!==s&&f(this,y)}function p(y,w,_){this.promise=y,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function u(y,w,_){a(function(){var k;try{k=w(_)}catch(x){return o.reject(y,x)}k===y?o.reject(y,new TypeError("Cannot resolve promise with itself")):o.resolve(y,k)})}function b(y){var w=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof w=="function")return function(){w.apply(y,arguments)}}function f(y,w){var _=!1;function k(O){_||(_=!0,o.reject(y,O))}function x(O){_||(_=!0,o.resolve(y,O))}var I=v(function(){w(x,k)});I.status==="error"&&k(I.value)}function v(y,w){var _={};try{_.value=y(w),_.status="success"}catch(k){_.status="error",_.value=k}return _}(n.exports=h).prototype.finally=function(y){if(typeof y!="function")return this;var w=this.constructor;return this.then(function(_){return w.resolve(y()).then(function(){return _})},function(_){return w.resolve(y()).then(function(){throw _})})},h.prototype.catch=function(y){return this.then(null,y)},h.prototype.then=function(y,w){if(typeof y!="function"&&this.state===d||typeof w!="function"&&this.state===l)return this;var _=new this.constructor(s);return this.state!==c?u(_,this.state===d?y:w,this.outcome):this.queue.push(new p(_,y,w)),_},p.prototype.callFulfilled=function(y){o.resolve(this.promise,y)},p.prototype.otherCallFulfilled=function(y){u(this.promise,this.onFulfilled,y)},p.prototype.callRejected=function(y){o.reject(this.promise,y)},p.prototype.otherCallRejected=function(y){u(this.promise,this.onRejected,y)},o.resolve=function(y,w){var _=v(b,w);if(_.status==="error")return o.reject(y,_.value);var k=_.value;if(k)f(y,k);else{y.state=d,y.outcome=w;for(var x=-1,I=y.queue.length;++x<I;)y.queue[x].callFulfilled(w)}return y},o.reject=function(y,w){y.state=l,y.outcome=w;for(var _=-1,k=y.queue.length;++_<k;)y.queue[_].callRejected(w);return y},h.resolve=function(y){return y instanceof this?y:o.resolve(new this(s),y)},h.reject=function(y){var w=new this(s);return o.reject(w,y)},h.all=function(y){var w=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,k=!1;if(!_)return this.resolve([]);for(var x=new Array(_),I=0,O=-1,R=new this(s);++O<_;)D(y[O],O);return R;function D(j,M){w.resolve(j).then(function(C){x[M]=C,++I!==_||k||(k=!0,o.resolve(R,x))},function(C){k||(k=!0,o.reject(R,C))})}},h.race=function(y){var w=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=y.length,k=!1;if(!_)return this.resolve([]);for(var x=-1,I=new this(s);++x<_;)O=y[x],w.resolve(O).then(function(R){k||(k=!0,o.resolve(I,R))},function(R){k||(k=!0,o.reject(I,R))});var O;return I}},{immediate:36}],38:[function(r,n,i){var a={};(0,r("./lib/utils/common").assign)(a,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var a=r("./zlib/deflate"),s=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/messages"),d=r("./zlib/zstream"),c=Object.prototype.toString,h=0,p=-1,u=0,b=8;function f(y){if(!(this instanceof f))return new f(y);this.options=s.assign({level:p,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},y||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var _=a.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(_!==h)throw new Error(l[_]);if(w.header&&a.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):c.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(_=a.deflateSetDictionary(this.strm,k))!==h)throw new Error(l[_]);this._dict_set=!0}}function v(y,w){var _=new f(w);if(_.push(y,!0),_.err)throw _.msg||l[_.err];return _.result}f.prototype.push=function(y,w){var _,k,x=this.strm,I=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof y=="string"?x.input=o.string2buf(y):c.call(y)==="[object ArrayBuffer]"?x.input=new Uint8Array(y):x.input=y,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new s.Buf8(I),x.next_out=0,x.avail_out=I),(_=a.deflate(x,k))!==1&&_!==h)return this.onEnd(_),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(s.shrinkBuf(x.output,x.next_out))):this.onData(s.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&_!==1);return k===4?(_=a.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===h):k!==2||(this.onEnd(h),!(x.avail_out=0))},f.prototype.onData=function(y){this.chunks.push(y)},f.prototype.onEnd=function(y){y===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},i.Deflate=f,i.deflate=v,i.deflateRaw=function(y,w){return(w=w||{}).raw=!0,v(y,w)},i.gzip=function(y,w){return(w=w||{}).gzip=!0,v(y,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var a=r("./zlib/inflate"),s=r("./utils/common"),o=r("./utils/strings"),l=r("./zlib/constants"),d=r("./zlib/messages"),c=r("./zlib/zstream"),h=r("./zlib/gzheader"),p=Object.prototype.toString;function u(f){if(!(this instanceof u))return new u(f);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},f||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||f&&f.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var y=a.inflateInit2(this.strm,v.windowBits);if(y!==l.Z_OK)throw new Error(d[y]);this.header=new h,a.inflateGetHeader(this.strm,this.header)}function b(f,v){var y=new u(v);if(y.push(f,!0),y.err)throw y.msg||d[y.err];return y.result}u.prototype.push=function(f,v){var y,w,_,k,x,I,O=this.strm,R=this.options.chunkSize,D=this.options.dictionary,j=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof f=="string"?O.input=o.binstring2buf(f):p.call(f)==="[object ArrayBuffer]"?O.input=new Uint8Array(f):O.input=f,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new s.Buf8(R),O.next_out=0,O.avail_out=R),(y=a.inflate(O,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&D&&(I=typeof D=="string"?o.string2buf(D):p.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,y=a.inflateSetDictionary(this.strm,I)),y===l.Z_BUF_ERROR&&j===!0&&(y=l.Z_OK,j=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&y!==l.Z_STREAM_END&&(O.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=o.utf8border(O.output,O.next_out),k=O.next_out-_,x=o.buf2string(O.output,_),O.next_out=k,O.avail_out=R-k,k&&s.arraySet(O.output,O.output,_,k,0),this.onData(x)):this.onData(s.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(j=!0)}while((0<O.avail_in||O.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(y=a.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(O.avail_out=0))},u.prototype.onData=function(f){this.chunks.push(f)},u.prototype.onEnd=function(f){f===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg},i.Inflate=u,i.inflate=b,i.inflateRaw=function(f,v){return(v=v||{}).raw=!0,b(f,v)},i.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var c=d.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(l[h]=c[h])}}return l},i.shrinkBuf=function(l,d){return l.length===d?l:l.subarray?l.subarray(0,d):(l.length=d,l)};var s={arraySet:function(l,d,c,h,p){if(d.subarray&&l.subarray)l.set(d.subarray(c,c+h),p);else for(var u=0;u<h;u++)l[p+u]=d[c+u]},flattenChunks:function(l){var d,c,h,p,u,b;for(d=h=0,c=l.length;d<c;d++)h+=l[d].length;for(b=new Uint8Array(h),d=p=0,c=l.length;d<c;d++)u=l[d],b.set(u,p),p+=u.length;return b}},o={arraySet:function(l,d,c,h,p){for(var u=0;u<h;u++)l[p+u]=d[c+u]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(a)},{}],42:[function(r,n,i){var a=r("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new a.Buf8(256),d=0;d<256;d++)l[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function c(h,p){if(p<65537&&(h.subarray&&o||!h.subarray&&s))return String.fromCharCode.apply(null,a.shrinkBuf(h,p));for(var u="",b=0;b<p;b++)u+=String.fromCharCode(h[b]);return u}l[254]=l[254]=1,i.string2buf=function(h){var p,u,b,f,v,y=h.length,w=0;for(f=0;f<y;f++)(64512&(u=h.charCodeAt(f)))==55296&&f+1<y&&(64512&(b=h.charCodeAt(f+1)))==56320&&(u=65536+(u-55296<<10)+(b-56320),f++),w+=u<128?1:u<2048?2:u<65536?3:4;for(p=new a.Buf8(w),f=v=0;v<w;f++)(64512&(u=h.charCodeAt(f)))==55296&&f+1<y&&(64512&(b=h.charCodeAt(f+1)))==56320&&(u=65536+(u-55296<<10)+(b-56320),f++),u<128?p[v++]=u:(u<2048?p[v++]=192|u>>>6:(u<65536?p[v++]=224|u>>>12:(p[v++]=240|u>>>18,p[v++]=128|u>>>12&63),p[v++]=128|u>>>6&63),p[v++]=128|63&u);return p},i.buf2binstring=function(h){return c(h,h.length)},i.binstring2buf=function(h){for(var p=new a.Buf8(h.length),u=0,b=p.length;u<b;u++)p[u]=h.charCodeAt(u);return p},i.buf2string=function(h,p){var u,b,f,v,y=p||h.length,w=new Array(2*y);for(u=b=0;u<y;)if((f=h[u++])<128)w[b++]=f;else if(4<(v=l[f]))w[b++]=65533,u+=v-1;else{for(f&=v===2?31:v===3?15:7;1<v&&u<y;)f=f<<6|63&h[u++],v--;1<v?w[b++]=65533:f<65536?w[b++]=f:(f-=65536,w[b++]=55296|f>>10&1023,w[b++]=56320|1023&f)}return c(w,b)},i.utf8border=function(h,p){var u;for((p=p||h.length)>h.length&&(p=h.length),u=p-1;0<=u&&(192&h[u])==128;)u--;return u<0||u===0?p:u+l[h[u]]>p?u:p}},{"./common":41}],43:[function(r,n,i){n.exports=function(a,s,o,l){for(var d=65535&a|0,c=a>>>16&65535|0,h=0;o!==0;){for(o-=h=2e3<o?2e3:o;c=c+(d=d+s[l++]|0)|0,--h;);d%=65521,c%=65521}return d|c<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var a=function(){for(var s,o=[],l=0;l<256;l++){s=l;for(var d=0;d<8;d++)s=1&s?3988292384^s>>>1:s>>>1;o[l]=s}return o}();n.exports=function(s,o,l,d){var c=a,h=d+l;s^=-1;for(var p=d;p<h;p++)s=s>>>8^c[255&(s^o[p])];return-1^s}},{}],46:[function(r,n,i){var a,s=r("../utils/common"),o=r("./trees"),l=r("./adler32"),d=r("./crc32"),c=r("./messages"),h=0,p=4,u=0,b=-2,f=-1,v=4,y=2,w=8,_=9,k=286,x=30,I=19,O=2*k+1,R=15,D=3,j=258,M=j+D+1,C=42,B=113,g=1,L=2,tt=3,A=4;function Z(m,U){return m.msg=c[U],U}function z(m){return(m<<1)-(4<m?9:0)}function H(m){for(var U=m.length;0<=--U;)m[U]=0}function F(m){var U=m.state,W=U.pending;W>m.avail_out&&(W=m.avail_out),W!==0&&(s.arraySet(m.output,U.pending_buf,U.pending_out,W,m.next_out),m.next_out+=W,U.pending_out+=W,m.total_out+=W,m.avail_out-=W,U.pending-=W,U.pending===0&&(U.pending_out=0))}function N(m,U){o._tr_flush_block(m,0<=m.block_start?m.block_start:-1,m.strstart-m.block_start,U),m.block_start=m.strstart,F(m.strm)}function nt(m,U){m.pending_buf[m.pending++]=U}function J(m,U){m.pending_buf[m.pending++]=U>>>8&255,m.pending_buf[m.pending++]=255&U}function q(m,U){var W,S,E=m.max_chain_length,P=m.strstart,K=m.prev_length,$=m.nice_match,T=m.strstart>m.w_size-M?m.strstart-(m.w_size-M):0,V=m.window,et=m.w_mask,Y=m.prev,it=m.strstart+j,pt=V[P+K-1],ut=V[P+K];m.prev_length>=m.good_match&&(E>>=2),$>m.lookahead&&($=m.lookahead);do if(V[(W=U)+K]===ut&&V[W+K-1]===pt&&V[W]===V[P]&&V[++W]===V[P+1]){P+=2,W++;do;while(V[++P]===V[++W]&&V[++P]===V[++W]&&V[++P]===V[++W]&&V[++P]===V[++W]&&V[++P]===V[++W]&&V[++P]===V[++W]&&V[++P]===V[++W]&&V[++P]===V[++W]&&P<it);if(S=j-(it-P),P=it-j,K<S){if(m.match_start=U,$<=(K=S))break;pt=V[P+K-1],ut=V[P+K]}}while((U=Y[U&et])>T&&--E!=0);return K<=m.lookahead?K:m.lookahead}function ht(m){var U,W,S,E,P,K,$,T,V,et,Y=m.w_size;do{if(E=m.window_size-m.lookahead-m.strstart,m.strstart>=Y+(Y-M)){for(s.arraySet(m.window,m.window,Y,Y,0),m.match_start-=Y,m.strstart-=Y,m.block_start-=Y,U=W=m.hash_size;S=m.head[--U],m.head[U]=Y<=S?S-Y:0,--W;);for(U=W=Y;S=m.prev[--U],m.prev[U]=Y<=S?S-Y:0,--W;);E+=Y}if(m.strm.avail_in===0)break;if(K=m.strm,$=m.window,T=m.strstart+m.lookahead,V=E,et=void 0,et=K.avail_in,V<et&&(et=V),W=et===0?0:(K.avail_in-=et,s.arraySet($,K.input,K.next_in,et,T),K.state.wrap===1?K.adler=l(K.adler,$,et,T):K.state.wrap===2&&(K.adler=d(K.adler,$,et,T)),K.next_in+=et,K.total_in+=et,et),m.lookahead+=W,m.lookahead+m.insert>=D)for(P=m.strstart-m.insert,m.ins_h=m.window[P],m.ins_h=(m.ins_h<<m.hash_shift^m.window[P+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[P+D-1])&m.hash_mask,m.prev[P&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=P,P++,m.insert--,!(m.lookahead+m.insert<D)););}while(m.lookahead<M&&m.strm.avail_in!==0)}function vt(m,U){for(var W,S;;){if(m.lookahead<M){if(ht(m),m.lookahead<M&&U===h)return g;if(m.lookahead===0)break}if(W=0,m.lookahead>=D&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+D-1])&m.hash_mask,W=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),W!==0&&m.strstart-W<=m.w_size-M&&(m.match_length=q(m,W)),m.match_length>=D)if(S=o._tr_tally(m,m.strstart-m.match_start,m.match_length-D),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=D){for(m.match_length--;m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+D-1])&m.hash_mask,W=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart,--m.match_length!=0;);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else S=o._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(S&&(N(m,!1),m.strm.avail_out===0))return g}return m.insert=m.strstart<D-1?m.strstart:D-1,U===p?(N(m,!0),m.strm.avail_out===0?tt:A):m.last_lit&&(N(m,!1),m.strm.avail_out===0)?g:L}function st(m,U){for(var W,S,E;;){if(m.lookahead<M){if(ht(m),m.lookahead<M&&U===h)return g;if(m.lookahead===0)break}if(W=0,m.lookahead>=D&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+D-1])&m.hash_mask,W=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=D-1,W!==0&&m.prev_length<m.max_lazy_match&&m.strstart-W<=m.w_size-M&&(m.match_length=q(m,W),m.match_length<=5&&(m.strategy===1||m.match_length===D&&4096<m.strstart-m.match_start)&&(m.match_length=D-1)),m.prev_length>=D&&m.match_length<=m.prev_length){for(E=m.strstart+m.lookahead-D,S=o._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-D),m.lookahead-=m.prev_length-1,m.prev_length-=2;++m.strstart<=E&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+D-1])&m.hash_mask,W=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),--m.prev_length!=0;);if(m.match_available=0,m.match_length=D-1,m.strstart++,S&&(N(m,!1),m.strm.avail_out===0))return g}else if(m.match_available){if((S=o._tr_tally(m,0,m.window[m.strstart-1]))&&N(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return g}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(S=o._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<D-1?m.strstart:D-1,U===p?(N(m,!0),m.strm.avail_out===0?tt:A):m.last_lit&&(N(m,!1),m.strm.avail_out===0)?g:L}function dt(m,U,W,S,E){this.good_length=m,this.max_lazy=U,this.nice_length=W,this.max_chain=S,this.func=E}function _t(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*O),this.dyn_dtree=new s.Buf16(2*(2*x+1)),this.bl_tree=new s.Buf16(2*(2*I+1)),H(this.dyn_ltree),H(this.dyn_dtree),H(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(R+1),this.heap=new s.Buf16(2*k+1),H(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*k+1),H(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function mt(m){var U;return m&&m.state?(m.total_in=m.total_out=0,m.data_type=y,(U=m.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?C:B,m.adler=U.wrap===2?0:1,U.last_flush=h,o._tr_init(U),u):Z(m,b)}function ft(m){var U=mt(m);return U===u&&function(W){W.window_size=2*W.w_size,H(W.head),W.max_lazy_match=a[W.level].max_lazy,W.good_match=a[W.level].good_length,W.nice_match=a[W.level].nice_length,W.max_chain_length=a[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=D-1,W.match_available=0,W.ins_h=0}(m.state),U}function bt(m,U,W,S,E,P){if(!m)return b;var K=1;if(U===f&&(U=6),S<0?(K=0,S=-S):15<S&&(K=2,S-=16),E<1||_<E||W!==w||S<8||15<S||U<0||9<U||P<0||v<P)return Z(m,b);S===8&&(S=9);var $=new _t;return(m.state=$).strm=m,$.wrap=K,$.gzhead=null,$.w_bits=S,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=E+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+D-1)/D),$.window=new s.Buf8(2*$.w_size),$.head=new s.Buf16($.hash_size),$.prev=new s.Buf16($.w_size),$.lit_bufsize=1<<E+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new s.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=U,$.strategy=P,$.method=W,ft(m)}a=[new dt(0,0,0,0,function(m,U){var W=65535;for(W>m.pending_buf_size-5&&(W=m.pending_buf_size-5);;){if(m.lookahead<=1){if(ht(m),m.lookahead===0&&U===h)return g;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var S=m.block_start+W;if((m.strstart===0||m.strstart>=S)&&(m.lookahead=m.strstart-S,m.strstart=S,N(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-M&&(N(m,!1),m.strm.avail_out===0))return g}return m.insert=0,U===p?(N(m,!0),m.strm.avail_out===0?tt:A):(m.strstart>m.block_start&&(N(m,!1),m.strm.avail_out),g)}),new dt(4,4,8,4,vt),new dt(4,5,16,8,vt),new dt(4,6,32,32,vt),new dt(4,4,16,16,st),new dt(8,16,32,32,st),new dt(8,16,128,128,st),new dt(8,32,128,256,st),new dt(32,128,258,1024,st),new dt(32,258,258,4096,st)],i.deflateInit=function(m,U){return bt(m,U,w,15,8,0)},i.deflateInit2=bt,i.deflateReset=ft,i.deflateResetKeep=mt,i.deflateSetHeader=function(m,U){return m&&m.state?m.state.wrap!==2?b:(m.state.gzhead=U,u):b},i.deflate=function(m,U){var W,S,E,P;if(!m||!m.state||5<U||U<0)return m?Z(m,b):b;if(S=m.state,!m.output||!m.input&&m.avail_in!==0||S.status===666&&U!==p)return Z(m,m.avail_out===0?-5:b);if(S.strm=m,W=S.last_flush,S.last_flush=U,S.status===C)if(S.wrap===2)m.adler=0,nt(S,31),nt(S,139),nt(S,8),S.gzhead?(nt(S,(S.gzhead.text?1:0)+(S.gzhead.hcrc?2:0)+(S.gzhead.extra?4:0)+(S.gzhead.name?8:0)+(S.gzhead.comment?16:0)),nt(S,255&S.gzhead.time),nt(S,S.gzhead.time>>8&255),nt(S,S.gzhead.time>>16&255),nt(S,S.gzhead.time>>24&255),nt(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),nt(S,255&S.gzhead.os),S.gzhead.extra&&S.gzhead.extra.length&&(nt(S,255&S.gzhead.extra.length),nt(S,S.gzhead.extra.length>>8&255)),S.gzhead.hcrc&&(m.adler=d(m.adler,S.pending_buf,S.pending,0)),S.gzindex=0,S.status=69):(nt(S,0),nt(S,0),nt(S,0),nt(S,0),nt(S,0),nt(S,S.level===9?2:2<=S.strategy||S.level<2?4:0),nt(S,3),S.status=B);else{var K=w+(S.w_bits-8<<4)<<8;K|=(2<=S.strategy||S.level<2?0:S.level<6?1:S.level===6?2:3)<<6,S.strstart!==0&&(K|=32),K+=31-K%31,S.status=B,J(S,K),S.strstart!==0&&(J(S,m.adler>>>16),J(S,65535&m.adler)),m.adler=1}if(S.status===69)if(S.gzhead.extra){for(E=S.pending;S.gzindex<(65535&S.gzhead.extra.length)&&(S.pending!==S.pending_buf_size||(S.gzhead.hcrc&&S.pending>E&&(m.adler=d(m.adler,S.pending_buf,S.pending-E,E)),F(m),E=S.pending,S.pending!==S.pending_buf_size));)nt(S,255&S.gzhead.extra[S.gzindex]),S.gzindex++;S.gzhead.hcrc&&S.pending>E&&(m.adler=d(m.adler,S.pending_buf,S.pending-E,E)),S.gzindex===S.gzhead.extra.length&&(S.gzindex=0,S.status=73)}else S.status=73;if(S.status===73)if(S.gzhead.name){E=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>E&&(m.adler=d(m.adler,S.pending_buf,S.pending-E,E)),F(m),E=S.pending,S.pending===S.pending_buf_size)){P=1;break}P=S.gzindex<S.gzhead.name.length?255&S.gzhead.name.charCodeAt(S.gzindex++):0,nt(S,P)}while(P!==0);S.gzhead.hcrc&&S.pending>E&&(m.adler=d(m.adler,S.pending_buf,S.pending-E,E)),P===0&&(S.gzindex=0,S.status=91)}else S.status=91;if(S.status===91)if(S.gzhead.comment){E=S.pending;do{if(S.pending===S.pending_buf_size&&(S.gzhead.hcrc&&S.pending>E&&(m.adler=d(m.adler,S.pending_buf,S.pending-E,E)),F(m),E=S.pending,S.pending===S.pending_buf_size)){P=1;break}P=S.gzindex<S.gzhead.comment.length?255&S.gzhead.comment.charCodeAt(S.gzindex++):0,nt(S,P)}while(P!==0);S.gzhead.hcrc&&S.pending>E&&(m.adler=d(m.adler,S.pending_buf,S.pending-E,E)),P===0&&(S.status=103)}else S.status=103;if(S.status===103&&(S.gzhead.hcrc?(S.pending+2>S.pending_buf_size&&F(m),S.pending+2<=S.pending_buf_size&&(nt(S,255&m.adler),nt(S,m.adler>>8&255),m.adler=0,S.status=B)):S.status=B),S.pending!==0){if(F(m),m.avail_out===0)return S.last_flush=-1,u}else if(m.avail_in===0&&z(U)<=z(W)&&U!==p)return Z(m,-5);if(S.status===666&&m.avail_in!==0)return Z(m,-5);if(m.avail_in!==0||S.lookahead!==0||U!==h&&S.status!==666){var $=S.strategy===2?function(T,V){for(var et;;){if(T.lookahead===0&&(ht(T),T.lookahead===0)){if(V===h)return g;break}if(T.match_length=0,et=o._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++,et&&(N(T,!1),T.strm.avail_out===0))return g}return T.insert=0,V===p?(N(T,!0),T.strm.avail_out===0?tt:A):T.last_lit&&(N(T,!1),T.strm.avail_out===0)?g:L}(S,U):S.strategy===3?function(T,V){for(var et,Y,it,pt,ut=T.window;;){if(T.lookahead<=j){if(ht(T),T.lookahead<=j&&V===h)return g;if(T.lookahead===0)break}if(T.match_length=0,T.lookahead>=D&&0<T.strstart&&(Y=ut[it=T.strstart-1])===ut[++it]&&Y===ut[++it]&&Y===ut[++it]){pt=T.strstart+j;do;while(Y===ut[++it]&&Y===ut[++it]&&Y===ut[++it]&&Y===ut[++it]&&Y===ut[++it]&&Y===ut[++it]&&Y===ut[++it]&&Y===ut[++it]&&it<pt);T.match_length=j-(pt-it),T.match_length>T.lookahead&&(T.match_length=T.lookahead)}if(T.match_length>=D?(et=o._tr_tally(T,1,T.match_length-D),T.lookahead-=T.match_length,T.strstart+=T.match_length,T.match_length=0):(et=o._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++),et&&(N(T,!1),T.strm.avail_out===0))return g}return T.insert=0,V===p?(N(T,!0),T.strm.avail_out===0?tt:A):T.last_lit&&(N(T,!1),T.strm.avail_out===0)?g:L}(S,U):a[S.level].func(S,U);if($!==tt&&$!==A||(S.status=666),$===g||$===tt)return m.avail_out===0&&(S.last_flush=-1),u;if($===L&&(U===1?o._tr_align(S):U!==5&&(o._tr_stored_block(S,0,0,!1),U===3&&(H(S.head),S.lookahead===0&&(S.strstart=0,S.block_start=0,S.insert=0))),F(m),m.avail_out===0))return S.last_flush=-1,u}return U!==p?u:S.wrap<=0?1:(S.wrap===2?(nt(S,255&m.adler),nt(S,m.adler>>8&255),nt(S,m.adler>>16&255),nt(S,m.adler>>24&255),nt(S,255&m.total_in),nt(S,m.total_in>>8&255),nt(S,m.total_in>>16&255),nt(S,m.total_in>>24&255)):(J(S,m.adler>>>16),J(S,65535&m.adler)),F(m),0<S.wrap&&(S.wrap=-S.wrap),S.pending!==0?u:1)},i.deflateEnd=function(m){var U;return m&&m.state?(U=m.state.status)!==C&&U!==69&&U!==73&&U!==91&&U!==103&&U!==B&&U!==666?Z(m,b):(m.state=null,U===B?Z(m,-3):u):b},i.deflateSetDictionary=function(m,U){var W,S,E,P,K,$,T,V,et=U.length;if(!m||!m.state||(P=(W=m.state).wrap)===2||P===1&&W.status!==C||W.lookahead)return b;for(P===1&&(m.adler=l(m.adler,U,et,0)),W.wrap=0,et>=W.w_size&&(P===0&&(H(W.head),W.strstart=0,W.block_start=0,W.insert=0),V=new s.Buf8(W.w_size),s.arraySet(V,U,et-W.w_size,W.w_size,0),U=V,et=W.w_size),K=m.avail_in,$=m.next_in,T=m.input,m.avail_in=et,m.next_in=0,m.input=U,ht(W);W.lookahead>=D;){for(S=W.strstart,E=W.lookahead-(D-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[S+D-1])&W.hash_mask,W.prev[S&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=S,S++,--E;);W.strstart=S,W.lookahead=D-1,ht(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=D-1,W.match_available=0,m.next_in=$,m.input=T,m.avail_in=K,W.wrap=P,u},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(a,s){var o,l,d,c,h,p,u,b,f,v,y,w,_,k,x,I,O,R,D,j,M,C,B,g,L;o=a.state,l=a.next_in,g=a.input,d=l+(a.avail_in-5),c=a.next_out,L=a.output,h=c-(s-a.avail_out),p=c+(a.avail_out-257),u=o.dmax,b=o.wsize,f=o.whave,v=o.wnext,y=o.window,w=o.hold,_=o.bits,k=o.lencode,x=o.distcode,I=(1<<o.lenbits)-1,O=(1<<o.distbits)-1;t:do{_<15&&(w+=g[l++]<<_,_+=8,w+=g[l++]<<_,_+=8),R=k[w&I];e:for(;;){if(w>>>=D=R>>>24,_-=D,(D=R>>>16&255)===0)L[c++]=65535&R;else{if(!(16&D)){if(!(64&D)){R=k[(65535&R)+(w&(1<<D)-1)];continue e}if(32&D){o.mode=12;break t}a.msg="invalid literal/length code",o.mode=30;break t}j=65535&R,(D&=15)&&(_<D&&(w+=g[l++]<<_,_+=8),j+=w&(1<<D)-1,w>>>=D,_-=D),_<15&&(w+=g[l++]<<_,_+=8,w+=g[l++]<<_,_+=8),R=x[w&O];r:for(;;){if(w>>>=D=R>>>24,_-=D,!(16&(D=R>>>16&255))){if(!(64&D)){R=x[(65535&R)+(w&(1<<D)-1)];continue r}a.msg="invalid distance code",o.mode=30;break t}if(M=65535&R,_<(D&=15)&&(w+=g[l++]<<_,(_+=8)<D&&(w+=g[l++]<<_,_+=8)),u<(M+=w&(1<<D)-1)){a.msg="invalid distance too far back",o.mode=30;break t}if(w>>>=D,_-=D,(D=c-h)<M){if(f<(D=M-D)&&o.sane){a.msg="invalid distance too far back",o.mode=30;break t}if(B=y,(C=0)===v){if(C+=b-D,D<j){for(j-=D;L[c++]=y[C++],--D;);C=c-M,B=L}}else if(v<D){if(C+=b+v-D,(D-=v)<j){for(j-=D;L[c++]=y[C++],--D;);if(C=0,v<j){for(j-=D=v;L[c++]=y[C++],--D;);C=c-M,B=L}}}else if(C+=v-D,D<j){for(j-=D;L[c++]=y[C++],--D;);C=c-M,B=L}for(;2<j;)L[c++]=B[C++],L[c++]=B[C++],L[c++]=B[C++],j-=3;j&&(L[c++]=B[C++],1<j&&(L[c++]=B[C++]))}else{for(C=c-M;L[c++]=L[C++],L[c++]=L[C++],L[c++]=L[C++],2<(j-=3););j&&(L[c++]=L[C++],1<j&&(L[c++]=L[C++]))}break}}break}}while(l<d&&c<p);l-=j=_>>3,w&=(1<<(_-=j<<3))-1,a.next_in=l,a.next_out=c,a.avail_in=l<d?d-l+5:5-(l-d),a.avail_out=c<p?p-c+257:257-(c-p),o.hold=w,o.bits=_}},{}],49:[function(r,n,i){var a=r("../utils/common"),s=r("./adler32"),o=r("./crc32"),l=r("./inffast"),d=r("./inftrees"),c=1,h=2,p=0,u=-2,b=1,f=852,v=592;function y(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(C){var B;return C&&C.state?(B=C.state,C.total_in=C.total_out=B.total=0,C.msg="",B.wrap&&(C.adler=1&B.wrap),B.mode=b,B.last=0,B.havedict=0,B.dmax=32768,B.head=null,B.hold=0,B.bits=0,B.lencode=B.lendyn=new a.Buf32(f),B.distcode=B.distdyn=new a.Buf32(v),B.sane=1,B.back=-1,p):u}function k(C){var B;return C&&C.state?((B=C.state).wsize=0,B.whave=0,B.wnext=0,_(C)):u}function x(C,B){var g,L;return C&&C.state?(L=C.state,B<0?(g=0,B=-B):(g=1+(B>>4),B<48&&(B&=15)),B&&(B<8||15<B)?u:(L.window!==null&&L.wbits!==B&&(L.window=null),L.wrap=g,L.wbits=B,k(C))):u}function I(C,B){var g,L;return C?(L=new w,(C.state=L).window=null,(g=x(C,B))!==p&&(C.state=null),g):u}var O,R,D=!0;function j(C){if(D){var B;for(O=new a.Buf32(512),R=new a.Buf32(32),B=0;B<144;)C.lens[B++]=8;for(;B<256;)C.lens[B++]=9;for(;B<280;)C.lens[B++]=7;for(;B<288;)C.lens[B++]=8;for(d(c,C.lens,0,288,O,0,C.work,{bits:9}),B=0;B<32;)C.lens[B++]=5;d(h,C.lens,0,32,R,0,C.work,{bits:5}),D=!1}C.lencode=O,C.lenbits=9,C.distcode=R,C.distbits=5}function M(C,B,g,L){var tt,A=C.state;return A.window===null&&(A.wsize=1<<A.wbits,A.wnext=0,A.whave=0,A.window=new a.Buf8(A.wsize)),L>=A.wsize?(a.arraySet(A.window,B,g-A.wsize,A.wsize,0),A.wnext=0,A.whave=A.wsize):(L<(tt=A.wsize-A.wnext)&&(tt=L),a.arraySet(A.window,B,g-L,tt,A.wnext),(L-=tt)?(a.arraySet(A.window,B,g-L,L,0),A.wnext=L,A.whave=A.wsize):(A.wnext+=tt,A.wnext===A.wsize&&(A.wnext=0),A.whave<A.wsize&&(A.whave+=tt))),0}i.inflateReset=k,i.inflateReset2=x,i.inflateResetKeep=_,i.inflateInit=function(C){return I(C,15)},i.inflateInit2=I,i.inflate=function(C,B){var g,L,tt,A,Z,z,H,F,N,nt,J,q,ht,vt,st,dt,_t,mt,ft,bt,m,U,W,S,E=0,P=new a.Buf8(4),K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return u;(g=C.state).mode===12&&(g.mode=13),Z=C.next_out,tt=C.output,H=C.avail_out,A=C.next_in,L=C.input,z=C.avail_in,F=g.hold,N=g.bits,nt=z,J=H,U=p;t:for(;;)switch(g.mode){case b:if(g.wrap===0){g.mode=13;break}for(;N<16;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(2&g.wrap&&F===35615){P[g.check=0]=255&F,P[1]=F>>>8&255,g.check=o(g.check,P,2,0),N=F=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&F)<<8)+(F>>8))%31){C.msg="incorrect header check",g.mode=30;break}if((15&F)!=8){C.msg="unknown compression method",g.mode=30;break}if(N-=4,m=8+(15&(F>>>=4)),g.wbits===0)g.wbits=m;else if(m>g.wbits){C.msg="invalid window size",g.mode=30;break}g.dmax=1<<m,C.adler=g.check=1,g.mode=512&F?10:12,N=F=0;break;case 2:for(;N<16;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(g.flags=F,(255&g.flags)!=8){C.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){C.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=F>>8&1),512&g.flags&&(P[0]=255&F,P[1]=F>>>8&255,g.check=o(g.check,P,2,0)),N=F=0,g.mode=3;case 3:for(;N<32;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}g.head&&(g.head.time=F),512&g.flags&&(P[0]=255&F,P[1]=F>>>8&255,P[2]=F>>>16&255,P[3]=F>>>24&255,g.check=o(g.check,P,4,0)),N=F=0,g.mode=4;case 4:for(;N<16;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}g.head&&(g.head.xflags=255&F,g.head.os=F>>8),512&g.flags&&(P[0]=255&F,P[1]=F>>>8&255,g.check=o(g.check,P,2,0)),N=F=0,g.mode=5;case 5:if(1024&g.flags){for(;N<16;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}g.length=F,g.head&&(g.head.extra_len=F),512&g.flags&&(P[0]=255&F,P[1]=F>>>8&255,g.check=o(g.check,P,2,0)),N=F=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(z<(q=g.length)&&(q=z),q&&(g.head&&(m=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),a.arraySet(g.head.extra,L,A,q,m)),512&g.flags&&(g.check=o(g.check,L,q,A)),z-=q,A+=q,g.length-=q),g.length))break t;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(z===0)break t;for(q=0;m=L[A+q++],g.head&&m&&g.length<65536&&(g.head.name+=String.fromCharCode(m)),m&&q<z;);if(512&g.flags&&(g.check=o(g.check,L,q,A)),z-=q,A+=q,m)break t}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(z===0)break t;for(q=0;m=L[A+q++],g.head&&m&&g.length<65536&&(g.head.comment+=String.fromCharCode(m)),m&&q<z;);if(512&g.flags&&(g.check=o(g.check,L,q,A)),z-=q,A+=q,m)break t}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;N<16;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(F!==(65535&g.check)){C.msg="header crc mismatch",g.mode=30;break}N=F=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),C.adler=g.check=0,g.mode=12;break;case 10:for(;N<32;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}C.adler=g.check=y(F),N=F=0,g.mode=11;case 11:if(g.havedict===0)return C.next_out=Z,C.avail_out=H,C.next_in=A,C.avail_in=z,g.hold=F,g.bits=N,2;C.adler=g.check=1,g.mode=12;case 12:if(B===5||B===6)break t;case 13:if(g.last){F>>>=7&N,N-=7&N,g.mode=27;break}for(;N<3;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}switch(g.last=1&F,N-=1,3&(F>>>=1)){case 0:g.mode=14;break;case 1:if(j(g),g.mode=20,B!==6)break;F>>>=2,N-=2;break t;case 2:g.mode=17;break;case 3:C.msg="invalid block type",g.mode=30}F>>>=2,N-=2;break;case 14:for(F>>>=7&N,N-=7&N;N<32;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if((65535&F)!=(F>>>16^65535)){C.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&F,N=F=0,g.mode=15,B===6)break t;case 15:g.mode=16;case 16:if(q=g.length){if(z<q&&(q=z),H<q&&(q=H),q===0)break t;a.arraySet(tt,L,A,q,Z),z-=q,A+=q,H-=q,Z+=q,g.length-=q;break}g.mode=12;break;case 17:for(;N<14;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(g.nlen=257+(31&F),F>>>=5,N-=5,g.ndist=1+(31&F),F>>>=5,N-=5,g.ncode=4+(15&F),F>>>=4,N-=4,286<g.nlen||30<g.ndist){C.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;N<3;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}g.lens[K[g.have++]]=7&F,F>>>=3,N-=3}for(;g.have<19;)g.lens[K[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,W={bits:g.lenbits},U=d(0,g.lens,0,19,g.lencode,0,g.work,W),g.lenbits=W.bits,U){C.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;dt=(E=g.lencode[F&(1<<g.lenbits)-1])>>>16&255,_t=65535&E,!((st=E>>>24)<=N);){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(_t<16)F>>>=st,N-=st,g.lens[g.have++]=_t;else{if(_t===16){for(S=st+2;N<S;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(F>>>=st,N-=st,g.have===0){C.msg="invalid bit length repeat",g.mode=30;break}m=g.lens[g.have-1],q=3+(3&F),F>>>=2,N-=2}else if(_t===17){for(S=st+3;N<S;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}N-=st,m=0,q=3+(7&(F>>>=st)),F>>>=3,N-=3}else{for(S=st+7;N<S;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}N-=st,m=0,q=11+(127&(F>>>=st)),F>>>=7,N-=7}if(g.have+q>g.nlen+g.ndist){C.msg="invalid bit length repeat",g.mode=30;break}for(;q--;)g.lens[g.have++]=m}}if(g.mode===30)break;if(g.lens[256]===0){C.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,W={bits:g.lenbits},U=d(c,g.lens,0,g.nlen,g.lencode,0,g.work,W),g.lenbits=W.bits,U){C.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,W={bits:g.distbits},U=d(h,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,W),g.distbits=W.bits,U){C.msg="invalid distances set",g.mode=30;break}if(g.mode=20,B===6)break t;case 20:g.mode=21;case 21:if(6<=z&&258<=H){C.next_out=Z,C.avail_out=H,C.next_in=A,C.avail_in=z,g.hold=F,g.bits=N,l(C,J),Z=C.next_out,tt=C.output,H=C.avail_out,A=C.next_in,L=C.input,z=C.avail_in,F=g.hold,N=g.bits,g.mode===12&&(g.back=-1);break}for(g.back=0;dt=(E=g.lencode[F&(1<<g.lenbits)-1])>>>16&255,_t=65535&E,!((st=E>>>24)<=N);){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(dt&&!(240&dt)){for(mt=st,ft=dt,bt=_t;dt=(E=g.lencode[bt+((F&(1<<mt+ft)-1)>>mt)])>>>16&255,_t=65535&E,!(mt+(st=E>>>24)<=N);){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}F>>>=mt,N-=mt,g.back+=mt}if(F>>>=st,N-=st,g.back+=st,g.length=_t,dt===0){g.mode=26;break}if(32&dt){g.back=-1,g.mode=12;break}if(64&dt){C.msg="invalid literal/length code",g.mode=30;break}g.extra=15&dt,g.mode=22;case 22:if(g.extra){for(S=g.extra;N<S;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}g.length+=F&(1<<g.extra)-1,F>>>=g.extra,N-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;dt=(E=g.distcode[F&(1<<g.distbits)-1])>>>16&255,_t=65535&E,!((st=E>>>24)<=N);){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(!(240&dt)){for(mt=st,ft=dt,bt=_t;dt=(E=g.distcode[bt+((F&(1<<mt+ft)-1)>>mt)])>>>16&255,_t=65535&E,!(mt+(st=E>>>24)<=N);){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}F>>>=mt,N-=mt,g.back+=mt}if(F>>>=st,N-=st,g.back+=st,64&dt){C.msg="invalid distance code",g.mode=30;break}g.offset=_t,g.extra=15&dt,g.mode=24;case 24:if(g.extra){for(S=g.extra;N<S;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}g.offset+=F&(1<<g.extra)-1,F>>>=g.extra,N-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){C.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(H===0)break t;if(q=J-H,g.offset>q){if((q=g.offset-q)>g.whave&&g.sane){C.msg="invalid distance too far back",g.mode=30;break}ht=q>g.wnext?(q-=g.wnext,g.wsize-q):g.wnext-q,q>g.length&&(q=g.length),vt=g.window}else vt=tt,ht=Z-g.offset,q=g.length;for(H<q&&(q=H),H-=q,g.length-=q;tt[Z++]=vt[ht++],--q;);g.length===0&&(g.mode=21);break;case 26:if(H===0)break t;tt[Z++]=g.length,H--,g.mode=21;break;case 27:if(g.wrap){for(;N<32;){if(z===0)break t;z--,F|=L[A++]<<N,N+=8}if(J-=H,C.total_out+=J,g.total+=J,J&&(C.adler=g.check=g.flags?o(g.check,tt,J,Z-J):s(g.check,tt,J,Z-J)),J=H,(g.flags?F:y(F))!==g.check){C.msg="incorrect data check",g.mode=30;break}N=F=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;N<32;){if(z===0)break t;z--,F+=L[A++]<<N,N+=8}if(F!==(4294967295&g.total)){C.msg="incorrect length check",g.mode=30;break}N=F=0}g.mode=29;case 29:U=1;break t;case 30:U=-3;break t;case 31:return-4;case 32:default:return u}return C.next_out=Z,C.avail_out=H,C.next_in=A,C.avail_in=z,g.hold=F,g.bits=N,(g.wsize||J!==C.avail_out&&g.mode<30&&(g.mode<27||B!==4))&&M(C,C.output,C.next_out,J-C.avail_out)?(g.mode=31,-4):(nt-=C.avail_in,J-=C.avail_out,C.total_in+=nt,C.total_out+=J,g.total+=J,g.wrap&&J&&(C.adler=g.check=g.flags?o(g.check,tt,J,C.next_out-J):s(g.check,tt,J,C.next_out-J)),C.data_type=g.bits+(g.last?64:0)+(g.mode===12?128:0)+(g.mode===20||g.mode===15?256:0),(nt==0&&J===0||B===4)&&U===p&&(U=-5),U)},i.inflateEnd=function(C){if(!C||!C.state)return u;var B=C.state;return B.window&&(B.window=null),C.state=null,p},i.inflateGetHeader=function(C,B){var g;return C&&C.state&&2&(g=C.state).wrap?((g.head=B).done=!1,p):u},i.inflateSetDictionary=function(C,B){var g,L=B.length;return C&&C.state?(g=C.state).wrap!==0&&g.mode!==11?u:g.mode===11&&s(1,B,L,0)!==g.check?-3:M(C,B,L,L)?(g.mode=31,-4):(g.havedict=1,p):u},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var a=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,h,p,u,b,f,v,y){var w,_,k,x,I,O,R,D,j,M=y.bits,C=0,B=0,g=0,L=0,tt=0,A=0,Z=0,z=0,H=0,F=0,N=null,nt=0,J=new a.Buf16(16),q=new a.Buf16(16),ht=null,vt=0;for(C=0;C<=15;C++)J[C]=0;for(B=0;B<u;B++)J[h[p+B]]++;for(tt=M,L=15;1<=L&&J[L]===0;L--);if(L<tt&&(tt=L),L===0)return b[f++]=20971520,b[f++]=20971520,y.bits=1,0;for(g=1;g<L&&J[g]===0;g++);for(tt<g&&(tt=g),C=z=1;C<=15;C++)if(z<<=1,(z-=J[C])<0)return-1;if(0<z&&(c===0||L!==1))return-1;for(q[1]=0,C=1;C<15;C++)q[C+1]=q[C]+J[C];for(B=0;B<u;B++)h[p+B]!==0&&(v[q[h[p+B]]++]=B);if(O=c===0?(N=ht=v,19):c===1?(N=s,nt-=257,ht=o,vt-=257,256):(N=l,ht=d,-1),C=g,I=f,Z=B=F=0,k=-1,x=(H=1<<(A=tt))-1,c===1&&852<H||c===2&&592<H)return 1;for(;;){for(R=C-Z,j=v[B]<O?(D=0,v[B]):v[B]>O?(D=ht[vt+v[B]],N[nt+v[B]]):(D=96,0),w=1<<C-Z,g=_=1<<A;b[I+(F>>Z)+(_-=w)]=R<<24|D<<16|j|0,_!==0;);for(w=1<<C-1;F&w;)w>>=1;if(w!==0?(F&=w-1,F+=w):F=0,B++,--J[C]==0){if(C===L)break;C=h[p+v[B]]}if(tt<C&&(F&x)!==k){for(Z===0&&(Z=tt),I+=g,z=1<<(A=C-Z);A+Z<L&&!((z-=J[A+Z])<=0);)A++,z<<=1;if(H+=1<<A,c===1&&852<H||c===2&&592<H)return 1;b[k=F&x]=tt<<24|A<<16|I-f|0}}return F!==0&&(b[I+F]=C-Z<<24|64<<16|0),y.bits=tt,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var a=r("../utils/common"),s=0,o=1;function l(E){for(var P=E.length;0<=--P;)E[P]=0}var d=0,c=29,h=256,p=h+1+c,u=30,b=19,f=2*p+1,v=15,y=16,w=7,_=256,k=16,x=17,I=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=new Array(2*(p+2));l(M);var C=new Array(2*u);l(C);var B=new Array(512);l(B);var g=new Array(256);l(g);var L=new Array(c);l(L);var tt,A,Z,z=new Array(u);function H(E,P,K,$,T){this.static_tree=E,this.extra_bits=P,this.extra_base=K,this.elems=$,this.max_length=T,this.has_stree=E&&E.length}function F(E,P){this.dyn_tree=E,this.max_code=0,this.stat_desc=P}function N(E){return E<256?B[E]:B[256+(E>>>7)]}function nt(E,P){E.pending_buf[E.pending++]=255&P,E.pending_buf[E.pending++]=P>>>8&255}function J(E,P,K){E.bi_valid>y-K?(E.bi_buf|=P<<E.bi_valid&65535,nt(E,E.bi_buf),E.bi_buf=P>>y-E.bi_valid,E.bi_valid+=K-y):(E.bi_buf|=P<<E.bi_valid&65535,E.bi_valid+=K)}function q(E,P,K){J(E,K[2*P],K[2*P+1])}function ht(E,P){for(var K=0;K|=1&E,E>>>=1,K<<=1,0<--P;);return K>>>1}function vt(E,P,K){var $,T,V=new Array(v+1),et=0;for($=1;$<=v;$++)V[$]=et=et+K[$-1]<<1;for(T=0;T<=P;T++){var Y=E[2*T+1];Y!==0&&(E[2*T]=ht(V[Y]++,Y))}}function st(E){var P;for(P=0;P<p;P++)E.dyn_ltree[2*P]=0;for(P=0;P<u;P++)E.dyn_dtree[2*P]=0;for(P=0;P<b;P++)E.bl_tree[2*P]=0;E.dyn_ltree[2*_]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function dt(E){8<E.bi_valid?nt(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function _t(E,P,K,$){var T=2*P,V=2*K;return E[T]<E[V]||E[T]===E[V]&&$[P]<=$[K]}function mt(E,P,K){for(var $=E.heap[K],T=K<<1;T<=E.heap_len&&(T<E.heap_len&&_t(P,E.heap[T+1],E.heap[T],E.depth)&&T++,!_t(P,$,E.heap[T],E.depth));)E.heap[K]=E.heap[T],K=T,T<<=1;E.heap[K]=$}function ft(E,P,K){var $,T,V,et,Y=0;if(E.last_lit!==0)for(;$=E.pending_buf[E.d_buf+2*Y]<<8|E.pending_buf[E.d_buf+2*Y+1],T=E.pending_buf[E.l_buf+Y],Y++,$===0?q(E,T,P):(q(E,(V=g[T])+h+1,P),(et=O[V])!==0&&J(E,T-=L[V],et),q(E,V=N(--$),K),(et=R[V])!==0&&J(E,$-=z[V],et)),Y<E.last_lit;);q(E,_,P)}function bt(E,P){var K,$,T,V=P.dyn_tree,et=P.stat_desc.static_tree,Y=P.stat_desc.has_stree,it=P.stat_desc.elems,pt=-1;for(E.heap_len=0,E.heap_max=f,K=0;K<it;K++)V[2*K]!==0?(E.heap[++E.heap_len]=pt=K,E.depth[K]=0):V[2*K+1]=0;for(;E.heap_len<2;)V[2*(T=E.heap[++E.heap_len]=pt<2?++pt:0)]=1,E.depth[T]=0,E.opt_len--,Y&&(E.static_len-=et[2*T+1]);for(P.max_code=pt,K=E.heap_len>>1;1<=K;K--)mt(E,V,K);for(T=it;K=E.heap[1],E.heap[1]=E.heap[E.heap_len--],mt(E,V,1),$=E.heap[1],E.heap[--E.heap_max]=K,E.heap[--E.heap_max]=$,V[2*T]=V[2*K]+V[2*$],E.depth[T]=(E.depth[K]>=E.depth[$]?E.depth[K]:E.depth[$])+1,V[2*K+1]=V[2*$+1]=T,E.heap[1]=T++,mt(E,V,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(ut,Wt){var He,qt,Ze,xt,kr,mn,Xt=Wt.dyn_tree,ji=Wt.max_code,bo=Wt.stat_desc.static_tree,_o=Wt.stat_desc.has_stree,ko=Wt.stat_desc.extra_bits,Ri=Wt.stat_desc.extra_base,Ve=Wt.stat_desc.max_length,xr=0;for(xt=0;xt<=v;xt++)ut.bl_count[xt]=0;for(Xt[2*ut.heap[ut.heap_max]+1]=0,He=ut.heap_max+1;He<f;He++)Ve<(xt=Xt[2*Xt[2*(qt=ut.heap[He])+1]+1]+1)&&(xt=Ve,xr++),Xt[2*qt+1]=xt,ji<qt||(ut.bl_count[xt]++,kr=0,Ri<=qt&&(kr=ko[qt-Ri]),mn=Xt[2*qt],ut.opt_len+=mn*(xt+kr),_o&&(ut.static_len+=mn*(bo[2*qt+1]+kr)));if(xr!==0){do{for(xt=Ve-1;ut.bl_count[xt]===0;)xt--;ut.bl_count[xt]--,ut.bl_count[xt+1]+=2,ut.bl_count[Ve]--,xr-=2}while(0<xr);for(xt=Ve;xt!==0;xt--)for(qt=ut.bl_count[xt];qt!==0;)ji<(Ze=ut.heap[--He])||(Xt[2*Ze+1]!==xt&&(ut.opt_len+=(xt-Xt[2*Ze+1])*Xt[2*Ze],Xt[2*Ze+1]=xt),qt--)}}(E,P),vt(V,pt,E.bl_count)}function m(E,P,K){var $,T,V=-1,et=P[1],Y=0,it=7,pt=4;for(et===0&&(it=138,pt=3),P[2*(K+1)+1]=65535,$=0;$<=K;$++)T=et,et=P[2*($+1)+1],++Y<it&&T===et||(Y<pt?E.bl_tree[2*T]+=Y:T!==0?(T!==V&&E.bl_tree[2*T]++,E.bl_tree[2*k]++):Y<=10?E.bl_tree[2*x]++:E.bl_tree[2*I]++,V=T,pt=(Y=0)===et?(it=138,3):T===et?(it=6,3):(it=7,4))}function U(E,P,K){var $,T,V=-1,et=P[1],Y=0,it=7,pt=4;for(et===0&&(it=138,pt=3),$=0;$<=K;$++)if(T=et,et=P[2*($+1)+1],!(++Y<it&&T===et)){if(Y<pt)for(;q(E,T,E.bl_tree),--Y!=0;);else T!==0?(T!==V&&(q(E,T,E.bl_tree),Y--),q(E,k,E.bl_tree),J(E,Y-3,2)):Y<=10?(q(E,x,E.bl_tree),J(E,Y-3,3)):(q(E,I,E.bl_tree),J(E,Y-11,7));V=T,pt=(Y=0)===et?(it=138,3):T===et?(it=6,3):(it=7,4)}}l(z);var W=!1;function S(E,P,K,$){J(E,(d<<1)+($?1:0),3),function(T,V,et,Y){dt(T),Y&&(nt(T,et),nt(T,~et)),a.arraySet(T.pending_buf,T.window,V,et,T.pending),T.pending+=et}(E,P,K,!0)}i._tr_init=function(E){W||(function(){var P,K,$,T,V,et=new Array(v+1);for(T=$=0;T<c-1;T++)for(L[T]=$,P=0;P<1<<O[T];P++)g[$++]=T;for(g[$-1]=T,T=V=0;T<16;T++)for(z[T]=V,P=0;P<1<<R[T];P++)B[V++]=T;for(V>>=7;T<u;T++)for(z[T]=V<<7,P=0;P<1<<R[T]-7;P++)B[256+V++]=T;for(K=0;K<=v;K++)et[K]=0;for(P=0;P<=143;)M[2*P+1]=8,P++,et[8]++;for(;P<=255;)M[2*P+1]=9,P++,et[9]++;for(;P<=279;)M[2*P+1]=7,P++,et[7]++;for(;P<=287;)M[2*P+1]=8,P++,et[8]++;for(vt(M,p+1,et),P=0;P<u;P++)C[2*P+1]=5,C[2*P]=ht(P,5);tt=new H(M,O,h+1,p,v),A=new H(C,R,0,u,v),Z=new H(new Array(0),D,0,b,w)}(),W=!0),E.l_desc=new F(E.dyn_ltree,tt),E.d_desc=new F(E.dyn_dtree,A),E.bl_desc=new F(E.bl_tree,Z),E.bi_buf=0,E.bi_valid=0,st(E)},i._tr_stored_block=S,i._tr_flush_block=function(E,P,K,$){var T,V,et=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(Y){var it,pt=4093624447;for(it=0;it<=31;it++,pt>>>=1)if(1&pt&&Y.dyn_ltree[2*it]!==0)return s;if(Y.dyn_ltree[18]!==0||Y.dyn_ltree[20]!==0||Y.dyn_ltree[26]!==0)return o;for(it=32;it<h;it++)if(Y.dyn_ltree[2*it]!==0)return o;return s}(E)),bt(E,E.l_desc),bt(E,E.d_desc),et=function(Y){var it;for(m(Y,Y.dyn_ltree,Y.l_desc.max_code),m(Y,Y.dyn_dtree,Y.d_desc.max_code),bt(Y,Y.bl_desc),it=b-1;3<=it&&Y.bl_tree[2*j[it]+1]===0;it--);return Y.opt_len+=3*(it+1)+5+5+4,it}(E),T=E.opt_len+3+7>>>3,(V=E.static_len+3+7>>>3)<=T&&(T=V)):T=V=K+5,K+4<=T&&P!==-1?S(E,P,K,$):E.strategy===4||V===T?(J(E,2+($?1:0),3),ft(E,M,C)):(J(E,4+($?1:0),3),function(Y,it,pt,ut){var Wt;for(J(Y,it-257,5),J(Y,pt-1,5),J(Y,ut-4,4),Wt=0;Wt<ut;Wt++)J(Y,Y.bl_tree[2*j[Wt]+1],3);U(Y,Y.dyn_ltree,it-1),U(Y,Y.dyn_dtree,pt-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,et+1),ft(E,E.dyn_ltree,E.dyn_dtree)),st(E),$&&dt(E)},i._tr_tally=function(E,P,K){return E.pending_buf[E.d_buf+2*E.last_lit]=P>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&P,E.pending_buf[E.l_buf+E.last_lit]=255&K,E.last_lit++,P===0?E.dyn_ltree[2*K]++:(E.matches++,P--,E.dyn_ltree[2*(g[K]+h+1)]++,E.dyn_dtree[2*N(P)]++),E.last_lit===E.lit_bufsize-1},i._tr_align=function(E){J(E,2,3),q(E,_,M),function(P){P.bi_valid===16?(nt(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):8<=P.bi_valid&&(P.pending_buf[P.pending++]=255&P.bi_buf,P.bi_buf>>=8,P.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(a){(function(s,o){if(!s.setImmediate){var l,d,c,h,p=1,u={},b=!1,f=s.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(s);v=v&&v.setTimeout?v:s,l={}.toString.call(s.process)==="[object process]"?function(k){process.nextTick(function(){w(k)})}:function(){if(s.postMessage&&!s.importScripts){var k=!0,x=s.onmessage;return s.onmessage=function(){k=!1},s.postMessage("","*"),s.onmessage=x,k}}()?(h="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",_,!1):s.attachEvent("onmessage",_),function(k){s.postMessage(h+k,"*")}):s.MessageChannel?((c=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){c.port2.postMessage(k)}):f&&"onreadystatechange"in f.createElement("script")?(d=f.documentElement,function(k){var x=f.createElement("script");x.onreadystatechange=function(){w(k),x.onreadystatechange=null,d.removeChild(x),x=null},d.appendChild(x)}):function(k){setTimeout(w,0,k)},v.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var x=new Array(arguments.length-1),I=0;I<x.length;I++)x[I]=arguments[I+1];var O={callback:k,args:x};return u[p]=O,l(p),p++},v.clearImmediate=y}function y(k){delete u[k]}function w(k){if(b)setTimeout(w,0,k);else{var x=u[k];if(x){b=!0;try{(function(I){var O=I.callback,R=I.args;switch(R.length){case 0:O();break;case 1:O(R[0]);break;case 2:O(R[0],R[1]);break;case 3:O(R[0],R[1],R[2]);break;default:O.apply(o,R)}})(x)}finally{y(k),b=!1}}}}function _(k){k.source===s&&typeof k.data=="string"&&k.data.indexOf(h)===0&&w(+k.data.slice(h.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof Er<"u"?Er:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(wo);var Hc=wo.exports;const Zc=la(Hc);async function Vc(e){let t="",r=e;for(;r!=null;){const n=await(Ee==null?void 0:Ee.get(r));if(n==null)break;t=`${n.name}/${t}`,r=n.parentFolderID??null}return t}const Yc=async e=>{const t=`ComfyUI workspace workflows ${xc(Date.now())}`,r=new Zc,n=await(X==null?void 0:X.getSetting("twoWaySync"));for(const i of e){let a;n?a=i.parentFolderID??"":a=await Vc(i.parentFolderID??null).then(async o=>pe(o??""));const s=r.folder(a);s==null||s.file(`${i.name}.json`,i.json)}r.generateAsync({type:"blob"}).then(function(i){const a=document.createElement("a");a.href=window.URL.createObjectURL(i),a.download=`${t}.zip`,document.body.appendChild(a),a.click(),document.body.removeChild(a)})};function Gc({myWorkflowsDir:e}){return lt.jsxs(ui,{gap:3,children:[lt.jsx(_a,{size:"md",children:" Upgrade to 2.0 - enable two way sync!"}),lt.jsx("p",{children:"Your workflows will be synced to and from path:"}),lt.jsx("p",{children:lt.jsx("b",{children:e})}),lt.jsxs("p",{children:["You can manually put workflow files into this folder using File Explorer to sync them with your workspace. You can change this path anytime in Settings ",">"," Workspace Save Directory"]}),lt.jsxs("p",{children:[lt.jsx("b",{children:"Please download all your workflows before enabling two way sync as a backup!"})," ","So you can manually import some workflows into your workspace in case something unexpected happens."]}),lt.jsx(ha,{colorScheme:"teal",variant:"outline",width:"fit-content",onClick:async()=>{const t=await(G==null?void 0:G.listAll());Yc(t??[])},children:" Download All My Workflows"})]})}var Jc={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Xc=Jc.VITE_SHARE_KEY_ENCODE_KEY;function Qc(e,t=Xc){const r=decodeURIComponent(atob(e)),n=r.indexOf(t);if(n===-1)throw new Error("Invalid encoded string or salt");return r.slice(n+t.length)}const tu=No.lazy(()=>Bo(()=>import("./workflowChat-IQPiKNXP.js"),__vite__mapDeps([0,1])));function nu(){const[e,t]=Q.useState(null),[r,n]=Q.useState("root"),[i,a]=Q.useState(!0),[s,o]=Q.useState(null),l=Q.useRef(null),[d,c]=Q.useState(null),[h,p]=Q.useState(!1),u=Q.useRef(null),{showDialog:b}=pa(),[f,v]=Q.useState(!1);Q.useRef(!1);const y=Fo(),[w,_]=qc(null),[k,x]=Q.useState(!1),I=Q.useCallback(async(A=!1)=>{var z;const Z=G==null?void 0:G.curWorkflow;if(Z){if(!A&&((z=G==null?void 0:G.curWorkflow)!=null&&z.saveLock)){y({title:"The workflow is locked and cannot be saved",status:"warning",duration:3e3});return}const H=JSON.stringify(se.graph.serialize());await Promise.all([G==null?void 0:G.updateFlow(Z.id,{json:H}),Se==null?void 0:Se.create({workflowID:Z.id,json:H,isAutoSave:!1})]),p(!1)}},[]),O=async()=>{var Z,z;if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")){const H=(Z=G==null?void 0:G.curWorkflow)==null?void 0:Z.id;if(H==null)return;const F=(z=await(G==null?void 0:G.get(H)))==null?void 0:z.json;F?(G==null||G.updateCurWorkflow({...G.curWorkflow,json:F}),await se.loadGraphData(JSON.parse(F)),p(!1)):alert("Error: No last saved version found")}},R=A=>{const Z=(A==null?void 0:A.id)??null;if(G==null||G.updateCurWorkflow(A),l.current=Z,o(Z),t((A==null?void 0:A.name)??""),Z==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(ia()){const z=uo(Z);window.location.hash=z,document.title=A.name+" - ComfyUI"}else localStorage.setItem("curFlowID",Z),document.title="ComfyUI - "+A.name;A&&(G==null||G.updateLastOpenedTime(A.id))},D=async()=>{localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await Pc()}catch(H){console.error("Workspace Manager - Error loading db",H)}a(!1);const A=ia();if(A!=null&&j(A),St("/workspace/deduplicate_workflow_ids"),St("/workspace/get_os").then(H=>H.json()).then(H=>{H.os&&(ho.os=H.os)}),!await(X==null?void 0:X.getSetting("twoWaySync"))){if(await ct.workflows.count()==0){await(X==null?void 0:X.upsert({twoWaySync:!0})),await ct.cache.put({id:aa,value:"true"});return}const F=await(X==null?void 0:X.getSetting("myWorkflowsDir"));b(lt.jsx(Gc,{myWorkflowsDir:F??"undefined"}),[{label:"I have downloaded all my workflows and ready to enable",onClick:async()=>{await(X==null?void 0:X.upsert({twoWaySync:!0})),await(X==null?void 0:X.getSetting("twoWaySync"))&&(ct.cache.put({id:aa,value:"true"}),location.reload())},colorScheme:"red"}],{closeOnOverlayClick:!1})}const z=localStorage.getItem("workspace_manager_shareKey");if(z){const H=Qc(z);H&&c({shareKey:H,username:null})}},j=async(A,Z)=>{if(se.graph==null)return;const z=await(G==null?void 0:G.get(A));if(z==null){alert("Error: Workflow not found! id: "+A),R(null);return}const H=Z?await(Ft==null?void 0:Ft.get(Z)):null;se.ui.dialog.close(),H?(_(H),R({...z,json:H.json}),se.loadGraphData(JSON.parse(H.json))):(R(z),_(null),se.loadGraphData(JSON.parse(z.json))),n("root"),h&&p(!1)},M=async(A,Z,z=!1)=>{var H;if(A===null){R(null),se.graph.clear();return}if(!h||z||(G==null?void 0:G.curWorkflow)==null||(H=X==null?void 0:X.settings)!=null&&H.disableUnsavedWarning){j(A,Z);return}C(A)},C=async A=>{var z;const Z=[A?{label:"Open in new tab",icon:lt.jsx(Wc,{}),onClick:()=>{Sc(A)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await I(),A&&j(A)}}];Z.push({label:"Discard",colorScheme:"red",onClick:async()=>{A&&j(A)}}),b(`Please save or discard your changes to "${(z=G==null?void 0:G.curWorkflow)==null?void 0:z.name}" before leaving, or your changes will be lost.`,Z)},B=async A=>{const Z=(A==null?void 0:A.json)??JSON.stringify(fo),z=await(G==null?void 0:G.createFlow({json:Z,name:A==null?void 0:A.name}));z&&await M(z.id),n("root")},g=async(A,Z=!1)=>{const z=A.split("/").pop()??A;Z?I():B({name:z});const H=await fetch(Ec(A)),F=await H.blob(),N=new File([F],z,{type:H.headers.get("Content-Type")||""});await se.handleFile(N),n("root")},L=async(A,Z)=>{const z=await(G==null?void 0:G.get(A));if(z==null)return;const H=await(G==null?void 0:G.createFlow({json:z.json,name:Z||z.name,parentFolderID:z.parentFolderID}));H&&await M(H.id)},tt=Q.useCallback(A=>{if(l.current==null)return;let Z=A.filename;A.subfolder!=null&&A.subfolder!==""&&(Z=A.subfolder+"/"+Z),Zr==null||Zr.create({workflowID:l.current,localPath:Z})},[]);return Q.useEffect(()=>{D(),v(!0);const A=Z=>{var z,H,F,N,nt,J;(F=(H=(z=Z.detail)==null?void 0:z.output)==null?void 0:H.images)==null||F.forEach(q=>{q.type==="output"&&tt(q)}),(J=(nt=(N=Z.detail)==null?void 0:N.output)==null?void 0:nt.gifs)==null||J.forEach(q=>{q.type==="output"&&tt(q)})};return In.addEventListener("executed",A),()=>{window.removeEventListener("executed",A)}},[]),i?null:lt.jsx(mo.Provider,{value:{curFlowID:s,onDuplicateWorkflow:L,loadWorkflowID:M,discardUnsavedChanges:O,saveCurWorkflow:I,isDirty:h,setIsDirty:p,loadNewWorkflow:B,loadFilePath:g,setRoute:n,route:r,curVersion:w,setCurVersion:_,setCurFlowIDAndName:R,session:d,updateSession:c},children:lt.jsx("div",{ref:u,className:"workspace_manager",children:lt.jsxs(fa,{containerRef:u,children:[lt.jsxs(di,{style:{position:"absolute",top:0,right:0,left:0},zIndex:Oc,draggable:!1,children:[lt.jsx(Mc,{onChatClick:()=>x(!0),showChat:k}),k&&lt.jsx(tu,{onClose:()=>x(!1)})]}),lt.jsx(Uc,{})]})})})}export{nu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/workflowChat-IQPiKNXP.js","workspace_web/input.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}