var pl=Object.defineProperty;var ml=(t,e,n)=>e in t?pl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Oe=(t,e,n)=>(ml(t,typeof e!="symbol"?e+"":e,n),n);import{u as yl,a as vl,r as A,c as gl,b as Qe,m as Me,d as Lt,f as fe,e as _e,j as C,B as wl,g as ue,h as Te,i as bl,o as et,k as Rt,l as ot,I as Wr,n as Ur,p as oo,q as Ie,s as Ea,t as _l,v as xl,w as kl,x as Kr,y as El,z as Cl,A as Sl,C as Il,D as Ol,E as is,F as Ca,G as ls,H as Sa,J as Dl,K as Pl,L as jl,P as Ia,M as bo,N as Se,O as $r,Q as Hr,R as qr,S as cs,T as us,U as Oa,V as Al,_ as Zt,W as Da,X as Pa,Y as ja,Z as Xn,$ as ds}from"./input.js";function Nl(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}function Aa(t){var e;return Nl(t)&&(e=t.ownerDocument)!=null?e:document}function Fl(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Rl=Fl();function Tl(t){const e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function Un(t){const{theme:e}=yl(),n=vl();return A.useMemo(()=>gl(e.direction,{...n,...t}),[t,e.direction,n])}var Bl=Object.defineProperty,Ml=(t,e,n)=>e in t?Bl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,De=(t,e,n)=>(Ml(t,typeof e!="symbol"?e+"":e,n),n);function Hs(t){return t.sort((e,n)=>{const r=e.compareDocumentPosition(n);if(r&Node.DOCUMENT_POSITION_FOLLOWING||r&Node.DOCUMENT_POSITION_CONTAINED_BY)return-1;if(r&Node.DOCUMENT_POSITION_PRECEDING||r&Node.DOCUMENT_POSITION_CONTAINS)return 1;if(r&Node.DOCUMENT_POSITION_DISCONNECTED||r&Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC)throw Error("Cannot sort the given nodes.");return 0})}var zl=t=>typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE;function qs(t,e,n){let r=t+1;return n&&r>=e&&(r=0),r}function Vs(t,e,n){let r=t-1;return n&&r<0&&(r=e),r}var _o=typeof window<"u"?A.useLayoutEffect:A.useEffect,xr=t=>t,Ll=class{constructor(){De(this,"descendants",new Map),De(this,"register",t=>{if(t!=null)return zl(t)?this.registerNode(t):e=>{this.registerNode(e,t)}}),De(this,"unregister",t=>{this.descendants.delete(t);const e=Hs(Array.from(this.descendants.keys()));this.assignIndex(e)}),De(this,"destroy",()=>{this.descendants.clear()}),De(this,"assignIndex",t=>{this.descendants.forEach(e=>{const n=t.indexOf(e.node);e.index=n,e.node.dataset.index=e.index.toString()})}),De(this,"count",()=>this.descendants.size),De(this,"enabledCount",()=>this.enabledValues().length),De(this,"values",()=>Array.from(this.descendants.values()).sort((e,n)=>e.index-n.index)),De(this,"enabledValues",()=>this.values().filter(t=>!t.disabled)),De(this,"item",t=>{if(this.count()!==0)return this.values()[t]}),De(this,"enabledItem",t=>{if(this.enabledCount()!==0)return this.enabledValues()[t]}),De(this,"first",()=>this.item(0)),De(this,"firstEnabled",()=>this.enabledItem(0)),De(this,"last",()=>this.item(this.descendants.size-1)),De(this,"lastEnabled",()=>{const t=this.enabledValues().length-1;return this.enabledItem(t)}),De(this,"indexOf",t=>{var e,n;return t&&(n=(e=this.descendants.get(t))==null?void 0:e.index)!=null?n:-1}),De(this,"enabledIndexOf",t=>t==null?-1:this.enabledValues().findIndex(e=>e.node.isSameNode(t))),De(this,"next",(t,e=!0)=>{const n=qs(t,this.count(),e);return this.item(n)}),De(this,"nextEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=qs(r,this.enabledCount(),e);return this.enabledItem(o)}),De(this,"prev",(t,e=!0)=>{const n=Vs(t,this.count()-1,e);return this.item(n)}),De(this,"prevEnabled",(t,e=!0)=>{const n=this.item(t);if(!n)return;const r=this.enabledIndexOf(n.node),o=Vs(r,this.enabledCount()-1,e);return this.enabledItem(o)}),De(this,"registerNode",(t,e)=>{if(!t||this.descendants.has(t))return;const n=Array.from(this.descendants.keys()).concat(t),r=Hs(n);e!=null&&e.disabled&&(e.disabled=!!e.disabled);const o={node:t,index:-1,...e};this.descendants.set(t,o),this.assignIndex(r)})}};function Wl(){const t=A.useRef(new Ll);return _o(()=>()=>t.current.destroy()),t.current}var[Ul,Na]=Qe({name:"DescendantsProvider",errorMessage:"useDescendantsContext must be used within DescendantsProvider"});function Kl(t){const e=Na(),[n,r]=A.useState(-1),o=A.useRef(null);_o(()=>()=>{o.current&&e.unregister(o.current)},[]),_o(()=>{if(!o.current)return;const a=Number(o.current.dataset.index);n!=a&&!Number.isNaN(a)&&r(a)});const s=xr(t?e.register(t):e.register);return{descendants:e,index:n,enabledIndex:e.enabledIndexOf(o.current),register:Me(s,o)}}function Fa(){return[xr(Ul),()=>xr(Na()),()=>Wl(),o=>Kl(o)]}function Ra(t){const{value:e,defaultValue:n,onChange:r,shouldUpdate:o=(p,d)=>p!==d}=t,s=Lt(r),a=Lt(o),[i,l]=A.useState(n),c=e!==void 0,u=c?e:i,f=Lt(p=>{const w=typeof p=="function"?p(u):p;a(u,w)&&(c||l(w),s(w))},[c,s,u,a]);return[u,f]}function fs(t){return A.Children.toArray(t).filter(e=>A.isValidElement(e))}var $l={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},Hl={horizontal:t=>({"& > *:not(style) ~ *:not(style)":{marginStart:t}}),vertical:t=>({"& > *:not(style) ~ *:not(style)":{marginTop:t}})},Ta=fe(function(e,n){const{size:r,colorScheme:o,variant:s,className:a,spacing:i="0.5rem",isAttached:l,isDisabled:c,orientation:u="horizontal",...f}=e,p=_e("chakra-button__group",a),d=A.useMemo(()=>({size:r,colorScheme:o,variant:s,isDisabled:c}),[r,o,s,c]);let w={display:"inline-flex",...l?$l[u]:Hl[u](i)};const h=u==="vertical";return C.jsx(wl,{value:d,children:C.jsx(ue.div,{ref:n,role:"group",__css:w,className:p,"data-attached":l?"":void 0,"data-orientation":u,flexDir:h?"column":void 0,...f})})});Ta.displayName="ButtonGroup";var An=fe((t,e)=>{const{icon:n,children:r,isRound:o,"aria-label":s,...a}=t,i=n||r,l=A.isValidElement(i)?A.cloneElement(i,{"aria-hidden":!0,focusable:!1}):null;return C.jsx(Te,{padding:"0",borderRadius:o?"full":void 0,ref:e,"aria-label":s,...a,children:l})});An.displayName="IconButton";var[ql,Ba]=bl("Card"),Vl=fe(function(e,n){const{className:r,...o}=e,s=Ba();return C.jsx(ue.div,{ref:n,className:_e("chakra-card__body",r),__css:s.body,...o})}),Zl=fe(function(e,n){const{className:r,...o}=e,s=Ba();return C.jsx(ue.div,{ref:n,className:_e("chakra-card__header",r),__css:s.header,...o})}),Gl=fe(function(e,n){const{className:r,children:o,direction:s="column",justify:a,align:i,...l}=et(e),c=Rt("Card",e);return C.jsx(ue.div,{ref:n,className:_e("chakra-card",r),__css:{display:"flex",flexDirection:s,justifyContent:a,alignItems:i,position:"relative",minWidth:0,wordWrap:"break-word",...c.container},...l,children:C.jsx(ql,{value:c,children:o})})}),[Yl,Ma]=Qe({name:"FormControlStylesContext",errorMessage:`useFormControlStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormControl />" `}),[Jl,pn]=Qe({strict:!1,name:"FormControlContext"});function Xl(t){const{id:e,isRequired:n,isInvalid:r,isDisabled:o,isReadOnly:s,...a}=t,i=A.useId(),l=e||`field-${i}`,c=`${l}-label`,u=`${l}-feedback`,f=`${l}-helptext`,[p,d]=A.useState(!1),[w,h]=A.useState(!1),[y,m]=A.useState(!1),v=A.useCallback((E={},N=null)=>({id:f,...E,ref:Me(N,D=>{D&&h(!0)})}),[f]),_=A.useCallback((E={},N=null)=>({...E,ref:N,"data-focus":ot(y),"data-disabled":ot(o),"data-invalid":ot(r),"data-readonly":ot(s),id:E.id!==void 0?E.id:c,htmlFor:E.htmlFor!==void 0?E.htmlFor:l}),[l,o,y,r,s,c]),k=A.useCallback((E={},N=null)=>({id:u,...E,ref:Me(N,D=>{D&&d(!0)}),"aria-live":"polite"}),[u]),x=A.useCallback((E={},N=null)=>({...E,...a,ref:N,role:"group","data-focus":ot(y),"data-disabled":ot(o),"data-invalid":ot(r),"data-readonly":ot(s)}),[a,o,y,r,s]),I=A.useCallback((E={},N=null)=>({...E,ref:N,role:"presentation","aria-hidden":!0,children:E.children||"*"}),[]);return{isRequired:!!n,isInvalid:!!r,isReadOnly:!!s,isDisabled:!!o,isFocused:!!y,onFocus:()=>m(!0),onBlur:()=>m(!1),hasFeedbackText:p,setHasFeedbackText:d,hasHelpText:w,setHasHelpText:h,id:l,labelId:c,feedbackId:u,helpTextId:f,htmlProps:a,getHelpTextProps:v,getErrorMessageProps:k,getRootProps:x,getLabelProps:_,getRequiredIndicatorProps:I}}var Vr=fe(function(e,n){const r=Rt("Form",e),o=et(e),{getRootProps:s,htmlProps:a,...i}=Xl(o),l=_e("chakra-form-control",e.className);return C.jsx(Jl,{value:i,children:C.jsx(Yl,{value:r,children:C.jsx(ue.div,{...s({},n),className:l,__css:r.container})})})});Vr.displayName="FormControl";var Ql=fe(function(e,n){const r=pn(),o=Ma(),s=_e("chakra-form__helper-text",e.className);return C.jsx(ue.div,{...r==null?void 0:r.getHelpTextProps(e,n),__css:o.helperText,className:s})});Ql.displayName="FormHelperText";var[ec,tc]=Qe({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),Zr=fe((t,e)=>{const n=Rt("FormError",t),r=et(t),o=pn();return o!=null&&o.isInvalid?C.jsx(ec,{value:n,children:C.jsx(ue.div,{...o==null?void 0:o.getErrorMessageProps(r,e),className:_e("chakra-form__error-message",t.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});Zr.displayName="FormErrorMessage";var nc=fe((t,e)=>{const n=tc(),r=pn();if(!(r!=null&&r.isInvalid))return null;const o=_e("chakra-form__error-icon",t.className);return C.jsx(Wr,{ref:e,"aria-hidden":!0,...t,__css:n.icon,className:o,children:C.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});nc.displayName="FormErrorIcon";var Gr=fe(function(e,n){var r;const o=Ur("FormLabel",e),s=et(e),{className:a,children:i,requiredIndicator:l=C.jsx(za,{}),optionalIndicator:c=null,...u}=s,f=pn(),p=(r=f==null?void 0:f.getLabelProps(u,n))!=null?r:{ref:n,...u};return C.jsxs(ue.label,{...p,className:_e("chakra-form__label",s.className),__css:{display:"block",textAlign:"start",...o},children:[i,f!=null&&f.isRequired?l:c]})});Gr.displayName="FormLabel";var za=fe(function(e,n){const r=pn(),o=Ma();if(!(r!=null&&r.isRequired))return null;const s=_e("chakra-form__required-indicator",e.className);return C.jsx(ue.span,{...r==null?void 0:r.getRequiredIndicatorProps(e,n),__css:o.requiredIndicator,className:s})});za.displayName="RequiredIndicator";function rc(t){const{isDisabled:e,isInvalid:n,isReadOnly:r,isRequired:o,...s}=oc(t);return{...s,disabled:e,readOnly:r,required:o,"aria-invalid":oo(n),"aria-required":oo(o),"aria-readonly":oo(r)}}function oc(t){var e,n,r;const o=pn(),{id:s,disabled:a,readOnly:i,required:l,isRequired:c,isInvalid:u,isReadOnly:f,isDisabled:p,onFocus:d,onBlur:w,...h}=t,y=t["aria-describedby"]?[t["aria-describedby"]]:[];return o!=null&&o.hasFeedbackText&&(o!=null&&o.isInvalid)&&y.push(o.feedbackId),o!=null&&o.hasHelpText&&y.push(o.helpTextId),{...h,"aria-describedby":y.join(" ")||void 0,id:s??(o==null?void 0:o.id),isDisabled:(e=a??p)!=null?e:o==null?void 0:o.isDisabled,isReadOnly:(n=i??f)!=null?n:o==null?void 0:o.isReadOnly,isRequired:(r=l??c)!=null?r:o==null?void 0:o.isRequired,isInvalid:u??(o==null?void 0:o.isInvalid),onFocus:Ie(o==null?void 0:o.onFocus,d),onBlur:Ie(o==null?void 0:o.onBlur,w)}}function nn(t,e,n,r){const o=Lt(n);return A.useEffect(()=>{const s=typeof t=="function"?t():t??document;if(!(!n||!s))return s.addEventListener(e,o,r),()=>{s.removeEventListener(e,o,r)}},[e,t,r,o,n]),()=>{const s=typeof t=="function"?t():t??document;s==null||s.removeEventListener(e,o,r)}}function sc(t){return"current"in t}var La=()=>typeof window<"u";function ac(){var t;const e=navigator.userAgentData;return(t=e==null?void 0:e.platform)!=null?t:navigator.platform}var ic=t=>La()&&t.test(navigator.vendor),lc=t=>La()&&t.test(ac()),cc=()=>lc(/mac|iphone|ipad|ipod/i),uc=()=>cc()&&ic(/apple/i);function dc(t){const{ref:e,elements:n,enabled:r}=t,o=()=>{var s,a;return(a=(s=e.current)==null?void 0:s.ownerDocument)!=null?a:document};nn(o,"pointerdown",s=>{if(!uc()||!r)return;const a=s.target,l=(n??[e]).some(c=>{const u=sc(c)?c.current:c;return(u==null?void 0:u.contains(a))||u===a});o().activeElement!==a&&l&&(s.preventDefault(),a.focus())})}var Wa={exports:{}},fc="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",hc=fc,pc=hc;function Ua(){}function Ka(){}Ka.resetWarningCache=Ua;var mc=function(){function t(r,o,s,a,i,l){if(l!==pc){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Ka,resetWarningCache:Ua};return n.PropTypes=n,n};Wa.exports=mc();var yc=Wa.exports;const Bt=Ea(yc);function vc(t){const e=t.ownerDocument.defaultView||window,{overflow:n,overflowX:r,overflowY:o}=e.getComputedStyle(t);return/auto|scroll|overlay|hidden/.test(n+o+r)}function gc(t){return t.localName==="html"?t:t.assignedSlot||t.parentElement||t.ownerDocument.documentElement}function $a(t){return["html","body","#document"].includes(t.localName)?t.ownerDocument.body:_l(t)&&vc(t)?t:$a(gc(t))}var wc=Rl?A.useLayoutEffect:A.useEffect;function xo(t,e=[]){const n=A.useRef(t);return wc(()=>{n.current=t}),A.useCallback((...r)=>{var o;return(o=n.current)==null?void 0:o.call(n,...r)},e)}function bc(t){const{ref:e,handler:n,enabled:r=!0}=t,o=xo(n),a=A.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;A.useEffect(()=>{if(!r)return;const i=f=>{so(f,e)&&(a.isPointerDown=!0)},l=f=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&n&&so(f,e)&&(a.isPointerDown=!1,o(f))},c=f=>{a.ignoreEmulatedMouseEvents=!0,n&&a.isPointerDown&&so(f,e)&&(a.isPointerDown=!1,o(f))},u=Aa(e.current);return u.addEventListener("mousedown",i,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",i,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",i,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",i,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,a,r])}function so(t,e){var n;const r=t.target;return r&&!Aa(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function _c(t,e){const n=A.useId();return A.useMemo(()=>t||[e,n].filter(Boolean).join("-"),[t,e,n])}function xc(t,e){const n=t!==void 0;return[n,n&&typeof t<"u"?t:e]}function kc(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=xo(n),a=xo(e),[i,l]=A.useState(t.defaultIsOpen||!1),[c,u]=xc(r,i),f=_c(o,"disclosure"),p=A.useCallback(()=>{c||l(!1),a==null||a()},[c,a]),d=A.useCallback(()=>{c||l(!0),s==null||s()},[c,s]),w=A.useCallback(()=>{(u?p:d)()},[u,d,p]);return{isOpen:!!u,onOpen:d,onClose:p,onToggle:w,isControlled:c,getButtonProps:(h={})=>({...h,"aria-expanded":u,"aria-controls":f,onClick:xl(h.onClick,w)}),getDisclosureProps:(h={})=>({...h,hidden:!u,id:f})}}var mn=fe(function(e,n){const{htmlSize:r,...o}=e,s=Rt("Input",o),a=et(o),i=rc(a),l=_e("chakra-input",e.className);return C.jsx(ue.input,{size:r,...i,__css:s.field,ref:n,className:l})});mn.displayName="Input";mn.id="Input";function Ec(t,e){return Array.isArray(t)?t.map(n=>n===null?null:e(n)):kl(t)?Object.keys(t).reduce((n,r)=>(n[r]=e(t[r]),n),{}):t!=null?e(t):null}var yt=fe(function(e,n){const r=Ur("Text",e),{className:o,align:s,decoration:a,casing:i,...l}=et(e),c=Tl({textAlign:e.align,textDecoration:e.decoration,textTransform:e.casing});return C.jsx(ue.p,{ref:n,className:_e("chakra-text",e.className),...c,...l,__css:r})});yt.displayName="Text";var ko=t=>C.jsx(ue.div,{className:"chakra-stack__divider",...t,__css:{...t.__css,borderWidth:0,alignSelf:"stretch",borderColor:"inherit",width:"auto",height:"auto"}});ko.displayName="StackDivider";var Ha=t=>C.jsx(ue.div,{className:"chakra-stack__item",...t,__css:{display:"inline-block",flex:"0 0 auto",minWidth:0,...t.__css}});Ha.displayName="StackItem";function Cc(t){const{spacing:e,direction:n}=t,r={column:{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},"column-reverse":{my:e,mx:0,borderLeftWidth:0,borderBottomWidth:"1px"},row:{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0},"row-reverse":{mx:e,my:0,borderLeftWidth:"1px",borderBottomWidth:0}};return{"&":Ec(n,o=>r[o])}}var It=fe((t,e)=>{const{isInline:n,direction:r,align:o,justify:s,spacing:a="0.5rem",wrap:i,children:l,divider:c,className:u,shouldWrapChildren:f,...p}=t,d=n?"row":r??"column",w=A.useMemo(()=>Cc({spacing:a,direction:d}),[a,d]),h=!!c,y=!f&&!h,m=A.useMemo(()=>{const _=fs(l);return y?_:_.map((k,x)=>{const I=typeof k.key<"u"?k.key:x,E=x+1===_.length,D=f?C.jsx(Ha,{children:k},I):k;if(!h)return D;const R=A.cloneElement(c,{__css:w}),H=E?null:R;return C.jsxs(A.Fragment,{children:[D,H]},I)})},[c,w,h,y,f,l]),v=_e("chakra-stack",u);return C.jsx(ue.div,{ref:e,display:"flex",alignItems:o,justifyContent:s,flexDirection:d,flexWrap:i,gap:h?void 0:a,className:v,...p,children:m})});It.displayName="Stack";var Ot=fe((t,e)=>C.jsx(It,{align:"center",...t,direction:"row",ref:e}));Ot.displayName="HStack";var hs=fe(function(e,n){const r=Ur("Heading",e),{className:o,...s}=et(e);return C.jsx(ue.h2,{ref:n,className:_e("chakra-heading",e.className),...s,__css:r})});hs.displayName="Heading";var Dt=ue("div");Dt.displayName="Box";var qa=fe(function(e,n){const{size:r,centerContent:o=!0,...s}=e,a=o?{display:"flex",alignItems:"center",justifyContent:"center"}:{};return C.jsx(Dt,{ref:n,boxSize:r,__css:{...a,flexShrink:0,flexGrow:0},...s})});qa.displayName="Square";var Sc=fe(function(e,n){const{size:r,...o}=e;return C.jsx(qa,{size:r,ref:n,borderRadius:"9999px",...o})});Sc.displayName="Circle";var rn=fe(function(e,n){const{direction:r,align:o,justify:s,wrap:a,basis:i,grow:l,shrink:c,...u}=e,f={display:"flex",flexDirection:r,alignItems:o,justifyContent:s,flexWrap:a,flexBasis:i,flexGrow:l,flexShrink:c};return C.jsx(ue.div,{ref:n,__css:f,...u})});rn.displayName="Flex";function Ic(t){const{key:e}=t;return e.length===1||e.length>1&&/[^a-zA-Z0-9]/.test(e)}function Oc(t={}){const{timeout:e=300,preventDefault:n=()=>!0}=t,[r,o]=A.useState([]),s=A.useRef(),a=()=>{s.current&&(clearTimeout(s.current),s.current=null)},i=()=>{a(),s.current=setTimeout(()=>{o([]),s.current=null},e)};A.useEffect(()=>a,[]);function l(c){return u=>{if(u.key==="Backspace"){const f=[...r];f.pop(),o(f);return}if(Ic(u)){const f=r.concat(u.key);n(u)&&(u.preventDefault(),u.stopPropagation()),o(f),c(f.join("")),i()}}}return l}function Dc(t,e,n,r){if(e==null)return r;if(!r)return t.find(a=>n(a).toLowerCase().startsWith(e.toLowerCase()));const o=t.filter(s=>n(s).toLowerCase().startsWith(e.toLowerCase()));if(o.length>0){let s;return o.includes(r)?(s=o.indexOf(r)+1,s===o.length&&(s=0),o[s]):(s=t.indexOf(o[0]),t[s])}return r}function Pc(){const t=A.useRef(new Map),e=t.current,n=A.useCallback((o,s,a,i)=>{t.current.set(a,{type:s,el:o,options:i}),o.addEventListener(s,a,i)},[]),r=A.useCallback((o,s,a,i)=>{o.removeEventListener(s,a,i),t.current.delete(a)},[]);return A.useEffect(()=>()=>{e.forEach((o,s)=>{r(o.el,o.type,s,o.options)})},[r,e]),{add:n,remove:r}}function ao(t){const e=t.target,{tagName:n,isContentEditable:r}=e;return n!=="INPUT"&&n!=="TEXTAREA"&&r!==!0}function Va(t={}){const{ref:e,isDisabled:n,isFocusable:r,clickOnEnter:o=!0,clickOnSpace:s=!0,onMouseDown:a,onMouseUp:i,onClick:l,onKeyDown:c,onKeyUp:u,tabIndex:f,onMouseOver:p,onMouseLeave:d,...w}=t,[h,y]=A.useState(!0),[m,v]=A.useState(!1),_=Pc(),k=P=>{P&&P.tagName!=="BUTTON"&&y(!1)},x=h?f:f||0,I=n&&!r,E=A.useCallback(P=>{if(n){P.stopPropagation(),P.preventDefault();return}P.currentTarget.focus(),l==null||l(P)},[n,l]),N=A.useCallback(P=>{m&&ao(P)&&(P.preventDefault(),P.stopPropagation(),v(!1),_.remove(document,"keyup",N,!1))},[m,_]),D=A.useCallback(P=>{if(c==null||c(P),n||P.defaultPrevented||P.metaKey||!ao(P.nativeEvent)||h)return;const G=o&&P.key==="Enter";s&&P.key===" "&&(P.preventDefault(),v(!0)),G&&(P.preventDefault(),P.currentTarget.click()),_.add(document,"keyup",N,!1)},[n,h,c,o,s,_,N]),R=A.useCallback(P=>{if(u==null||u(P),n||P.defaultPrevented||P.metaKey||!ao(P.nativeEvent)||h)return;s&&P.key===" "&&(P.preventDefault(),v(!1),P.currentTarget.click())},[s,h,n,u]),H=A.useCallback(P=>{P.button===0&&(v(!1),_.remove(document,"mouseup",H,!1))},[_]),j=A.useCallback(P=>{if(P.button!==0)return;if(n){P.stopPropagation(),P.preventDefault();return}h||v(!0),P.currentTarget.focus({preventScroll:!0}),_.add(document,"mouseup",H,!1),a==null||a(P)},[n,h,a,_,H]),T=A.useCallback(P=>{P.button===0&&(h||v(!1),i==null||i(P))},[i,h]),b=A.useCallback(P=>{if(n){P.preventDefault();return}p==null||p(P)},[n,p]),$=A.useCallback(P=>{m&&(P.preventDefault(),v(!1)),d==null||d(P)},[m,d]),ee=Me(e,k);return h?{...w,ref:ee,type:"button","aria-disabled":I?void 0:n,disabled:I,onClick:E,onMouseDown:a,onMouseUp:i,onKeyUp:u,onKeyDown:c,onMouseOver:p,onMouseLeave:d}:{...w,ref:ee,role:"button","data-active":ot(m),"aria-disabled":n?"true":void 0,tabIndex:I?void 0:x,onClick:E,onMouseDown:j,onMouseUp:T,onKeyUp:R,onKeyDown:D,onMouseOver:b,onMouseLeave:$}}function jc(t){const e=t.current;if(!e)return!1;const n=Sl(e);return!n||e.contains(n)?!1:!!Il(n)}function Za(t,e){const{shouldFocus:n,visible:r,focusRef:o}=e,s=n&&!r;Kr(()=>{if(!s||jc(t))return;const a=(o==null?void 0:o.current)||t.current;let i;if(a)return i=requestAnimationFrame(()=>{a.focus({preventScroll:!0})}),()=>{cancelAnimationFrame(i)}},[s,t,o])}var Ac={preventScroll:!0,shouldFocus:!1};function Nc(t,e=Ac){const{focusRef:n,preventScroll:r,shouldFocus:o,visible:s}=e,a=Fc(t)?t.current:t,i=o&&s,l=A.useRef(i),c=A.useRef(s);El(()=>{!c.current&&s&&(l.current=i),c.current=s},[s,i]);const u=A.useCallback(()=>{if(!(!s||!a||!l.current)&&(l.current=!1,!a.contains(document.activeElement)))if(n!=null&&n.current)requestAnimationFrame(()=>{var f;(f=n.current)==null||f.focus({preventScroll:r})});else{const f=Cl(a);f.length>0&&requestAnimationFrame(()=>{f[0].focus({preventScroll:r})})}},[s,r,a,n]);Kr(()=>{u()},[u]),nn(a,"transitionend",u)}function Fc(t){return"current"in t}var Jt=(t,e)=>({var:t,varRef:e?`var(${t}, ${e})`:`var(${t})`}),je={arrowShadowColor:Jt("--popper-arrow-shadow-color"),arrowSize:Jt("--popper-arrow-size","8px"),arrowSizeHalf:Jt("--popper-arrow-size-half"),arrowBg:Jt("--popper-arrow-bg"),transformOrigin:Jt("--popper-transform-origin"),arrowOffset:Jt("--popper-arrow-offset")};function Rc(t){if(t.includes("top"))return"1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("bottom"))return"-1px -1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("right"))return"-1px 1px 0px 0 var(--popper-arrow-shadow-color)";if(t.includes("left"))return"1px -1px 0px 0 var(--popper-arrow-shadow-color)"}var Tc={top:"bottom center","top-start":"bottom left","top-end":"bottom right",bottom:"top center","bottom-start":"top left","bottom-end":"top right",left:"right center","left-start":"right top","left-end":"right bottom",right:"left center","right-start":"left top","right-end":"left bottom"},Bc=t=>Tc[t],Zs={scroll:!0,resize:!0};function Mc(t){let e;return typeof t=="object"?e={enabled:!0,options:{...Zs,...t}}:e={enabled:t,options:Zs},e}var zc={name:"matchWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`},effect:({state:t})=>()=>{const e=t.elements.reference;t.elements.popper.style.width=`${e.offsetWidth}px`}},Lc={name:"transformOrigin",enabled:!0,phase:"write",fn:({state:t})=>{Gs(t)},effect:({state:t})=>()=>{Gs(t)}},Gs=t=>{t.elements.popper.style.setProperty(je.transformOrigin.var,Bc(t.placement))},Wc={name:"positionArrow",enabled:!0,phase:"afterWrite",fn:({state:t})=>{Uc(t)}},Uc=t=>{var e;if(!t.placement)return;const n=Kc(t.placement);if((e=t.elements)!=null&&e.arrow&&n){Object.assign(t.elements.arrow.style,{[n.property]:n.value,width:je.arrowSize.varRef,height:je.arrowSize.varRef,zIndex:-1});const r={[je.arrowSizeHalf.var]:`calc(${je.arrowSize.varRef} / 2 - 1px)`,[je.arrowOffset.var]:`calc(${je.arrowSizeHalf.varRef} * -1)`};for(const o in r)t.elements.arrow.style.setProperty(o,r[o])}},Kc=t=>{if(t.startsWith("top"))return{property:"bottom",value:je.arrowOffset.varRef};if(t.startsWith("bottom"))return{property:"top",value:je.arrowOffset.varRef};if(t.startsWith("left"))return{property:"right",value:je.arrowOffset.varRef};if(t.startsWith("right"))return{property:"left",value:je.arrowOffset.varRef}},$c={name:"innerArrow",enabled:!0,phase:"main",requires:["arrow"],fn:({state:t})=>{Ys(t)},effect:({state:t})=>()=>{Ys(t)}},Ys=t=>{if(!t.elements.arrow)return;const e=t.elements.arrow.querySelector("[data-popper-arrow-inner]");if(!e)return;const n=Rc(t.placement);n&&e.style.setProperty("--popper-arrow-default-shadow",n),Object.assign(e.style,{transform:"rotate(45deg)",background:je.arrowBg.varRef,top:0,left:0,width:"100%",height:"100%",position:"absolute",zIndex:"inherit",boxShadow:"var(--popper-arrow-shadow, var(--popper-arrow-default-shadow))"})},Hc={"start-start":{ltr:"left-start",rtl:"right-start"},"start-end":{ltr:"left-end",rtl:"right-end"},"end-start":{ltr:"right-start",rtl:"left-start"},"end-end":{ltr:"right-end",rtl:"left-end"},start:{ltr:"left",rtl:"right"},end:{ltr:"right",rtl:"left"}},qc={"auto-start":"auto-end","auto-end":"auto-start","top-start":"top-end","top-end":"top-start","bottom-start":"bottom-end","bottom-end":"bottom-start"};function Vc(t,e="ltr"){var n,r;const o=((n=Hc[t])==null?void 0:n[e])||t;return e==="ltr"?o:(r=qc[t])!=null?r:o}var Ke="top",Je="bottom",Xe="right",$e="left",ps="auto",Kn=[Ke,Je,Xe,$e],ln="start",Nn="end",Zc="clippingParents",Ga="viewport",_n="popper",Gc="reference",Js=Kn.reduce(function(t,e){return t.concat([e+"-"+ln,e+"-"+Nn])},[]),Ya=[].concat(Kn,[ps]).reduce(function(t,e){return t.concat([e,e+"-"+ln,e+"-"+Nn])},[]),Yc="beforeRead",Jc="read",Xc="afterRead",Qc="beforeMain",eu="main",tu="afterMain",nu="beforeWrite",ru="write",ou="afterWrite",su=[Yc,Jc,Xc,Qc,eu,tu,nu,ru,ou];function ut(t){return t?(t.nodeName||"").toLowerCase():null}function qe(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ht(t){var e=qe(t).Element;return t instanceof e||t instanceof Element}function Ye(t){var e=qe(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function ms(t){if(typeof ShadowRoot>"u")return!1;var e=qe(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function au(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},s=e.elements[n];!Ye(s)||!ut(s)||(Object.assign(s.style,r),Object.keys(o).forEach(function(a){var i=o[a];i===!1?s.removeAttribute(a):s.setAttribute(a,i===!0?"":i)}))})}function iu(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],s=e.attributes[r]||{},a=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),i=a.reduce(function(l,c){return l[c]="",l},{});!Ye(o)||!ut(o)||(Object.assign(o.style,i),Object.keys(s).forEach(function(l){o.removeAttribute(l)}))})}}const lu={name:"applyStyles",enabled:!0,phase:"write",fn:au,effect:iu,requires:["computeStyles"]};function it(t){return t.split("-")[0]}var Wt=Math.max,kr=Math.min,cn=Math.round;function Eo(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ja(){return!/^((?!chrome|android).)*safari/i.test(Eo())}function un(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,s=1;e&&Ye(t)&&(o=t.offsetWidth>0&&cn(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&cn(r.height)/t.offsetHeight||1);var a=Ht(t)?qe(t):window,i=a.visualViewport,l=!Ja()&&n,c=(r.left+(l&&i?i.offsetLeft:0))/o,u=(r.top+(l&&i?i.offsetTop:0))/s,f=r.width/o,p=r.height/s;return{width:f,height:p,top:u,right:c+f,bottom:u+p,left:c,x:c,y:u}}function ys(t){var e=un(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Xa(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&ms(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function _t(t){return qe(t).getComputedStyle(t)}function cu(t){return["table","td","th"].indexOf(ut(t))>=0}function Tt(t){return((Ht(t)?t.ownerDocument:t.document)||window.document).documentElement}function Yr(t){return ut(t)==="html"?t:t.assignedSlot||t.parentNode||(ms(t)?t.host:null)||Tt(t)}function Xs(t){return!Ye(t)||_t(t).position==="fixed"?null:t.offsetParent}function uu(t){var e=/firefox/i.test(Eo()),n=/Trident/i.test(Eo());if(n&&Ye(t)){var r=_t(t);if(r.position==="fixed")return null}var o=Yr(t);for(ms(o)&&(o=o.host);Ye(o)&&["html","body"].indexOf(ut(o))<0;){var s=_t(o);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return o;o=o.parentNode}return null}function $n(t){for(var e=qe(t),n=Xs(t);n&&cu(n)&&_t(n).position==="static";)n=Xs(n);return n&&(ut(n)==="html"||ut(n)==="body"&&_t(n).position==="static")?e:n||uu(t)||e}function vs(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Cn(t,e,n){return Wt(t,kr(e,n))}function du(t,e,n){var r=Cn(t,e,n);return r>n?n:r}function Qa(){return{top:0,right:0,bottom:0,left:0}}function ei(t){return Object.assign({},Qa(),t)}function ti(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var fu=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,ei(typeof e!="number"?e:ti(e,Kn))};function hu(t){var e,n=t.state,r=t.name,o=t.options,s=n.elements.arrow,a=n.modifiersData.popperOffsets,i=it(n.placement),l=vs(i),c=[$e,Xe].indexOf(i)>=0,u=c?"height":"width";if(!(!s||!a)){var f=fu(o.padding,n),p=ys(s),d=l==="y"?Ke:$e,w=l==="y"?Je:Xe,h=n.rects.reference[u]+n.rects.reference[l]-a[l]-n.rects.popper[u],y=a[l]-n.rects.reference[l],m=$n(s),v=m?l==="y"?m.clientHeight||0:m.clientWidth||0:0,_=h/2-y/2,k=f[d],x=v-p[u]-f[w],I=v/2-p[u]/2+_,E=Cn(k,I,x),N=l;n.modifiersData[r]=(e={},e[N]=E,e.centerOffset=E-I,e)}}function pu(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||Xa(e.elements.popper,o)&&(e.elements.arrow=o))}const mu={name:"arrow",enabled:!0,phase:"main",fn:hu,effect:pu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function dn(t){return t.split("-")[1]}var yu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function vu(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:cn(n*o)/o||0,y:cn(r*o)/o||0}}function Qs(t){var e,n=t.popper,r=t.popperRect,o=t.placement,s=t.variation,a=t.offsets,i=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,f=t.isFixed,p=a.x,d=p===void 0?0:p,w=a.y,h=w===void 0?0:w,y=typeof u=="function"?u({x:d,y:h}):{x:d,y:h};d=y.x,h=y.y;var m=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),_=$e,k=Ke,x=window;if(c){var I=$n(n),E="clientHeight",N="clientWidth";if(I===qe(n)&&(I=Tt(n),_t(I).position!=="static"&&i==="absolute"&&(E="scrollHeight",N="scrollWidth")),I=I,o===Ke||(o===$e||o===Xe)&&s===Nn){k=Je;var D=f&&I===x&&x.visualViewport?x.visualViewport.height:I[E];h-=D-r.height,h*=l?1:-1}if(o===$e||(o===Ke||o===Je)&&s===Nn){_=Xe;var R=f&&I===x&&x.visualViewport?x.visualViewport.width:I[N];d-=R-r.width,d*=l?1:-1}}var H=Object.assign({position:i},c&&yu),j=u===!0?vu({x:d,y:h},qe(n)):{x:d,y:h};if(d=j.x,h=j.y,l){var T;return Object.assign({},H,(T={},T[k]=v?"0":"",T[_]=m?"0":"",T.transform=(x.devicePixelRatio||1)<=1?"translate("+d+"px, "+h+"px)":"translate3d("+d+"px, "+h+"px, 0)",T))}return Object.assign({},H,(e={},e[k]=v?h+"px":"",e[_]=m?d+"px":"",e.transform="",e))}function gu(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,s=n.adaptive,a=s===void 0?!0:s,i=n.roundOffsets,l=i===void 0?!0:i,c={placement:it(e.placement),variation:dn(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Qs(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Qs(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const wu={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:gu,data:{}};var Qn={passive:!0};function bu(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,s=o===void 0?!0:o,a=r.resize,i=a===void 0?!0:a,l=qe(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",n.update,Qn)}),i&&l.addEventListener("resize",n.update,Qn),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",n.update,Qn)}),i&&l.removeEventListener("resize",n.update,Qn)}}const _u={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:bu,data:{}};var xu={left:"right",right:"left",bottom:"top",top:"bottom"};function cr(t){return t.replace(/left|right|bottom|top/g,function(e){return xu[e]})}var ku={start:"end",end:"start"};function ea(t){return t.replace(/start|end/g,function(e){return ku[e]})}function gs(t){var e=qe(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function ws(t){return un(Tt(t)).left+gs(t).scrollLeft}function Eu(t,e){var n=qe(t),r=Tt(t),o=n.visualViewport,s=r.clientWidth,a=r.clientHeight,i=0,l=0;if(o){s=o.width,a=o.height;var c=Ja();(c||!c&&e==="fixed")&&(i=o.offsetLeft,l=o.offsetTop)}return{width:s,height:a,x:i+ws(t),y:l}}function Cu(t){var e,n=Tt(t),r=gs(t),o=(e=t.ownerDocument)==null?void 0:e.body,s=Wt(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=Wt(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),i=-r.scrollLeft+ws(t),l=-r.scrollTop;return _t(o||n).direction==="rtl"&&(i+=Wt(n.clientWidth,o?o.clientWidth:0)-s),{width:s,height:a,x:i,y:l}}function bs(t){var e=_t(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function ni(t){return["html","body","#document"].indexOf(ut(t))>=0?t.ownerDocument.body:Ye(t)&&bs(t)?t:ni(Yr(t))}function Sn(t,e){var n;e===void 0&&(e=[]);var r=ni(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),s=qe(r),a=o?[s].concat(s.visualViewport||[],bs(r)?r:[]):r,i=e.concat(a);return o?i:i.concat(Sn(Yr(a)))}function Co(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Su(t,e){var n=un(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function ta(t,e,n){return e===Ga?Co(Eu(t,n)):Ht(e)?Su(e,n):Co(Cu(Tt(t)))}function Iu(t){var e=Sn(Yr(t)),n=["absolute","fixed"].indexOf(_t(t).position)>=0,r=n&&Ye(t)?$n(t):t;return Ht(r)?e.filter(function(o){return Ht(o)&&Xa(o,r)&&ut(o)!=="body"}):[]}function Ou(t,e,n,r){var o=e==="clippingParents"?Iu(t):[].concat(e),s=[].concat(o,[n]),a=s[0],i=s.reduce(function(l,c){var u=ta(t,c,r);return l.top=Wt(u.top,l.top),l.right=kr(u.right,l.right),l.bottom=kr(u.bottom,l.bottom),l.left=Wt(u.left,l.left),l},ta(t,a,r));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function ri(t){var e=t.reference,n=t.element,r=t.placement,o=r?it(r):null,s=r?dn(r):null,a=e.x+e.width/2-n.width/2,i=e.y+e.height/2-n.height/2,l;switch(o){case Ke:l={x:a,y:e.y-n.height};break;case Je:l={x:a,y:e.y+e.height};break;case Xe:l={x:e.x+e.width,y:i};break;case $e:l={x:e.x-n.width,y:i};break;default:l={x:e.x,y:e.y}}var c=o?vs(o):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case ln:l[c]=l[c]-(e[u]/2-n[u]/2);break;case Nn:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function Fn(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,s=n.strategy,a=s===void 0?t.strategy:s,i=n.boundary,l=i===void 0?Zc:i,c=n.rootBoundary,u=c===void 0?Ga:c,f=n.elementContext,p=f===void 0?_n:f,d=n.altBoundary,w=d===void 0?!1:d,h=n.padding,y=h===void 0?0:h,m=ei(typeof y!="number"?y:ti(y,Kn)),v=p===_n?Gc:_n,_=t.rects.popper,k=t.elements[w?v:p],x=Ou(Ht(k)?k:k.contextElement||Tt(t.elements.popper),l,u,a),I=un(t.elements.reference),E=ri({reference:I,element:_,strategy:"absolute",placement:o}),N=Co(Object.assign({},_,E)),D=p===_n?N:I,R={top:x.top-D.top+m.top,bottom:D.bottom-x.bottom+m.bottom,left:x.left-D.left+m.left,right:D.right-x.right+m.right},H=t.modifiersData.offset;if(p===_n&&H){var j=H[o];Object.keys(R).forEach(function(T){var b=[Xe,Je].indexOf(T)>=0?1:-1,$=[Ke,Je].indexOf(T)>=0?"y":"x";R[T]+=j[$]*b})}return R}function Du(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,s=n.rootBoundary,a=n.padding,i=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?Ya:l,u=dn(r),f=u?i?Js:Js.filter(function(w){return dn(w)===u}):Kn,p=f.filter(function(w){return c.indexOf(w)>=0});p.length===0&&(p=f);var d=p.reduce(function(w,h){return w[h]=Fn(t,{placement:h,boundary:o,rootBoundary:s,padding:a})[it(h)],w},{});return Object.keys(d).sort(function(w,h){return d[w]-d[h]})}function Pu(t){if(it(t)===ps)return[];var e=cr(t);return[ea(t),e,ea(e)]}function ju(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,s=o===void 0?!0:o,a=n.altAxis,i=a===void 0?!0:a,l=n.fallbackPlacements,c=n.padding,u=n.boundary,f=n.rootBoundary,p=n.altBoundary,d=n.flipVariations,w=d===void 0?!0:d,h=n.allowedAutoPlacements,y=e.options.placement,m=it(y),v=m===y,_=l||(v||!w?[cr(y)]:Pu(y)),k=[y].concat(_).reduce(function(X,Z){return X.concat(it(Z)===ps?Du(e,{placement:Z,boundary:u,rootBoundary:f,padding:c,flipVariations:w,allowedAutoPlacements:h}):Z)},[]),x=e.rects.reference,I=e.rects.popper,E=new Map,N=!0,D=k[0],R=0;R<k.length;R++){var H=k[R],j=it(H),T=dn(H)===ln,b=[Ke,Je].indexOf(j)>=0,$=b?"width":"height",ee=Fn(e,{placement:H,boundary:u,rootBoundary:f,altBoundary:p,padding:c}),P=b?T?Xe:$e:T?Je:Ke;x[$]>I[$]&&(P=cr(P));var G=cr(P),L=[];if(s&&L.push(ee[j]<=0),i&&L.push(ee[P]<=0,ee[G]<=0),L.every(function(X){return X})){D=H,N=!1;break}E.set(H,L)}if(N)for(var J=w?3:1,M=function(Z){var me=k.find(function(ge){var ie=E.get(ge);if(ie)return ie.slice(0,Z).every(function(ce){return ce})});if(me)return D=me,"break"},B=J;B>0;B--){var ne=M(B);if(ne==="break")break}e.placement!==D&&(e.modifiersData[r]._skip=!0,e.placement=D,e.reset=!0)}}const Au={name:"flip",enabled:!0,phase:"main",fn:ju,requiresIfExists:["offset"],data:{_skip:!1}};function na(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function ra(t){return[Ke,Xe,Je,$e].some(function(e){return t[e]>=0})}function Nu(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,s=e.modifiersData.preventOverflow,a=Fn(e,{elementContext:"reference"}),i=Fn(e,{altBoundary:!0}),l=na(a,r),c=na(i,o,s),u=ra(l),f=ra(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":f})}const Fu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Nu};function Ru(t,e,n){var r=it(t),o=[$e,Ke].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,a=s[0],i=s[1];return a=a||0,i=(i||0)*o,[$e,Xe].indexOf(r)>=0?{x:i,y:a}:{x:a,y:i}}function Tu(t){var e=t.state,n=t.options,r=t.name,o=n.offset,s=o===void 0?[0,0]:o,a=Ya.reduce(function(u,f){return u[f]=Ru(f,e.rects,s),u},{}),i=a[e.placement],l=i.x,c=i.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=a}const Bu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Tu};function Mu(t){var e=t.state,n=t.name;e.modifiersData[n]=ri({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const zu={name:"popperOffsets",enabled:!0,phase:"read",fn:Mu,data:{}};function Lu(t){return t==="x"?"y":"x"}function Wu(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,s=o===void 0?!0:o,a=n.altAxis,i=a===void 0?!1:a,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,f=n.padding,p=n.tether,d=p===void 0?!0:p,w=n.tetherOffset,h=w===void 0?0:w,y=Fn(e,{boundary:l,rootBoundary:c,padding:f,altBoundary:u}),m=it(e.placement),v=dn(e.placement),_=!v,k=vs(m),x=Lu(k),I=e.modifiersData.popperOffsets,E=e.rects.reference,N=e.rects.popper,D=typeof h=="function"?h(Object.assign({},e.rects,{placement:e.placement})):h,R=typeof D=="number"?{mainAxis:D,altAxis:D}:Object.assign({mainAxis:0,altAxis:0},D),H=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,j={x:0,y:0};if(I){if(s){var T,b=k==="y"?Ke:$e,$=k==="y"?Je:Xe,ee=k==="y"?"height":"width",P=I[k],G=P+y[b],L=P-y[$],J=d?-N[ee]/2:0,M=v===ln?E[ee]:N[ee],B=v===ln?-N[ee]:-E[ee],ne=e.elements.arrow,X=d&&ne?ys(ne):{width:0,height:0},Z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Qa(),me=Z[b],ge=Z[$],ie=Cn(0,E[ee],X[ee]),ce=_?E[ee]/2-J-ie-me-R.mainAxis:M-ie-me-R.mainAxis,be=_?-E[ee]/2+J+ie+ge+R.mainAxis:B+ie+ge+R.mainAxis,ye=e.elements.arrow&&$n(e.elements.arrow),pe=ye?k==="y"?ye.clientTop||0:ye.clientLeft||0:0,xe=(T=H==null?void 0:H[k])!=null?T:0,g=P+ce-xe-pe,U=P+be-xe,W=Cn(d?kr(G,g):G,P,d?Wt(L,U):L);I[k]=W,j[k]=W-P}if(i){var O,S=k==="x"?Ke:$e,F=k==="x"?Je:Xe,q=I[x],Y=x==="y"?"height":"width",z=q+y[S],Q=q-y[F],re=[Ke,$e].indexOf(m)!==-1,te=(O=H==null?void 0:H[x])!=null?O:0,se=re?z:q-E[Y]-N[Y]-te+R.altAxis,ve=re?q+E[Y]+N[Y]-te-R.altAxis:Q,he=d&&re?du(se,q,ve):Cn(d?se:z,q,d?ve:Q);I[x]=he,j[x]=he-q}e.modifiersData[r]=j}}const Uu={name:"preventOverflow",enabled:!0,phase:"main",fn:Wu,requiresIfExists:["offset"]};function Ku(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function $u(t){return t===qe(t)||!Ye(t)?gs(t):Ku(t)}function Hu(t){var e=t.getBoundingClientRect(),n=cn(e.width)/t.offsetWidth||1,r=cn(e.height)/t.offsetHeight||1;return n!==1||r!==1}function qu(t,e,n){n===void 0&&(n=!1);var r=Ye(e),o=Ye(e)&&Hu(e),s=Tt(e),a=un(t,o,n),i={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((ut(e)!=="body"||bs(s))&&(i=$u(e)),Ye(e)?(l=un(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=ws(s))),{x:a.left+i.scrollLeft-l.x,y:a.top+i.scrollTop-l.y,width:a.width,height:a.height}}function Vu(t){var e=new Map,n=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function o(s){n.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(i){if(!n.has(i)){var l=e.get(i);l&&o(l)}}),r.push(s)}return t.forEach(function(s){n.has(s.name)||o(s)}),r}function Zu(t){var e=Vu(t);return su.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function Gu(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function Yu(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var oa={placement:"bottom",modifiers:[],strategy:"absolute"};function sa(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Ju(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,s=o===void 0?oa:o;return function(i,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},oa,s),modifiersData:{},elements:{reference:i,popper:l},attributes:{},styles:{}},f=[],p=!1,d={state:u,setOptions:function(m){var v=typeof m=="function"?m(u.options):m;h(),u.options=Object.assign({},s,u.options,v),u.scrollParents={reference:Ht(i)?Sn(i):i.contextElement?Sn(i.contextElement):[],popper:Sn(l)};var _=Zu(Yu([].concat(r,u.options.modifiers)));return u.orderedModifiers=_.filter(function(k){return k.enabled}),w(),d.update()},forceUpdate:function(){if(!p){var m=u.elements,v=m.reference,_=m.popper;if(sa(v,_)){u.rects={reference:qu(v,$n(_),u.options.strategy==="fixed"),popper:ys(_)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(R){return u.modifiersData[R.name]=Object.assign({},R.data)});for(var k=0;k<u.orderedModifiers.length;k++){if(u.reset===!0){u.reset=!1,k=-1;continue}var x=u.orderedModifiers[k],I=x.fn,E=x.options,N=E===void 0?{}:E,D=x.name;typeof I=="function"&&(u=I({state:u,options:N,name:D,instance:d})||u)}}}},update:Gu(function(){return new Promise(function(y){d.forceUpdate(),y(u)})}),destroy:function(){h(),p=!0}};if(!sa(i,l))return d;d.setOptions(c).then(function(y){!p&&c.onFirstUpdate&&c.onFirstUpdate(y)});function w(){u.orderedModifiers.forEach(function(y){var m=y.name,v=y.options,_=v===void 0?{}:v,k=y.effect;if(typeof k=="function"){var x=k({state:u,name:m,instance:d,options:_}),I=function(){};f.push(x||I)}})}function h(){f.forEach(function(y){return y()}),f=[]}return d}}var Xu=[_u,zu,wu,lu,Bu,Au,Uu,mu,Fu],Qu=Ju({defaultModifiers:Xu});function _s(t={}){const{enabled:e=!0,modifiers:n,placement:r="bottom",strategy:o="absolute",arrowPadding:s=8,eventListeners:a=!0,offset:i,gutter:l=8,flip:c=!0,boundary:u="clippingParents",preventOverflow:f=!0,matchWidth:p,direction:d="ltr"}=t,w=A.useRef(null),h=A.useRef(null),y=A.useRef(null),m=Vc(r,d),v=A.useRef(()=>{}),_=A.useCallback(()=>{var R;!e||!w.current||!h.current||((R=v.current)==null||R.call(v),y.current=Qu(w.current,h.current,{placement:m,modifiers:[$c,Wc,Lc,{...zc,enabled:!!p},{name:"eventListeners",...Mc(a)},{name:"arrow",options:{padding:s}},{name:"offset",options:{offset:i??[0,l]}},{name:"flip",enabled:!!c,options:{padding:8}},{name:"preventOverflow",enabled:!!f,options:{boundary:u}},...n??[]],strategy:o}),y.current.forceUpdate(),v.current=y.current.destroy)},[m,e,n,p,a,s,i,l,c,f,u,o]);A.useEffect(()=>()=>{var R;!w.current&&!h.current&&((R=y.current)==null||R.destroy(),y.current=null)},[]);const k=A.useCallback(R=>{w.current=R,_()},[_]),x=A.useCallback((R={},H=null)=>({...R,ref:Me(k,H)}),[k]),I=A.useCallback(R=>{h.current=R,_()},[_]),E=A.useCallback((R={},H=null)=>({...R,ref:Me(I,H),style:{...R.style,position:o,minWidth:p?void 0:"max-content",inset:"0 auto auto 0"}}),[o,I,p]),N=A.useCallback((R={},H=null)=>{const{size:j,shadowColor:T,bg:b,style:$,...ee}=R;return{...ee,ref:H,"data-popper-arrow":"",style:ed(R)}},[]),D=A.useCallback((R={},H=null)=>({...R,ref:H,"data-popper-arrow-inner":""}),[]);return{update(){var R;(R=y.current)==null||R.update()},forceUpdate(){var R;(R=y.current)==null||R.forceUpdate()},transformOrigin:je.transformOrigin.varRef,referenceRef:k,popperRef:I,getPopperProps:E,getArrowProps:N,getArrowInnerProps:D,getReferenceProps:x}}function ed(t){const{size:e,shadowColor:n,bg:r,style:o}=t,s={...o,position:"absolute"};return e&&(s["--popper-arrow-size"]=e),n&&(s["--popper-arrow-shadow-color"]=n),r&&(s["--popper-arrow-bg"]=r),s}function xs(t={}){const{onClose:e,onOpen:n,isOpen:r,id:o}=t,s=Lt(n),a=Lt(e),[i,l]=A.useState(t.defaultIsOpen||!1),c=r!==void 0?r:i,u=r!==void 0,f=A.useId(),p=o??`disclosure-${f}`,d=A.useCallback(()=>{u||l(!1),a==null||a()},[u,a]),w=A.useCallback(()=>{u||l(!0),s==null||s()},[u,s]),h=A.useCallback(()=>{c?d():w()},[c,w,d]);function y(v={}){return{...v,"aria-expanded":c,"aria-controls":p,onClick(_){var k;(k=v.onClick)==null||k.call(v,_),h()}}}function m(v={}){return{...v,hidden:!c,id:p}}return{isOpen:c,onOpen:w,onClose:d,onToggle:h,isControlled:u,getButtonProps:y,getDisclosureProps:m}}function td(t){const{ref:e,handler:n,enabled:r=!0}=t,o=Lt(n),a=A.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}).current;A.useEffect(()=>{if(!r)return;const i=f=>{io(f,e)&&(a.isPointerDown=!0)},l=f=>{if(a.ignoreEmulatedMouseEvents){a.ignoreEmulatedMouseEvents=!1;return}a.isPointerDown&&n&&io(f,e)&&(a.isPointerDown=!1,o(f))},c=f=>{a.ignoreEmulatedMouseEvents=!0,n&&a.isPointerDown&&io(f,e)&&(a.isPointerDown=!1,o(f))},u=oi(e.current);return u.addEventListener("mousedown",i,!0),u.addEventListener("mouseup",l,!0),u.addEventListener("touchstart",i,!0),u.addEventListener("touchend",c,!0),()=>{u.removeEventListener("mousedown",i,!0),u.removeEventListener("mouseup",l,!0),u.removeEventListener("touchstart",i,!0),u.removeEventListener("touchend",c,!0)}},[n,e,o,a,r])}function io(t,e){var n;const r=t.target;return r&&!oi(r).contains(r)?!1:!((n=e.current)!=null&&n.contains(r))}function oi(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function si(t){const{isOpen:e,ref:n}=t,[r,o]=A.useState(e),[s,a]=A.useState(!1);return A.useEffect(()=>{s||(o(e),a(!0))},[e,s,r]),nn(()=>n.current,"animationend",()=>{o(e)}),{present:!(e?!1:!r),onComplete(){var l;const c=Ol(n.current),u=new c.CustomEvent("animationend",{bubbles:!0});(l=n.current)==null||l.dispatchEvent(u)}}}function ks(t){const{wasSelected:e,enabled:n,isSelected:r,mode:o="unmount"}=t;return!!(!n||r||o==="keepMounted"&&e)}var[nd,rd,od,sd]=Fa(),[ad,Hn]=Qe({strict:!1,name:"MenuContext"});function id(t,...e){const n=A.useId(),r=t||n;return A.useMemo(()=>e.map(o=>`${o}-${r}`),[r,e])}function ai(t){var e;return(e=t==null?void 0:t.ownerDocument)!=null?e:document}function aa(t){return ai(t).activeElement===t}function ld(t={}){const{id:e,closeOnSelect:n=!0,closeOnBlur:r=!0,initialFocusRef:o,autoSelect:s=!0,isLazy:a,isOpen:i,defaultIsOpen:l,onClose:c,onOpen:u,placement:f="bottom-start",lazyBehavior:p="unmount",direction:d,computePositionOnMount:w=!1,...h}=t,y=A.useRef(null),m=A.useRef(null),v=od(),_=A.useCallback(()=>{requestAnimationFrame(()=>{var ne;(ne=y.current)==null||ne.focus({preventScroll:!1})})},[]),k=A.useCallback(()=>{const ne=setTimeout(()=>{var X;if(o)(X=o.current)==null||X.focus();else{const Z=v.firstEnabled();Z&&T(Z.index)}});G.current.add(ne)},[v,o]),x=A.useCallback(()=>{const ne=setTimeout(()=>{const X=v.lastEnabled();X&&T(X.index)});G.current.add(ne)},[v]),I=A.useCallback(()=>{u==null||u(),s?k():_()},[s,k,_,u]),{isOpen:E,onOpen:N,onClose:D,onToggle:R}=xs({isOpen:i,defaultIsOpen:l,onClose:c,onOpen:I});td({enabled:E&&r,ref:y,handler:ne=>{var X;(X=m.current)!=null&&X.contains(ne.target)||D()}});const H=_s({...h,enabled:E||w,placement:f,direction:d}),[j,T]=A.useState(-1);Kr(()=>{E||T(-1)},[E]),Za(y,{focusRef:m,visible:E,shouldFocus:!0});const b=si({isOpen:E,ref:y}),[$,ee]=id(e,"menu-button","menu-list"),P=A.useCallback(()=>{N(),_()},[N,_]),G=A.useRef(new Set([]));A.useEffect(()=>{const ne=G.current;return()=>{ne.forEach(X=>clearTimeout(X)),ne.clear()}},[]);const L=A.useCallback(()=>{N(),k()},[k,N]),J=A.useCallback(()=>{N(),x()},[N,x]),M=A.useCallback(()=>{var ne,X;const Z=ai(y.current),me=(ne=y.current)==null?void 0:ne.contains(Z.activeElement);if(!(E&&!me))return;const ie=(X=v.item(j))==null?void 0:X.node;ie==null||ie.focus({preventScroll:!0})},[E,j,v]),B=A.useRef(null);return{openAndFocusMenu:P,openAndFocusFirstItem:L,openAndFocusLastItem:J,onTransitionEnd:M,unstable__animationState:b,descendants:v,popper:H,buttonId:$,menuId:ee,forceUpdate:H.forceUpdate,orientation:"vertical",isOpen:E,onToggle:R,onOpen:N,onClose:D,menuRef:y,buttonRef:m,focusedIndex:j,closeOnSelect:n,closeOnBlur:r,autoSelect:s,setFocusedIndex:T,isLazy:a,lazyBehavior:p,initialFocusRef:o,rafId:B}}function hp(t={},e=null){const n=Hn(),{onToggle:r,popper:o,openAndFocusFirstItem:s,openAndFocusLastItem:a}=n,i=A.useCallback(l=>{const c=l.key,f={Enter:s,ArrowDown:s,ArrowUp:a}[c];f&&(l.preventDefault(),l.stopPropagation(),f(l))},[s,a]);return{...t,ref:Me(n.buttonRef,e,o.referenceRef),id:n.buttonId,"data-active":ot(n.isOpen),"aria-expanded":n.isOpen,"aria-haspopup":"menu","aria-controls":n.menuId,onClick:Ie(t.onClick,r),onKeyDown:Ie(t.onKeyDown,i)}}function So(t){var e;return dd(t)&&!!((e=t==null?void 0:t.getAttribute("role"))!=null&&e.startsWith("menuitem"))}function cd(t={},e=null){const n=Hn();if(!n)throw new Error("useMenuContext: context is undefined. Seems you forgot to wrap component within <Menu>");const{focusedIndex:r,setFocusedIndex:o,menuRef:s,isOpen:a,onClose:i,menuId:l,isLazy:c,lazyBehavior:u,unstable__animationState:f}=n,p=rd(),d=Oc({preventDefault:m=>m.key!==" "&&So(m.target)}),w=A.useCallback(m=>{if(!m.currentTarget.contains(m.target))return;const v=m.key,k={Tab:I=>I.preventDefault(),Escape:i,ArrowDown:()=>{const I=p.nextEnabled(r);I&&o(I.index)},ArrowUp:()=>{const I=p.prevEnabled(r);I&&o(I.index)}}[v];if(k){m.preventDefault(),k(m);return}const x=d(I=>{const E=Dc(p.values(),I,N=>{var D,R;return(R=(D=N==null?void 0:N.node)==null?void 0:D.textContent)!=null?R:""},p.item(r));if(E){const N=p.indexOf(E.node);o(N)}});So(m.target)&&x(m)},[p,r,d,i,o]),h=A.useRef(!1);a&&(h.current=!0);const y=ks({wasSelected:h.current,enabled:c,mode:u,isSelected:f.present});return{...t,ref:Me(s,e),children:y?t.children:null,tabIndex:-1,role:"menu",id:l,style:{...t.style,transformOrigin:"var(--popper-transform-origin)"},"aria-orientation":"vertical",onKeyDown:Ie(t.onKeyDown,w)}}function ud(t={}){const{popper:e,isOpen:n}=Hn();return e.getPopperProps({...t,style:{visibility:n?"visible":"hidden",...t.style}})}function ii(t={},e=null){const{onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onClick:s,onFocus:a,isDisabled:i,isFocusable:l,closeOnSelect:c,type:u,...f}=t,p=Hn(),{setFocusedIndex:d,focusedIndex:w,closeOnSelect:h,onClose:y,menuRef:m,isOpen:v,menuId:_,rafId:k}=p,x=A.useRef(null),I=`${_}-menuitem-${A.useId()}`,{index:E,register:N}=sd({disabled:i&&!l}),D=A.useCallback(P=>{n==null||n(P),!i&&d(E)},[d,E,i,n]),R=A.useCallback(P=>{r==null||r(P),x.current&&!aa(x.current)&&D(P)},[D,r]),H=A.useCallback(P=>{o==null||o(P),!i&&d(-1)},[d,i,o]),j=A.useCallback(P=>{s==null||s(P),So(P.currentTarget)&&(c??h)&&y()},[y,s,h,c]),T=A.useCallback(P=>{a==null||a(P),d(E)},[d,a,E]),b=E===w,$=i&&!l;Kr(()=>{if(v)return b&&!$&&x.current?(k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(()=>{var P;(P=x.current)==null||P.focus({preventScroll:!0}),k.current=null})):m.current&&!aa(m.current)&&m.current.focus({preventScroll:!0}),()=>{k.current&&cancelAnimationFrame(k.current)}},[b,$,m,v]);const ee=Va({onClick:j,onFocus:T,onMouseEnter:D,onMouseMove:R,onMouseLeave:H,ref:Me(N,x,e),isDisabled:i,isFocusable:l});return{...f,...ee,type:u??ee.type,id:I,role:"menuitem",tabIndex:b?0:-1}}function pp(t={},e=null){const{type:n="radio",isChecked:r,...o}=t;return{...ii(o,e),role:`menuitem${n}`,"aria-checked":r}}function mp(t={}){const{children:e,type:n="radio",value:r,defaultValue:o,onChange:s,...a}=t,l=n==="radio"?"":[],[c,u]=Ra({defaultValue:o??l,value:r,onChange:s}),f=A.useCallback(w=>{if(n==="radio"&&typeof c=="string"&&u(w),n==="checkbox"&&Array.isArray(c)){const h=c.includes(w)?c.filter(y=>y!==w):c.concat(w);u(h)}},[c,u,n]),d=fs(e).map(w=>{if(w.type.id!=="MenuItemOption")return w;const h=m=>{var v,_;f(w.props.value),(_=(v=w.props).onClick)==null||_.call(v,m)},y=n==="radio"?w.props.value===c:c.includes(w.props.value);return A.cloneElement(w,{type:n,onClick:h,isChecked:y})});return{...a,children:d}}function dd(t){var e;if(!fd(t))return!1;const n=(e=t.ownerDocument.defaultView)!=null?e:window;return t instanceof n.HTMLElement}function fd(t){return t!=null&&typeof t=="object"&&"nodeType"in t&&t.nodeType===Node.ELEMENT_NODE}var[hd,Jr]=Qe({name:"MenuStylesContext",errorMessage:`useMenuStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Menu />" `}),Es=t=>{const{children:e}=t,n=Rt("Menu",t),r=et(t),{direction:o}=is(),{descendants:s,...a}=ld({...r,direction:o}),i=A.useMemo(()=>a,[a]),{isOpen:l,onClose:c,forceUpdate:u}=i;return C.jsx(nd,{value:s,children:C.jsx(ad,{value:i,children:C.jsx(hd,{value:n,children:Ca(e,{isOpen:l,onClose:c,forceUpdate:u})})})})};Es.displayName="Menu";var li=fe((t,e)=>{const n=Jr();return C.jsx(ue.span,{ref:e,...t,__css:n.command,className:"chakra-menu__command"})});li.displayName="MenuCommand";var pd=fe((t,e)=>{const{type:n,...r}=t,o=Jr(),s=r.as||n?n??void 0:"button",a=A.useMemo(()=>({textDecoration:"none",color:"inherit",userSelect:"none",display:"flex",width:"100%",alignItems:"center",textAlign:"start",flex:"0 0 auto",outline:0,...o.item}),[o.item]);return C.jsx(ue.button,{ref:e,type:s,...r,__css:a})}),ci=t=>{const{className:e,children:n,...r}=t,o=Jr(),s=A.Children.only(n),a=A.isValidElement(s)?A.cloneElement(s,{focusable:"false","aria-hidden":!0,className:_e("chakra-menu__icon",s.props.className)}):null,i=_e("chakra-menu__icon-wrapper",e);return C.jsx(ue.span,{className:i,...r,__css:o.icon,children:a})};ci.displayName="MenuIcon";var pt=fe((t,e)=>{const{icon:n,iconSpacing:r="0.75rem",command:o,commandSpacing:s="0.75rem",children:a,...i}=t,l=ii(i,e),u=n||o?C.jsx("span",{style:{pointerEvents:"none",flex:1},children:a}):a;return C.jsxs(pd,{...l,className:_e("chakra-menu__menuitem",l.className),children:[n&&C.jsx(ci,{fontSize:"0.8em",marginEnd:r,children:n}),u,o&&C.jsx(li,{marginStart:s,children:o})]})});pt.displayName="MenuItem";var md={enter:{visibility:"visible",opacity:1,scale:1,transition:{duration:.2,ease:[.4,0,.2,1]}},exit:{transitionEnd:{visibility:"hidden"},opacity:0,scale:.8,transition:{duration:.1,easings:"easeOut"}}},yd=ue(ls.div),Cs=fe(function(e,n){var r,o;const{rootProps:s,motionProps:a,...i}=e,{isOpen:l,onTransitionEnd:c,unstable__animationState:u}=Hn(),f=cd(i,n),p=ud(s),d=Jr();return C.jsx(ue.div,{...p,__css:{zIndex:(o=e.zIndex)!=null?o:(r=d.list)==null?void 0:r.zIndex},children:C.jsx(yd,{variants:md,initial:!1,animate:l?"enter":"exit",__css:{outline:0,...d.list},...a,className:_e("chakra-menu__menu-list",f.className),...f,onUpdate:c,onAnimationComplete:Sa(u.onComplete,f.onAnimationComplete)})})});Cs.displayName="MenuList";var[vd,qn]=Qe({name:"PopoverContext",errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),[gd,Ss]=Qe({name:"PopoverStylesContext",errorMessage:`usePopoverStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Popover />" `});function ui(t){const e=A.Children.only(t.children),{getTriggerProps:n}=qn();return A.cloneElement(e,n(e.props,e.ref))}ui.displayName="PopoverTrigger";var Xt={click:"click",hover:"hover"};function wd(t={}){const{closeOnBlur:e=!0,closeOnEsc:n=!0,initialFocusRef:r,id:o,returnFocusOnClose:s=!0,autoFocus:a=!0,arrowSize:i,arrowShadowColor:l,trigger:c=Xt.click,openDelay:u=200,closeDelay:f=200,isLazy:p,lazyBehavior:d="unmount",computePositionOnMount:w,...h}=t,{isOpen:y,onClose:m,onOpen:v,onToggle:_}=xs(t),k=A.useRef(null),x=A.useRef(null),I=A.useRef(null),E=A.useRef(!1),N=A.useRef(!1);y&&(N.current=!0);const[D,R]=A.useState(!1),[H,j]=A.useState(!1),T=A.useId(),b=o??T,[$,ee,P,G]=["popover-trigger","popover-content","popover-header","popover-body"].map(U=>`${U}-${b}`),{referenceRef:L,getArrowProps:J,getPopperProps:M,getArrowInnerProps:B,forceUpdate:ne}=_s({...h,enabled:y||!!w}),X=si({isOpen:y,ref:I});dc({enabled:y,ref:x}),Za(I,{focusRef:x,visible:y,shouldFocus:s&&c===Xt.click}),Nc(I,{focusRef:r,visible:y,shouldFocus:a&&c===Xt.click});const Z=ks({wasSelected:N.current,enabled:p,mode:d,isSelected:X.present}),me=A.useCallback((U={},W=null)=>{const O={...U,style:{...U.style,transformOrigin:je.transformOrigin.varRef,[je.arrowSize.var]:i?`${i}px`:void 0,[je.arrowShadowColor.var]:l},ref:Me(I,W),children:Z?U.children:null,id:ee,tabIndex:-1,role:"dialog",onKeyDown:Ie(U.onKeyDown,S=>{n&&S.key==="Escape"&&m()}),onBlur:Ie(U.onBlur,S=>{const F=ia(S),q=lo(I.current,F),Y=lo(x.current,F);y&&e&&(!q&&!Y)&&m()}),"aria-labelledby":D?P:void 0,"aria-describedby":H?G:void 0};return c===Xt.hover&&(O.role="tooltip",O.onMouseEnter=Ie(U.onMouseEnter,()=>{E.current=!0}),O.onMouseLeave=Ie(U.onMouseLeave,S=>{S.nativeEvent.relatedTarget!==null&&(E.current=!1,setTimeout(()=>m(),f))})),O},[Z,ee,D,P,H,G,c,n,m,y,e,f,l,i]),ge=A.useCallback((U={},W=null)=>M({...U,style:{visibility:y?"visible":"hidden",...U.style}},W),[y,M]),ie=A.useCallback((U,W=null)=>({...U,ref:Me(W,k,L)}),[k,L]),ce=A.useRef(),be=A.useRef(),ye=A.useCallback(U=>{k.current==null&&L(U)},[L]),pe=A.useCallback((U={},W=null)=>{const O={...U,ref:Me(x,W,ye),id:$,"aria-haspopup":"dialog","aria-expanded":y,"aria-controls":ee};return c===Xt.click&&(O.onClick=Ie(U.onClick,_)),c===Xt.hover&&(O.onFocus=Ie(U.onFocus,()=>{ce.current===void 0&&v()}),O.onBlur=Ie(U.onBlur,S=>{const F=ia(S),q=!lo(I.current,F);y&&e&&q&&m()}),O.onKeyDown=Ie(U.onKeyDown,S=>{S.key==="Escape"&&m()}),O.onMouseEnter=Ie(U.onMouseEnter,()=>{E.current=!0,ce.current=window.setTimeout(()=>v(),u)}),O.onMouseLeave=Ie(U.onMouseLeave,()=>{E.current=!1,ce.current&&(clearTimeout(ce.current),ce.current=void 0),be.current=window.setTimeout(()=>{E.current===!1&&m()},f)})),O},[$,y,ee,c,ye,_,v,e,m,u,f]);A.useEffect(()=>()=>{ce.current&&clearTimeout(ce.current),be.current&&clearTimeout(be.current)},[]);const xe=A.useCallback((U={},W=null)=>({...U,id:P,ref:Me(W,O=>{R(!!O)})}),[P]),g=A.useCallback((U={},W=null)=>({...U,id:G,ref:Me(W,O=>{j(!!O)})}),[G]);return{forceUpdate:ne,isOpen:y,onAnimationComplete:X.onComplete,onClose:m,getAnchorProps:ie,getArrowProps:J,getArrowInnerProps:B,getPopoverPositionerProps:ge,getPopoverProps:me,getTriggerProps:pe,getHeaderProps:xe,getBodyProps:g}}function lo(t,e){return t===e||(t==null?void 0:t.contains(e))}function ia(t){var e;const n=t.currentTarget.ownerDocument.activeElement;return(e=t.relatedTarget)!=null?e:n}function di(t){const e=Rt("Popover",t),{children:n,...r}=et(t),o=is(),s=wd({...r,direction:o.direction});return C.jsx(vd,{value:s,children:C.jsx(gd,{value:e,children:Ca(n,{isOpen:s.isOpen,onClose:s.onClose,forceUpdate:s.forceUpdate})})})}di.displayName="Popover";var fi=fe(function(e,n){const{getBodyProps:r}=qn(),o=Ss();return C.jsx(ue.div,{...r(e,n),className:_e("chakra-popover__body",e.className),__css:o.body})});fi.displayName="PopoverBody";var hi=fe(function(e,n){const{onClose:r}=qn(),o=Ss();return C.jsx(Dl,{size:"sm",onClick:r,className:_e("chakra-popover__close-btn",e.className),__css:o.closeButton,ref:n,...e})});hi.displayName="PopoverCloseButton";function bd(t){if(t)return{enter:{...t.enter,visibility:"visible"},exit:{...t.exit,transitionEnd:{visibility:"hidden"}}}}var _d={exit:{opacity:0,scale:.95,transition:{duration:.1,ease:[.4,0,1,1]}},enter:{scale:1,opacity:1,transition:{duration:.15,ease:[0,0,.2,1]}}},xd=ue(ls.section),pi=fe(function(e,n){const{variants:r=_d,...o}=e,{isOpen:s}=qn();return C.jsx(xd,{ref:n,variants:bd(r),initial:!1,animate:s?"enter":"exit",...o})});pi.displayName="PopoverTransition";var mi=fe(function(e,n){const{rootProps:r,motionProps:o,...s}=e,{getPopoverProps:a,getPopoverPositionerProps:i,onAnimationComplete:l}=qn(),c=Ss(),u={position:"relative",display:"flex",flexDirection:"column",...c.content};return C.jsx(ue.div,{...i(r),__css:c.popper,className:"chakra-popover__popper",children:C.jsx(pi,{...o,...a(s,n),onAnimationComplete:Sa(l,s.onAnimationComplete),className:_e("chakra-popover__content",e.className),__css:u})})});mi.displayName="PopoverContent";var[kd,Ed,Cd,Sd]=Fa();function Id(t){var e;const{defaultIndex:n,onChange:r,index:o,isManual:s,isLazy:a,lazyBehavior:i="unmount",orientation:l="horizontal",direction:c="ltr",...u}=t,[f,p]=A.useState(n??0),[d,w]=Ra({defaultValue:n??0,value:o,onChange:r});A.useEffect(()=>{o!=null&&p(o)},[o]);const h=Cd(),y=A.useId();return{id:`tabs-${(e=t.id)!=null?e:y}`,selectedIndex:d,focusedIndex:f,setSelectedIndex:w,setFocusedIndex:p,isManual:s,isLazy:a,lazyBehavior:i,orientation:l,descendants:h,direction:c,htmlProps:u}}var[Od,Xr]=Qe({name:"TabsContext",errorMessage:"useTabsContext: `context` is undefined. Seems you forgot to wrap all tabs components within <Tabs />"});function Dd(t){const{focusedIndex:e,orientation:n,direction:r}=Xr(),o=Ed(),s=A.useCallback(a=>{const i=()=>{var v;const _=o.nextEnabled(e);_&&((v=_.node)==null||v.focus())},l=()=>{var v;const _=o.prevEnabled(e);_&&((v=_.node)==null||v.focus())},c=()=>{var v;const _=o.firstEnabled();_&&((v=_.node)==null||v.focus())},u=()=>{var v;const _=o.lastEnabled();_&&((v=_.node)==null||v.focus())},f=n==="horizontal",p=n==="vertical",d=a.key,w=r==="ltr"?"ArrowLeft":"ArrowRight",h=r==="ltr"?"ArrowRight":"ArrowLeft",m={[w]:()=>f&&l(),[h]:()=>f&&i(),ArrowDown:()=>p&&i(),ArrowUp:()=>p&&l(),Home:c,End:u}[d];m&&(a.preventDefault(),m(a))},[o,e,n,r]);return{...t,role:"tablist","aria-orientation":n,onKeyDown:Ie(t.onKeyDown,s)}}function Pd(t){const{isDisabled:e=!1,isFocusable:n=!1,...r}=t,{setSelectedIndex:o,isManual:s,id:a,setFocusedIndex:i,selectedIndex:l}=Xr(),{index:c,register:u}=Sd({disabled:e&&!n}),f=c===l,p=()=>{o(c)},d=()=>{i(c),!s&&!(e&&n)&&o(c)},w=Va({...r,ref:Me(u,t.ref),isDisabled:e,isFocusable:n,onClick:Ie(t.onClick,p)}),h="button";return{...w,id:yi(a,c),role:"tab",tabIndex:f?0:-1,type:h,"aria-selected":f,"aria-controls":vi(a,c),onFocus:e?void 0:Ie(t.onFocus,d)}}var[jd,Ad]=Qe({});function Nd(t){const e=Xr(),{id:n,selectedIndex:r}=e,s=fs(t.children).map((a,i)=>A.createElement(jd,{key:i,value:{isSelected:i===r,id:vi(n,i),tabId:yi(n,i),selectedIndex:r}},a));return{...t,children:s}}function Fd(t){const{children:e,...n}=t,{isLazy:r,lazyBehavior:o}=Xr(),{isSelected:s,id:a,tabId:i}=Ad(),l=A.useRef(!1);s&&(l.current=!0);const c=ks({wasSelected:l.current,isSelected:s,enabled:r,mode:o});return{tabIndex:0,...n,children:c?e:null,role:"tabpanel","aria-labelledby":i,hidden:!s,id:a}}function yi(t,e){return`${t}--tab-${e}`}function vi(t,e){return`${t}--tabpanel-${e}`}var[Rd,Qr]=Qe({name:"TabsStylesContext",errorMessage:`useTabsStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tabs />" `}),gi=fe(function(e,n){const r=Rt("Tabs",e),{children:o,className:s,...a}=et(e),{htmlProps:i,descendants:l,...c}=Id(a),u=A.useMemo(()=>c,[c]),{isFitted:f,...p}=i,d={position:"relative",...r.root};return C.jsx(kd,{value:l,children:C.jsx(Od,{value:u,children:C.jsx(Rd,{value:r,children:C.jsx(ue.div,{className:_e("chakra-tabs",s),ref:n,...p,__css:d,children:o})})})})});gi.displayName="Tabs";var wi=fe(function(e,n){const r=Dd({...e,ref:n}),s={display:"flex",...Qr().tablist};return C.jsx(ue.div,{...r,className:_e("chakra-tabs__tablist",e.className),__css:s})});wi.displayName="TabList";var Io=fe(function(e,n){const r=Fd({...e,ref:n}),o=Qr();return C.jsx(ue.div,{outline:"0",...r,className:_e("chakra-tabs__tab-panel",e.className),__css:o.tabpanel})});Io.displayName="TabPanel";var bi=fe(function(e,n){const r=Nd(e),o=Qr();return C.jsx(ue.div,{...r,width:"100%",ref:n,className:_e("chakra-tabs__tab-panels",e.className),__css:o.tabpanels})});bi.displayName="TabPanels";var Oo=fe(function(e,n){const r=Qr(),o=Pd({...e,ref:n}),s={outline:"0",display:"flex",alignItems:"center",justifyContent:"center",...r.tab};return C.jsx(ue.button,{...o,className:_e("chakra-tabs__tab",e.className),__css:s})});Oo.displayName="Tab";var[Td,_i]=Qe({name:"TagStylesContext",errorMessage:`useTagStyles returned is 'undefined'. Seems you forgot to wrap the components in "<Tag />" `}),eo=fe((t,e)=>{const n=Rt("Tag",t),r=et(t),o={display:"inline-flex",verticalAlign:"top",alignItems:"center",maxWidth:"100%",...n.container};return C.jsx(Td,{value:n,children:C.jsx(ue.span,{ref:e,...r,__css:o})})});eo.displayName="Tag";var Bd=fe((t,e)=>{const n=_i();return C.jsx(ue.span,{ref:e,noOfLines:1,...t,__css:n.label})});Bd.displayName="TagLabel";var Md=fe((t,e)=>C.jsx(Wr,{ref:e,verticalAlign:"top",marginEnd:"0.5rem",...t}));Md.displayName="TagLeftIcon";var zd=fe((t,e)=>C.jsx(Wr,{ref:e,verticalAlign:"top",marginStart:"0.5rem",...t}));zd.displayName="TagRightIcon";var xi=t=>C.jsx(Wr,{verticalAlign:"inherit",viewBox:"0 0 512 512",...t,children:C.jsx("path",{fill:"currentColor",d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})});xi.displayName="TagCloseIcon";var Ld=fe((t,e)=>{const{isDisabled:n,children:r,...o}=t,a={display:"flex",alignItems:"center",justifyContent:"center",outline:"0",..._i().closeButton};return C.jsx(ue.button,{ref:e,"aria-label":"close",...o,type:"button",disabled:n,__css:a,children:r||C.jsx(xi,{})})});Ld.displayName="TagCloseButton";var Wd={exit:{scale:.85,opacity:0,transition:{opacity:{duration:.15,easings:"easeInOut"},scale:{duration:.2,easings:"easeInOut"}}},enter:{scale:1,opacity:1,transition:{opacity:{easings:"easeOut",duration:.2},scale:{duration:.2,ease:[.175,.885,.4,1.1]}}}},Do=t=>{var e;return((e=t.current)==null?void 0:e.ownerDocument)||document},ur=t=>{var e,n;return((n=(e=t.current)==null?void 0:e.ownerDocument)==null?void 0:n.defaultView)||window};function Ud(t={}){const{openDelay:e=0,closeDelay:n=0,closeOnClick:r=!0,closeOnMouseDown:o,closeOnScroll:s,closeOnPointerDown:a=o,closeOnEsc:i=!0,onOpen:l,onClose:c,placement:u,id:f,isOpen:p,defaultIsOpen:d,arrowSize:w=10,arrowShadowColor:h,arrowPadding:y,modifiers:m,isDisabled:v,gutter:_,offset:k,direction:x,...I}=t,{isOpen:E,onOpen:N,onClose:D}=xs({isOpen:p,defaultIsOpen:d,onOpen:l,onClose:c}),{referenceRef:R,getPopperProps:H,getArrowInnerProps:j,getArrowProps:T}=_s({enabled:E,placement:u,arrowPadding:y,modifiers:m,gutter:_,offset:k,direction:x}),b=A.useId(),ee=`tooltip-${f??b}`,P=A.useRef(null),G=A.useRef(),L=A.useCallback(()=>{G.current&&(clearTimeout(G.current),G.current=void 0)},[]),J=A.useRef(),M=A.useCallback(()=>{J.current&&(clearTimeout(J.current),J.current=void 0)},[]),B=A.useCallback(()=>{M(),D()},[D,M]),ne=Kd(P,B),X=A.useCallback(()=>{if(!v&&!G.current){E&&ne();const pe=ur(P);G.current=pe.setTimeout(N,e)}},[ne,v,E,N,e]),Z=A.useCallback(()=>{L();const pe=ur(P);J.current=pe.setTimeout(B,n)},[n,B,L]),me=A.useCallback(()=>{E&&r&&Z()},[r,Z,E]),ge=A.useCallback(()=>{E&&a&&Z()},[a,Z,E]),ie=A.useCallback(pe=>{E&&pe.key==="Escape"&&Z()},[E,Z]);nn(()=>Do(P),"keydown",i?ie:void 0),nn(()=>{if(!s)return null;const pe=P.current;if(!pe)return null;const xe=$a(pe);return xe.localName==="body"?ur(P):xe},"scroll",()=>{E&&s&&B()},{passive:!0,capture:!0}),A.useEffect(()=>{v&&(L(),E&&D())},[v,E,D,L]),A.useEffect(()=>()=>{L(),M()},[L,M]),nn(()=>P.current,"pointerleave",Z);const ce=A.useCallback((pe={},xe=null)=>({...pe,ref:Me(P,xe,R),onPointerEnter:Ie(pe.onPointerEnter,U=>{U.pointerType!=="touch"&&X()}),onClick:Ie(pe.onClick,me),onPointerDown:Ie(pe.onPointerDown,ge),onFocus:Ie(pe.onFocus,X),onBlur:Ie(pe.onBlur,Z),"aria-describedby":E?ee:void 0}),[X,Z,ge,E,ee,me,R]),be=A.useCallback((pe={},xe=null)=>H({...pe,style:{...pe.style,[je.arrowSize.var]:w?`${w}px`:void 0,[je.arrowShadowColor.var]:h}},xe),[H,w,h]),ye=A.useCallback((pe={},xe=null)=>{const g={...pe.style,position:"relative",transformOrigin:je.transformOrigin.varRef};return{ref:xe,...I,...pe,id:ee,role:"tooltip",style:g}},[I,ee]);return{isOpen:E,show:X,hide:Z,getTriggerProps:ce,getTooltipProps:ye,getTooltipPositionerProps:be,getArrowProps:T,getArrowInnerProps:j}}var co="chakra-ui:close-tooltip";function Kd(t,e){return A.useEffect(()=>{const n=Do(t);return n.addEventListener(co,e),()=>n.removeEventListener(co,e)},[e,t]),()=>{const n=Do(t),r=ur(t);n.dispatchEvent(new r.CustomEvent(co))}}function $d(t,e=[]){const n=Object.assign({},t);for(const r of e)r in n&&delete n[r];return n}function Hd(t,e){const n={};for(const r of e)r in t&&(n[r]=t[r]);return n}var qd=ue(ls.div),Pt=fe((t,e)=>{var n,r;const o=Ur("Tooltip",t),s=et(t),a=is(),{children:i,label:l,shouldWrapChildren:c,"aria-label":u,hasArrow:f,bg:p,portalProps:d,background:w,backgroundColor:h,bgColor:y,motionProps:m,...v}=s,_=(r=(n=w??h)!=null?n:p)!=null?r:y;if(_){o.bg=_;const H=Pl(a,"colors",_);o[je.arrowBg.var]=H}const k=Ud({...v,direction:a.direction}),x=typeof i=="string"||c;let I;if(x)I=C.jsx(ue.span,{display:"inline-block",tabIndex:0,...k.getTriggerProps(),children:i});else{const H=A.Children.only(i);I=A.cloneElement(H,k.getTriggerProps(H.props,H.ref))}const E=!!u,N=k.getTooltipProps({},e),D=E?$d(N,["role","id"]):N,R=Hd(N,["role","id"]);return l?C.jsxs(C.Fragment,{children:[I,C.jsx(jl,{children:k.isOpen&&C.jsx(Ia,{...d,children:C.jsx(ue.div,{...k.getTooltipPositionerProps(),__css:{zIndex:o.zIndex,pointerEvents:"none"},children:C.jsxs(qd,{variants:Wd,initial:"exit",animate:"enter",exit:"exit",...m,...D,__css:o,children:[l,E&&C.jsx(ue.span,{srOnly:!0,...R,children:u}),f&&C.jsx(ue.div,{"data-popper-arrow":!0,className:"chakra-tooltip__arrow-wrapper",children:C.jsx(ue.div,{"data-popper-arrow-inner":!0,className:"chakra-tooltip__arrow",__css:{bg:o.bg}})})]})})})})]}):C.jsx(C.Fragment,{children:i})});Pt.displayName="Tooltip";const Vd="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let fn=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=Vd[n[t]&63];return e};function ke(t,e){if(bo==null)throw console.error("api is null!"),new Error("api is null!");return bo.fetchApi(t,e)}async function Zd(t){console.warn("[workspace deprecated] getDB is deprecated",t);try{const e=await ke(`/workspace/get_db?table=${t}`);return e.ok?await e.json():void 0}catch(e){console.error("Error fetching workspace:",e);return}}async function yp(t){try{return await(await ke("/workspace/get_system_dir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absolute_dir:t??""})})).json()}catch(e){console.error("Error getting workflows dir:",e)}}async function vp(){try{return await(await ke("/workspace/open_workflow_file_browser",{method:"POST",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error open workflows folder:",t)}}async function Gd(){const e=await(await ke("/workspace/get_my_workflows_dir")).json();return e.error&&alert(`Failed to fetch my workflows path: ${e.error}`),e}async function gp(){try{return await(await ke("/model_manager/get_model_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function wp(){try{return await(await ke("/model_manager/get_folder_list",{method:"GET",headers:{"Content-Type":"application/json"}})).json()}catch(t){console.error("Error get all models list:",t)}}async function bp(t){try{return await(await ke("/model_manager/cancel_installation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({save_path:t})})).text()}catch(e){console.error("Error move file:",e)}}async function _p(t,e){try{return await(await ke("/workspace/copy_json_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({src:t,dst:e})})).json()}catch(n){console.error("Error copy flows to new directory:",n)}}const Yd="backup",Er="workspace";let er=null;function Jd(){return new Promise((t,e)=>{const n=indexedDB.open("WorkspaceDB",3);n.onupgradeneeded=r=>{const o=r.target.result;o.objectStoreNames.contains(Er)||o.createObjectStore(Er,{keyPath:"id"})},n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{e(r.target.error)}})}async function Xd(){try{return er==null&&(er=await Jd()),new Promise((t,e)=>{if(er==null)return e("indexDB is null");const o=er.transaction([Er],"readonly").objectStore(Er).get(Yd);o.onsuccess=()=>{o.result?t(o.result.value):t(void 0)},o.onerror=()=>e(o.error)})}catch(t){console.error("Error while reading from database:",t)}}async function Qd(){try{return await Xd()}catch(t){console.error("Error retrieving data from IndexedDB:",t)}}const Ee=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Ae=Object.keys,Le=Array.isArray;function Ue(t,e){return typeof e!="object"||Ae(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||Ee.Promise||(Ee.Promise=Promise);const Rn=Object.getPrototypeOf,ef={}.hasOwnProperty;function Ve(t,e){return ef.call(t,e)}function hn(t,e){typeof e=="function"&&(e=e(Rn(t))),(typeof Reflect>"u"?Ae:Reflect.ownKeys)(e).forEach(n=>{wt(t,n,e[n])})}const ki=Object.defineProperty;function wt(t,e,n,r){ki(t,e,Ue(n&&Ve(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function on(t){return{from:function(e){return t.prototype=Object.create(e.prototype),wt(t.prototype,"constructor",t),{extend:hn.bind(null,t.prototype)}}}}const tf=Object.getOwnPropertyDescriptor;function Is(t,e){let n;return tf(t,e)||(n=Rn(t))&&Is(n,e)}const nf=[].slice;function Cr(t,e,n){return nf.call(t,e,n)}function Ei(t,e){return e(t)}function kn(t){if(!t)throw new Error("Assertion Failed")}function Ci(t){Ee.setImmediate?setImmediate(t):setTimeout(t,0)}function Si(t,e){return t.reduce((n,r,o)=>{var s=e(r,o);return s&&(n[s[0]]=s[1]),n},{})}function bt(t,e){if(Ve(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,o=e.length;r<o;++r){var s=bt(t,e[r]);n.push(s)}return n}var a=e.indexOf(".");if(a!==-1){var i=t[e.substr(0,a)];return i===void 0?void 0:bt(i,e.substr(a+1))}}function nt(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){kn(typeof n!="string"&&"length"in n);for(var r=0,o=e.length;r<o;++r)nt(t,e[r],n[r])}else{var s=e.indexOf(".");if(s!==-1){var a=e.substr(0,s),i=e.substr(s+1);if(i==="")n===void 0?Le(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var l=t[a];l&&Ve(t,a)||(l=t[a]={}),nt(l,i,n)}}else n===void 0?Le(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Ii(t){var e={};for(var n in t)Ve(t,n)&&(e[n]=t[n]);return e}const rf=[].concat;function Oi(t){return rf.apply([],t)}const Di="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Oi([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>Ee[t]),of=Di.map(t=>Ee[t]);Si(Di,t=>[t,!0]);let Et=null;function Vn(t){Et=typeof WeakMap<"u"&&new WeakMap;const e=Po(t);return Et=null,e}function Po(t){if(!t||typeof t!="object")return t;let e=Et&&Et.get(t);if(e)return e;if(Le(t)){e=[],Et&&Et.set(t,e);for(var n=0,r=t.length;n<r;++n)e.push(Po(t[n]))}else if(of.indexOf(t.constructor)>=0)e=t;else{const s=Rn(t);for(var o in e=s===Object.prototype?{}:Object.create(s),Et&&Et.set(t,e),t)Ve(t,o)&&(e[o]=Po(t[o]))}return e}const{toString:sf}={};function jo(t){return sf.call(t).slice(8,-1)}const Ao=typeof Symbol<"u"?Symbol.iterator:"@@iterator",af=typeof Ao=="symbol"?function(t){var e;return t!=null&&(e=t[Ao])&&e.apply(t)}:function(){return null},tn={};function vt(t){var e,n,r,o;if(arguments.length===1){if(Le(t))return t.slice();if(this===tn&&typeof t=="string")return[t];if(o=af(t)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const Os=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var dt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Pi(t,e){dt=t,ji=e}var ji=()=>!0;const lf=!new Error("").stack;function Gt(){if(lf)try{throw Gt.arguments,new Error}catch(t){return t}return new Error}function No(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(ji).map(r=>`
`+r).join("")):""}var Ai=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ds=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ai),cf={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function sn(t,e){this._e=Gt(),this.name=t,this.message=e}function Ni(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,r,o)=>o.indexOf(n)===r).join(`
`)}function Sr(t,e,n,r){this._e=Gt(),this.failures=e,this.failedKeys=r,this.successCount=n,this.message=Ni(t,e)}function In(t,e){this._e=Gt(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Ni(t,e)}on(sn).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+No(this._e,2))}},toString:function(){return this.name+": "+this.message}}),on(Sr).from(sn),on(In).from(sn);var Ps=Ds.reduce((t,e)=>(t[e]=e+"Error",t),{});const uf=sn;var le=Ds.reduce((t,e)=>{var n=e+"Error";function r(o,s){this._e=Gt(),this.name=n,o?typeof o=="string"?(this.message=`${o}${s?`
 `+s:""}`,this.inner=s||null):typeof o=="object"&&(this.message=`${o.name} ${o.message}`,this.inner=o):(this.message=cf[e]||n,this.inner=null)}return on(r).from(uf),t[e]=r,t},{});le.Syntax=SyntaxError,le.Type=TypeError,le.Range=RangeError;var la=Ai.reduce((t,e)=>(t[e+"Error"]=le[e],t),{}),dr=Ds.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=le[e]),t),{});function we(){}function Tn(t){return t}function df(t,e){return t==null||t===Tn?e:function(n){return e(t(n))}}function qt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function ff(t,e){return t===we?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?qt(r,this.onsuccess):r),o&&(this.onerror=this.onerror?qt(o,this.onerror):o),s!==void 0?s:n}}function hf(t,e){return t===we?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?qt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?qt(r,this.onerror):r)}}function pf(t,e){return t===we?e:function(n){var r=t.apply(this,arguments);Ue(n,r);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?qt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?qt(s,this.onerror):s),r===void 0?a===void 0?void 0:a:Ue(r,a)}}function mf(t,e){return t===we?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function js(t,e){return t===we?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return n.then(function(){return e.apply(r,s)})}return e.apply(this,arguments)}}dr.ModifyError=Sr,dr.DexieError=sn,dr.BulkError=In;var Bn={};const Fi=100,[Fo,Ir,Ro]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Rn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Rn(e),t]})(),Ri=Ir&&Ir.then,fr=Fo&&Fo.constructor,As=!!Ro;var To=!1,yf=Ro?()=>{Ro.then(tr)}:Ee.setImmediate?setImmediate.bind(null,tr):Ee.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{tr(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(tr,0)},On=function(t,e){En.push([t,e]),Or&&(yf(),Or=!1)},Bo=!0,Or=!0,Ut=[],hr=[],Mo=null,zo=Tn,an={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:da,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{da(t[0],t[1])}catch{}})}},ae=an,En=[],Kt=0,pr=[];function oe(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=we,this._lib=!1;var e=this._PSD=ae;if(dt&&(this._stackHolder=Gt(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Bn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Wo(this,this._value))}this._state=null,this._value=null,++e.ref,Bi(this,t)}const Lo={get:function(){var t=ae,e=Dr;function n(r,o){var s=!t.global&&(t!==ae||e!==Dr);const a=s&&!xt();var i=new oe((l,c)=>{Ns(this,new Ti(Pr(r,t,s,a),Pr(o,t,s,a),l,c,t))});return dt&&Li(i,this),i}return n.prototype=Bn,n},set:function(t){wt(this,"then",t&&t.prototype===Bn?Lo:{get:function(){return t},set:Lo.set})}};function Ti(t,e,n,r,o){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=o}function Bi(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&Zn();n&&typeof n.then=="function"?Bi(t,(o,s)=>{n instanceof oe?n._then(o,s):n.then(o,s)}):(t._state=!0,t._value=n,Mi(t)),r&&Gn()}},Wo.bind(null,t))}catch(n){Wo(t,n)}}function Wo(t,e){if(hr.push(e),t._state===null){var n=t._lib&&Zn();e=zo(e),t._state=!1,t._value=e,dt&&e!==null&&typeof e=="object"&&!e._promise&&function(r,o,s){try{r.apply(null,s)}catch(a){o&&o(a)}}(()=>{var r=Is(e,"stack");e._promise=t,wt(e,"stack",{get:()=>To?r&&(r.get?r.get.apply(e):r.value):t.stack})}),function(r){Ut.some(o=>o._value===r._value)||Ut.push(r)}(t),Mi(t),n&&Gn()}}function Mi(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)Ns(t,e[n]);var o=t._PSD;--o.ref||o.finalize(),Kt===0&&(++Kt,On(()=>{--Kt==0&&Fs()},[]))}function Ns(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Kt,On(vf,[n,t,e])}else t._listeners.push(e)}function vf(t,e,n){try{Mo=e;var r,o=e._value;e._state?r=t(o):(hr.length&&(hr=[]),r=t(o),hr.indexOf(o)===-1&&function(s){for(var a=Ut.length;a;)if(Ut[--a]._value===s._value)return void Ut.splice(a,1)}(e)),n.resolve(r)}catch(s){n.reject(s)}finally{Mo=null,--Kt==0&&Fs(),--n.psd.ref||n.psd.finalize()}}function zi(t,e,n){if(e.length===n)return e;var r="";if(t._state===!1){var o,s,a=t._value;a!=null?(o=a.name||"Error",s=a.message||a,r=No(a,0)):(o=a,s=""),e.push(o+(s?": "+s:"")+r)}return dt&&((r=No(t._stackHolder,2))&&e.indexOf(r)===-1&&e.push(r),t._prev&&zi(t._prev,e,n)),e}function Li(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function tr(){Zn()&&Gn()}function Zn(){var t=Bo;return Bo=!1,Or=!1,t}function Gn(){var t,e,n;do for(;En.length>0;)for(t=En,En=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(En.length>0);Bo=!0,Or=!0}function Fs(){var t=Ut;Ut=[],t.forEach(r=>{r._PSD.onunhandled.call(null,r._value,r)});for(var e=pr.slice(0),n=e.length;n;)e[--n]()}function nr(t){return new oe(Bn,!1,t)}function Ce(t,e){var n=ae;return function(){var r=Zn(),o=ae;try{return At(n,!0),t.apply(this,arguments)}catch(s){e&&e(s)}finally{At(o,!1),r&&Gn()}}}hn(oe.prototype,{then:Lo,_then:function(t,e){Ns(this,new Ti(null,null,t,e,ae))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,r=>r instanceof e?n(r):nr(r)):this.then(null,r=>r&&r.name===e?n(r):nr(r))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),nr(e)))},stack:{get:function(){if(this._stack)return this._stack;try{To=!0;var t=zi(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{To=!1}}},timeout:function(t,e){return t<1/0?new oe((n,r)=>{var o=setTimeout(()=>r(new le.Timeout(e)),t);this.then(n,r).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&wt(oe.prototype,Symbol.toStringTag,"Dexie.Promise"),an.env=Wi(),hn(oe,{all:function(){var t=vt.apply(null,arguments).map(rr);return new oe(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach((o,s)=>oe.resolve(o).then(a=>{t[s]=a,--r||e(t)},n))})},resolve:t=>{if(t instanceof oe)return t;if(t&&typeof t.then=="function")return new oe((n,r)=>{t.then(n,r)});var e=new oe(Bn,!0,t);return Li(e,Mo),e},reject:nr,race:function(){var t=vt.apply(null,arguments).map(rr);return new oe((e,n)=>{t.map(r=>oe.resolve(r).then(e,n))})},PSD:{get:()=>ae,set:t=>ae=t},totalEchoes:{get:()=>Dr},newPSD:jt,usePSD:vn,scheduler:{get:()=>On,set:t=>{On=t}},rejectionMapper:{get:()=>zo,set:t=>{zo=t}},follow:(t,e)=>new oe((n,r)=>jt((o,s)=>{var a=ae;a.unhandleds=[],a.onunhandled=s,a.finalize=qt(function(){(function(i){function l(){i(),pr.splice(pr.indexOf(l),1)}pr.push(l),++Kt,On(()=>{--Kt==0&&Fs()},[])})(()=>{this.unhandleds.length===0?o():s(this.unhandleds[0])})},a.finalize),t()},e,n,r))}),fr&&(fr.allSettled&&wt(oe,"allSettled",function(){const t=vt.apply(null,arguments).map(rr);return new oe(e=>{t.length===0&&e([]);let n=t.length;const r=new Array(n);t.forEach((o,s)=>oe.resolve(o).then(a=>r[s]={status:"fulfilled",value:a},a=>r[s]={status:"rejected",reason:a}).then(()=>--n||e(r)))})}),fr.any&&typeof AggregateError<"u"&&wt(oe,"any",function(){const t=vt.apply(null,arguments).map(rr);return new oe((e,n)=>{t.length===0&&n(new AggregateError([]));let r=t.length;const o=new Array(r);t.forEach((s,a)=>oe.resolve(s).then(i=>e(i),i=>{o[a]=i,--r||n(new AggregateError(o))}))})}));const ze={awaits:0,echoes:0,id:0};var gf=0,mr=[],uo=0,Dr=0,wf=0;function jt(t,e,n,r){var o=ae,s=Object.create(o);s.parent=o,s.ref=0,s.global=!1,s.id=++wf;var a=an.env;s.env=As?{Promise:oe,PromiseProp:{value:oe,configurable:!0,writable:!0},all:oe.all,race:oe.race,allSettled:oe.allSettled,any:oe.any,resolve:oe.resolve,reject:oe.reject,nthen:ca(a.nthen,s),gthen:ca(a.gthen,s)}:{},e&&Ue(s,e),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var i=vn(s,t,n,r);return s.ref===0&&s.finalize(),i}function yn(){return ze.id||(ze.id=++gf),++ze.awaits,ze.echoes+=Fi,ze.id}function xt(){return!!ze.awaits&&(--ze.awaits==0&&(ze.id=0),ze.echoes=ze.awaits*Fi,!0)}function rr(t){return ze.echoes&&t&&t.constructor===fr?(yn(),t.then(e=>(xt(),e),e=>(xt(),Fe(e)))):t}function bf(t){++Dr,ze.echoes&&--ze.echoes!=0||(ze.echoes=ze.id=0),mr.push(ae),At(t,!0)}function _f(){var t=mr[mr.length-1];mr.pop(),At(t,!1)}function At(t,e){var n=ae;if((e?!ze.echoes||uo++&&t===ae:!uo||--uo&&t===ae)||Ui(e?bf.bind(null,t):_f),t!==ae&&(ae=t,n===an&&(an.env=Wi()),As)){var r=an.env.Promise,o=t.env;Ir.then=o.nthen,r.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(Ee,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function Wi(){var t=Ee.Promise;return As?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(Ee,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Ir.then,gthen:t.prototype.then}:{}}function vn(t,e,n,r,o){var s=ae;try{return At(t,!0),e(n,r,o)}finally{At(s,!1)}}function Ui(t){Ri.call(Fo,t)}function Pr(t,e,n,r){return typeof t!="function"?t:function(){var o=ae;n&&yn(),At(e,!0);try{return t.apply(this,arguments)}finally{At(o,!1),r&&Ui(xt)}}}function ca(t,e){return function(n,r){return t.call(this,Pr(n,e),Pr(r,e))}}(""+Ri).indexOf("[native code]")===-1&&(yn=xt=we);const ua="unhandledrejection";function da(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var r,o={promise:e,reason:t};if(Ee.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ua,!0,!0),Ue(r,o)):Ee.CustomEvent&&Ue(r=new CustomEvent(ua,{detail:o}),o),r&&Ee.dispatchEvent&&(dispatchEvent(r),!Ee.PromiseRejectionEvent&&Ee.onunhandledrejection))try{Ee.onunhandledrejection(r)}catch{}dt&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var Fe=oe.reject;function Uo(t,e,n,r){if(t.idbdb&&(t._state.openComplete||ae.letThrough||t._vip)){var o=t._createTransaction(e,n,t._dbSchema);try{o.create(),t._state.PR1398_maxLoop=3}catch(s){return s.name===Ps.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Uo(t,e,n,r))):Fe(s)}return o._promise(e,(s,a)=>jt(()=>(ae.trans=o,r(s,a,o)))).then(s=>o._completion.then(()=>s))}if(t._state.openComplete)return Fe(new le.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Fe(new le.DatabaseClosed);t.open().catch(we)}return t._state.dbReadyPromise.then(()=>Uo(t,e,n,r))}const fa="3.2.4",zt="￿",Ko=-1/0,ht="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ki="String expected.",Dn=[],to=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),xf=to,kf=to,$i=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),no="__dbnames",fo="readonly",ho="readwrite";function Vt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Hi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function or(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Vn(e))[t],e)}class Ef{_trans(e,n,r){const o=this._tx||ae.trans,s=this.name;function a(l,c,u){if(!u.schema[s])throw new le.NotFound("Table "+s+" not part of transaction");return n(u.idbtrans,u)}const i=Zn();try{return o&&o.db===this.db?o===ae.trans?o._promise(e,a,r):jt(()=>o._promise(e,a,r),{trans:o,transless:ae.transless||ae}):Uo(this.db,e,[this.name],a)}finally{i&&Gn()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",r=>this.core.get({trans:r,key:e}).then(o=>this.hook.reading.fire(o))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(Le(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=Ae(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const r=this.schema.indexes.concat(this.schema.primKey).filter(c=>c.compound&&n.every(u=>c.keyPath.indexOf(u)>=0)&&c.keyPath.every(u=>n.indexOf(u)>=0))[0];if(r&&this.db._maxKey!==zt)return this.where(r.name).equals(r.keyPath.map(c=>e[c]));!r&&dt&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:o}=this.schema,s=this.db._deps.indexedDB;function a(c,u){try{return s.cmp(c,u)===0}catch{return!1}}const[i,l]=n.reduce(([c,u],f)=>{const p=o[f],d=e[f];return[c||p,c||!p?Vt(u,p&&p.multi?w=>{const h=bt(w,f);return Le(h)&&h.some(y=>a(d,y))}:w=>a(d,bt(w,f))):u]},[null,null]);return i?this.where(i.name).equals(e[i.keyPath]).filter(l):r?this.filter(l):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,Le(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=r=>{if(!r)return r;const o=Object.create(e.prototype);for(var s in r)if(Ve(r,s))try{o[s]=r[s]}catch{}return o};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){Ue(this,e)})}add(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=or(o)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:n!=null?[n]:null,values:[s]})).then(a=>a.numFailures?oe.reject(a.failures[0]):a.lastResult).then(a=>{if(o)try{nt(e,o,a)}catch{}return a})}update(e,n){if(typeof e!="object"||Le(e))return this.where(":id").equals(e).modify(n);{const r=bt(e,this.schema.primKey.keyPath);if(r===void 0)return Fe(new le.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?Ae(n).forEach(o=>{nt(e,o,n[o])}):n(e,{value:e,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}}put(e,n){const{auto:r,keyPath:o}=this.schema.primKey;let s=e;return o&&r&&(s=or(o)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[s],keys:n!=null?[n]:null})).then(a=>a.numFailures?oe.reject(a.failures[0]):a.lastResult).then(a=>{if(o)try{nt(e,o,a)}catch{}return a})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?oe.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Hi})).then(e=>e.numFailures?oe.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(r=>r.map(o=>this.hook.reading.fire(o))))}bulkAdd(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:i,keyPath:l}=this.schema.primKey;if(l&&o)throw new le.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new le.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&i?e.map(or(l)):e;return this.core.mutate({trans:a,type:"add",keys:o,values:u,wantResults:s}).then(({numFailures:f,results:p,lastResult:d,failures:w})=>{if(f===0)return s?p:d;throw new In(`${this.name}.bulkAdd(): ${f} of ${c} operations failed`,w)})})}bulkPut(e,n,r){const o=Array.isArray(n)?n:void 0,s=(r=r||(o?void 0:n))?r.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:i,keyPath:l}=this.schema.primKey;if(l&&o)throw new le.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new le.InvalidArgument("Arguments objects and keys must have the same length");const c=e.length;let u=l&&i?e.map(or(l)):e;return this.core.mutate({trans:a,type:"put",keys:o,values:u,wantResults:s}).then(({numFailures:f,results:p,lastResult:d,failures:w})=>{if(f===0)return s?p:d;throw new In(`${this.name}.bulkPut(): ${f} of ${c} operations failed`,w)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:e})).then(({numFailures:r,lastResult:o,failures:s})=>{if(r===0)return o;throw new In(`${this.name}.bulkDelete(): ${r} of ${n} operations failed`,s)})}}function Pn(t){var e={},n=function(a,i){if(i){for(var l=arguments.length,c=new Array(l-1);--l;)c[l-1]=arguments[l];return e[a].subscribe.apply(null,c),t}if(typeof a=="string")return e[a]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(a,i,l){if(typeof a!="object"){var c;i||(i=mf),l||(l=we);var u={subscribers:[],fire:l,subscribe:function(f){u.subscribers.indexOf(f)===-1&&(u.subscribers.push(f),u.fire=i(u.fire,f))},unsubscribe:function(f){u.subscribers=u.subscribers.filter(function(p){return p!==f}),u.fire=u.subscribers.reduce(i,l)}};return e[a]=n[a]=u,u}Ae(c=a).forEach(function(f){var p=c[f];if(Le(p))s(f,c[f][0],c[f][1]);else{if(p!=="asap")throw new le.InvalidArgument("Invalid event config");var d=s(f,Tn,function(){for(var w=arguments.length,h=new Array(w);w--;)h[w]=arguments[w];d.subscribers.forEach(function(y){Ci(function(){y.apply(null,h)})})})}})}}function xn(t,e){return on(e).from({prototype:t}),e}function Qt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function po(t,e){t.filter=Vt(t.filter,e)}function mo(t,e,n){var r=t.replayFilter;t.replayFilter=r?()=>Vt(r(),e()):e,t.justLimit=n&&!r}function yr(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new le.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function ha(t,e,n){const r=yr(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function sr(t,e,n,r){const o=t.replayFilter?Vt(t.filter,t.replayFilter()):t.filter;if(t.or){const s={},a=(i,l,c)=>{if(!o||o(l,c,p=>l.stop(p),p=>l.fail(p))){var u=l.primaryKey,f=""+u;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(u)),Ve(s,f)||(s[f]=!0,e(i,l,c))}};return Promise.all([t.or._iterate(a,n),pa(ha(t,r,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}return pa(ha(t,r,n),Vt(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function pa(t,e,n,r){var o=Ce(r?(s,a,i)=>n(r(s),a,i):n);return t.then(s=>{if(s)return s.start(()=>{var a=()=>s.continue();e&&!e(s,i=>a=i,i=>{s.stop(i),a=we},i=>{s.fail(i),a=we})||o(s.value,s,i=>a=i),a()})})}function We(t,e){try{const n=ma(t),r=ma(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(o,s){const a=o.length,i=s.length,l=a<i?a:i;for(let c=0;c<l;++c)if(o[c]!==s[c])return o[c]<s[c]?-1:1;return a===i?0:a<i?-1:1}(ya(t),ya(e));case"Array":return function(o,s){const a=o.length,i=s.length,l=a<i?a:i;for(let c=0;c<l;++c){const u=We(o[c],s[c]);if(u!==0)return u}return a===i?0:a<i?-1:1}(t,e)}}catch{}return NaN}function ma(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=jo(t);return n==="ArrayBuffer"?"binary":n}function ya(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class Cf{_read(e,n){var r=this._ctx;return r.error?r.table._trans(null,Fe.bind(null,r.error)):r.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,Fe.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Vt(n.algorithm,e)}_iterate(e,n){return sr(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&Ue(r,e),n._ctx=r,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(r=>sr(n,e,r,n.table.core))}count(e){return this._read(n=>{const r=this._ctx,o=r.table.core;if(Qt(r,!0))return o.count({trans:n,query:{index:yr(r,o.schema),range:r.range}}).then(a=>Math.min(a,r.limit));var s=0;return sr(r,()=>(++s,!1),n,o).then(()=>s)}).then(e)}sortBy(e,n){const r=e.split(".").reverse(),o=r[0],s=r.length-1;function a(c,u){return u?a(c[r[u]],u-1):c[o]}var i=this._ctx.dir==="next"?1:-1;function l(c,u){var f=a(c,s),p=a(u,s);return f<p?-i:f>p?i:0}return this.toArray(function(c){return c.sort(l)}).then(n)}toArray(e){return this._read(n=>{var r=this._ctx;if(r.dir==="next"&&Qt(r,!0)&&r.limit>0){const{valueMapper:o}=r,s=yr(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:s,range:r.range}}).then(({result:a})=>o?a.map(o):a)}{const o=[];return sr(r,s=>o.push(s),n,r.table.core).then(()=>o)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Qt(n)?mo(n,()=>{var r=e;return(o,s)=>r===0||(r===1?(--r,!1):(s(()=>{o.advance(r),r=0}),!1))}):mo(n,()=>{var r=e;return()=>--r<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),mo(this._ctx,()=>{var n=e;return function(r,o,s){return--n<=0&&o(s),n>=0}},!0),this}until(e,n){return po(this._ctx,function(r,o,s){return!e(r.value)||(o(s),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,r;return po(this._ctx,function(o){return e(o.value)}),n=this._ctx,r=e,n.isMatch=Vt(n.isMatch,r),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.key,o)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,o){e(o.primaryKey,o)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.key)}).then(function(){return r}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Qt(n,!0)&&n.limit>0)return this._read(o=>{var s=yr(n,n.table.core.schema);return n.table.core.query({trans:o,values:!1,limit:n.limit,query:{index:s,range:n.range}})}).then(({result:o})=>o).then(e);n.keysOnly=!n.isMatch;var r=[];return this.each(function(o,s){r.push(s.primaryKey)}).then(function(){return r}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var r={};return po(this._ctx,function(o){var s=o.primaryKey.toString(),a=Ve(r,s);return r[s]=!0,!a}),this}modify(e){var n=this._ctx;return this._write(r=>{var o;if(typeof e=="function")o=e;else{var s=Ae(e),a=s.length;o=function(h){for(var y=!1,m=0;m<a;++m){var v=s[m],_=e[v];bt(h,v)!==_&&(nt(h,v,_),y=!0)}return y}}const i=n.table.core,{outbound:l,extractKey:c}=i.schema.primaryKey,u=this.db._options.modifyChunkSize||200,f=[];let p=0;const d=[],w=(h,y)=>{const{failures:m,numFailures:v}=y;p+=h-v;for(let _ of Ae(m))f.push(m[_])};return this.clone().primaryKeys().then(h=>{const y=m=>{const v=Math.min(u,h.length-m);return i.getMany({trans:r,keys:h.slice(m,m+v),cache:"immutable"}).then(_=>{const k=[],x=[],I=l?[]:null,E=[];for(let D=0;D<v;++D){const R=_[D],H={value:Vn(R),primKey:h[m+D]};o.call(H,H.value,H)!==!1&&(H.value==null?E.push(h[m+D]):l||We(c(R),c(H.value))===0?(x.push(H.value),l&&I.push(h[m+D])):(E.push(h[m+D]),k.push(H.value)))}const N=Qt(n)&&n.limit===1/0&&(typeof e!="function"||e===yo)&&{index:n.index,range:n.range};return Promise.resolve(k.length>0&&i.mutate({trans:r,type:"add",values:k}).then(D=>{for(let R in D.failures)E.splice(parseInt(R),1);w(k.length,D)})).then(()=>(x.length>0||N&&typeof e=="object")&&i.mutate({trans:r,type:"put",keys:I,values:x,criteria:N,changeSpec:typeof e!="function"&&e}).then(D=>w(x.length,D))).then(()=>(E.length>0||N&&e===yo)&&i.mutate({trans:r,type:"delete",keys:E,criteria:N}).then(D=>w(E.length,D))).then(()=>h.length>m+v&&y(m+u))})};return y(0).then(()=>{if(f.length>0)throw new Sr("Error modifying one or more objects",f,p,d);return h.length})})})}delete(){var e=this._ctx,n=e.range;return Qt(e)&&(e.isPrimKey&&!kf||n.type===3)?this._write(r=>{const{primaryKey:o}=e.table.core.schema,s=n;return e.table.core.count({trans:r,query:{index:o,range:s}}).then(a=>e.table.core.mutate({trans:r,type:"deleteRange",range:s}).then(({failures:i,lastResult:l,results:c,numFailures:u})=>{if(u)throw new Sr("Could not delete some values",Object.keys(i).map(f=>i[f]),a-u);return a-u}))}):this.modify(yo)}}const yo=(t,e)=>e.value=null;function Sf(t,e){return t<e?-1:t===e?0:1}function If(t,e){return t>e?-1:t===e?0:1}function He(t,e,n){var r=t instanceof Vi?new t.Collection(t):t;return r._ctx.error=n?new n(e):new TypeError(e),r}function en(t){return new t.Collection(t,()=>qi("")).limit(0)}function Of(t,e,n,r,o,s){for(var a=Math.min(t.length,r.length),i=-1,l=0;l<a;++l){var c=e[l];if(c!==r[l])return o(t[l],n[l])<0?t.substr(0,l)+n[l]+n.substr(l+1):o(t[l],r[l])<0?t.substr(0,l)+r[l]+n.substr(l+1):i>=0?t.substr(0,i)+e[i]+n.substr(i+1):null;o(t[l],c)<0&&(i=l)}return a<r.length&&s==="next"?t+n.substr(t.length):a<t.length&&s==="prev"?t.substr(0,n.length):i<0?null:t.substr(0,i)+r[i]+n.substr(i+1)}function ar(t,e,n,r){var o,s,a,i,l,c,u,f=n.length;if(!n.every(h=>typeof h=="string"))return He(t,Ki);function p(h){o=function(m){return m==="next"?v=>v.toUpperCase():v=>v.toLowerCase()}(h),s=function(m){return m==="next"?v=>v.toLowerCase():v=>v.toUpperCase()}(h),a=h==="next"?Sf:If;var y=n.map(function(m){return{lower:s(m),upper:o(m)}}).sort(function(m,v){return a(m.lower,v.lower)});i=y.map(function(m){return m.upper}),l=y.map(function(m){return m.lower}),c=h,u=h==="next"?"":r}p("next");var d=new t.Collection(t,()=>kt(i[0],l[f-1]+r));d._ondirectionchange=function(h){p(h)};var w=0;return d._addAlgorithm(function(h,y,m){var v=h.key;if(typeof v!="string")return!1;var _=s(v);if(e(_,l,w))return!0;for(var k=null,x=w;x<f;++x){var I=Of(v,_,i[x],l[x],a,c);I===null&&k===null?w=x+1:(k===null||a(k,I)>0)&&(k=I)}return y(k!==null?function(){h.continue(k+u)}:m),!1}),d}function kt(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function qi(t){return{type:1,lower:t,upper:t}}class Vi{get Collection(){return this._ctx.table.db.Collection}between(e,n,r,o){r=r!==!1,o=o===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(r||o)&&(!r||!o)?en(this):new this.Collection(this,()=>kt(e,n,!r,!o))}catch{return He(this,ht)}}equals(e){return e==null?He(this,ht):new this.Collection(this,()=>qi(e))}above(e){return e==null?He(this,ht):new this.Collection(this,()=>kt(e,void 0,!0))}aboveOrEqual(e){return e==null?He(this,ht):new this.Collection(this,()=>kt(e,void 0,!1))}below(e){return e==null?He(this,ht):new this.Collection(this,()=>kt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?He(this,ht):new this.Collection(this,()=>kt(void 0,e))}startsWith(e){return typeof e!="string"?He(this,Ki):this.between(e,e+zt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):ar(this,(n,r)=>n.indexOf(r[0])===0,[e],zt)}equalsIgnoreCase(e){return ar(this,(n,r)=>n===r[0],[e],"")}anyOfIgnoreCase(){var e=vt.apply(tn,arguments);return e.length===0?en(this):ar(this,(n,r)=>r.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=vt.apply(tn,arguments);return e.length===0?en(this):ar(this,(n,r)=>r.some(o=>n.indexOf(o)===0),e,zt)}anyOf(){const e=vt.apply(tn,arguments);let n=this._cmp;try{e.sort(n)}catch{return He(this,ht)}if(e.length===0)return en(this);const r=new this.Collection(this,()=>kt(e[0],e[e.length-1]));r._ondirectionchange=s=>{n=s==="next"?this._ascending:this._descending,e.sort(n)};let o=0;return r._addAlgorithm((s,a,i)=>{const l=s.key;for(;n(l,e[o])>0;)if(++o,o===e.length)return a(i),!1;return n(l,e[o])===0||(a(()=>{s.continue(e[o])}),!1)}),r}notEqual(e){return this.inAnyRange([[Ko,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=vt.apply(tn,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return He(this,ht)}const n=e.reduce((r,o)=>r?r.concat([[r[r.length-1][1],o]]):[[Ko,o]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const r=this._cmp,o=this._ascending,s=this._descending,a=this._min,i=this._max;if(e.length===0)return en(this);if(!e.every(v=>v[0]!==void 0&&v[1]!==void 0&&o(v[0],v[1])<=0))return He(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",le.InvalidArgument);const l=!n||n.includeLowers!==!1,c=n&&n.includeUppers===!0;let u,f=o;function p(v,_){return f(v[0],_[0])}try{u=e.reduce(function(v,_){let k=0,x=v.length;for(;k<x;++k){const I=v[k];if(r(_[0],I[1])<0&&r(_[1],I[0])>0){I[0]=a(I[0],_[0]),I[1]=i(I[1],_[1]);break}}return k===x&&v.push(_),v},[]),u.sort(p)}catch{return He(this,ht)}let d=0;const w=c?v=>o(v,u[d][1])>0:v=>o(v,u[d][1])>=0,h=l?v=>s(v,u[d][0])>0:v=>s(v,u[d][0])>=0;let y=w;const m=new this.Collection(this,()=>kt(u[0][0],u[u.length-1][1],!l,!c));return m._ondirectionchange=v=>{v==="next"?(y=w,f=o):(y=h,f=s),u.sort(p)},m._addAlgorithm((v,_,k)=>{for(var x=v.key;y(x);)if(++d,d===u.length)return _(k),!1;return!!function(I){return!w(I)&&!h(I)}(x)||(this._cmp(x,u[d][1])===0||this._cmp(x,u[d][0])===0||_(()=>{f===o?v.continue(u[d][0]):v.continue(u[d][1])}),!1)}),m}startsWithAnyOf(){const e=vt.apply(tn,arguments);return e.every(n=>typeof n=="string")?e.length===0?en(this):this.inAnyRange(e.map(n=>[n,n+zt])):He(this,"startsWithAnyOf() only works with strings")}}function st(t){return Ce(function(e){return Mn(e),t(e.target.error),!1})}function Mn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const zn="storagemutated",Ct="x-storagemutated-1",Nt=Pn(null,zn);class Df{_lock(){return kn(!ae.global),++this._reculock,this._reculock!==1||ae.global||(ae.lockOwnerFor=this),this}_unlock(){if(kn(!ae.global),--this._reculock==0)for(ae.global||(ae.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{vn(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&ae.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,r=this.db._state.dbOpenError;if(kn(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new le.DatabaseClosed(r);case"MissingAPIError":throw new le.MissingAPI(r.message,r);default:throw new le.OpenFailed(r)}if(!this.active)throw new le.TransactionInactive;return kn(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ce(o=>{Mn(o),this._reject(e.error)}),e.onabort=Ce(o=>{Mn(o),this.active&&this._reject(new le.Abort(e.error)),this.active=!1,this.on("abort").fire(o)}),e.oncomplete=Ce(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&Nt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,r){if(e==="readwrite"&&this.mode!=="readwrite")return Fe(new le.ReadOnly("Transaction is readonly"));if(!this.active)return Fe(new le.TransactionInactive);if(this._locked())return new oe((s,a)=>{this._blockedFuncs.push([()=>{this._promise(e,n,r).then(s,a)},ae])});if(r)return jt(()=>{var s=new oe((a,i)=>{this._lock();const l=n(a,i,this);l&&l.then&&l.then(a,i)});return s.finally(()=>this._unlock()),s._lib=!0,s});var o=new oe((s,a)=>{var i=n(s,a,this);i&&i.then&&i.then(s,a)});return o._lib=!0,o}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const r=oe.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>r);else{n._waitingFor=r,n._waitingQueue=[];var o=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(o.get(-1/0).onsuccess=a)})()}var s=n._waitingFor;return new oe((a,i)=>{r.then(l=>n._waitingQueue.push(Ce(a.bind(null,l))),l=>n._waitingQueue.push(Ce(i.bind(null,l)))).finally(()=>{n._waitingFor===s&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new le.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(Ve(n,e))return n[e];const r=this.schema[e];if(!r)throw new le.NotFound("Table "+e+" not part of transaction");const o=new this.db.Table(e,r,this);return o.core=this.db.core.table(e),n[e]=o,o}}function $o(t,e,n,r,o,s,a){return{name:t,keyPath:e,unique:n,multi:r,auto:o,compound:s,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+Zi(e)}}function Zi(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Gi(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Si(n,r=>[r.name,r])}}let Ln=t=>{try{return t.only([[]]),Ln=()=>[[]],[[]]}catch{return Ln=()=>zt,zt}};function Ho(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?r=>r[e]:r=>bt(r,e)}(t):e=>bt(e,t)}function va(t){return[].slice.call(t)}let Pf=0;function jn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function jf(t,e,n){function r(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:u,lowerOpen:f,upperOpen:p}=l;return c===void 0?u===void 0?null:e.upperBound(u,!!p):u===void 0?e.lowerBound(c,!!f):e.bound(c,u,!!f,!!p)}const{schema:o,hasGetAll:s}=function(l,c){const u=va(l.objectStoreNames);return{schema:{name:l.name,tables:u.map(f=>c.objectStore(f)).map(f=>{const{keyPath:p,autoIncrement:d}=f,w=Le(p),h=p==null,y={},m={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:h,compound:w,keyPath:p,autoIncrement:d,unique:!0,extractKey:Ho(p)},indexes:va(f.indexNames).map(v=>f.index(v)).map(v=>{const{name:_,unique:k,multiEntry:x,keyPath:I}=v,E={name:_,compound:Le(I),keyPath:I,unique:k,multiEntry:x,extractKey:Ho(I)};return y[jn(I)]=E,E}),getIndexByKeyPath:v=>y[jn(v)]};return y[":id"]=m.primaryKey,p!=null&&(y[jn(p)]=m.primaryKey),m})},hasGetAll:u.length>0&&"getAll"in c.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=o.tables.map(l=>function(c){const u=c.name;return{name:u,schema:c,mutate:function({trans:f,type:p,keys:d,values:w,range:h}){return new Promise((y,m)=>{y=Ce(y);const v=f.objectStore(u),_=v.keyPath==null,k=p==="put"||p==="add";if(!k&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:x}=d||w||{length:1};if(d&&w&&d.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(x===0)return y({numFailures:0,failures:{},results:[],lastResult:void 0});let I;const E=[],N=[];let D=0;const R=j=>{++D,Mn(j)};if(p==="deleteRange"){if(h.type===4)return y({numFailures:D,failures:N,results:[],lastResult:void 0});h.type===3?E.push(I=v.clear()):E.push(I=v.delete(r(h)))}else{const[j,T]=k?_?[w,d]:[w,null]:[d,null];if(k)for(let b=0;b<x;++b)E.push(I=T&&T[b]!==void 0?v[p](j[b],T[b]):v[p](j[b])),I.onerror=R;else for(let b=0;b<x;++b)E.push(I=v[p](j[b])),I.onerror=R}const H=j=>{const T=j.target.result;E.forEach((b,$)=>b.error!=null&&(N[$]=b.error)),y({numFailures:D,failures:N,results:p==="delete"?d:E.map(b=>b.result),lastResult:T})};I.onerror=j=>{R(j),H(j)},I.onsuccess=H})},getMany:({trans:f,keys:p})=>new Promise((d,w)=>{d=Ce(d);const h=f.objectStore(u),y=p.length,m=new Array(y);let v,_=0,k=0;const x=E=>{const N=E.target;m[N._pos]=N.result,++k===_&&d(m)},I=st(w);for(let E=0;E<y;++E)p[E]!=null&&(v=h.get(p[E]),v._pos=E,v.onsuccess=x,v.onerror=I,++_);_===0&&d(m)}),get:({trans:f,key:p})=>new Promise((d,w)=>{d=Ce(d);const h=f.objectStore(u).get(p);h.onsuccess=y=>d(y.target.result),h.onerror=st(w)}),query:function(f){return p=>new Promise((d,w)=>{d=Ce(d);const{trans:h,values:y,limit:m,query:v}=p,_=m===1/0?void 0:m,{index:k,range:x}=v,I=h.objectStore(u),E=k.isPrimaryKey?I:I.index(k.name),N=r(x);if(m===0)return d({result:[]});if(f){const D=y?E.getAll(N,_):E.getAllKeys(N,_);D.onsuccess=R=>d({result:R.target.result}),D.onerror=st(w)}else{let D=0;const R=y||!("openKeyCursor"in E)?E.openCursor(N):E.openKeyCursor(N),H=[];R.onsuccess=j=>{const T=R.result;return T?(H.push(y?T.value:T.primaryKey),++D===m?d({result:H}):void T.continue()):d({result:H})},R.onerror=st(w)}})}(s),openCursor:function({trans:f,values:p,query:d,reverse:w,unique:h}){return new Promise((y,m)=>{y=Ce(y);const{index:v,range:_}=d,k=f.objectStore(u),x=v.isPrimaryKey?k:k.index(v.name),I=w?h?"prevunique":"prev":h?"nextunique":"next",E=p||!("openKeyCursor"in x)?x.openCursor(r(_),I):x.openKeyCursor(r(_),I);E.onerror=st(m),E.onsuccess=Ce(N=>{const D=E.result;if(!D)return void y(null);D.___id=++Pf,D.done=!1;const R=D.continue.bind(D);let H=D.continuePrimaryKey;H&&(H=H.bind(D));const j=D.advance.bind(D),T=()=>{throw new Error("Cursor not stopped")};D.trans=f,D.stop=D.continue=D.continuePrimaryKey=D.advance=()=>{throw new Error("Cursor not started")},D.fail=Ce(m),D.next=function(){let b=1;return this.start(()=>b--?this.continue():this.stop()).then(()=>this)},D.start=b=>{const $=new Promise((P,G)=>{P=Ce(P),E.onerror=st(G),D.fail=G,D.stop=L=>{D.stop=D.continue=D.continuePrimaryKey=D.advance=T,P(L)}}),ee=()=>{if(E.result)try{b()}catch(P){D.fail(P)}else D.done=!0,D.start=()=>{throw new Error("Cursor behind last entry")},D.stop()};return E.onsuccess=Ce(P=>{E.onsuccess=ee,ee()}),D.continue=R,D.continuePrimaryKey=H,D.advance=j,ee(),$},y(D)},m)})},count({query:f,trans:p}){const{index:d,range:w}=f;return new Promise((h,y)=>{const m=p.objectStore(u),v=d.isPrimaryKey?m:m.index(d.name),_=r(w),k=_?v.count(_):v.count();k.onsuccess=Ce(x=>h(x.target.result)),k.onerror=st(y)})}}}(l)),i={};return a.forEach(l=>i[l.name]=l),{stack:"dbcore",transaction:t.transaction.bind(t),table(l){if(!i[l])throw new Error(`Table '${l}' not found`);return i[l]},MIN_KEY:-1/0,MAX_KEY:Ln(e),schema:o}}function qo({_novip:t},e){const n=e.db,r=function(o,s,{IDBKeyRange:a,indexedDB:i},l){return{dbcore:function(u,f){return f.reduce((p,{create:d})=>({...p,...d(p)}),u)}(jf(s,a,l),o.dbcore)}}(t._middlewares,n,t._deps,e);t.core=r.dbcore,t.tables.forEach(o=>{const s=o.name;t.core.schema.tables.some(a=>a.name===s)&&(o.core=t.core.table(s),t[s]instanceof t.Table&&(t[s].core=o.core))})}function jr({_novip:t},e,n,r){n.forEach(o=>{const s=r[o];e.forEach(a=>{const i=Is(a,o);(!i||"value"in i&&i.value===void 0)&&(a===t.Transaction.prototype||a instanceof t.Transaction?wt(a,o,{get(){return this.table(o)},set(l){ki(this,o,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):a[o]=new t.Table(o,s))})})}function Vo({_novip:t},e){e.forEach(n=>{for(let r in n)n[r]instanceof t.Table&&delete n[r]})}function Af(t,e){return t._cfg.version-e._cfg.version}function Nf(t,e,n,r){const o=t._dbSchema,s=t._createTransaction("readwrite",t._storeNames,o);s.create(n),s._completion.catch(r);const a=s._reject.bind(s),i=ae.transless||ae;jt(()=>{ae.trans=s,ae.transless=i,e===0?(Ae(o).forEach(l=>{vo(n,l,o[l].primKey,o[l].indexes)}),qo(t,n),oe.follow(()=>t.on.populate.fire(s)).catch(a)):function({_novip:l},c,u,f){const p=[],d=l._versions;let w=l._dbSchema=Go(l,l.idbdb,f),h=!1;const y=d.filter(v=>v._cfg.version>=c);function m(){return p.length?oe.resolve(p.shift()(u.idbtrans)).then(m):oe.resolve()}return y.forEach(v=>{p.push(()=>{const _=w,k=v._cfg.dbschema;Yo(l,_,f),Yo(l,k,f),w=l._dbSchema=k;const x=Yi(_,k);x.add.forEach(E=>{vo(f,E[0],E[1].primKey,E[1].indexes)}),x.change.forEach(E=>{if(E.recreate)throw new le.Upgrade("Not yet support for changing primary key");{const N=f.objectStore(E.name);E.add.forEach(D=>Zo(N,D)),E.change.forEach(D=>{N.deleteIndex(D.name),Zo(N,D)}),E.del.forEach(D=>N.deleteIndex(D))}});const I=v._cfg.contentUpgrade;if(I&&v._cfg.version>c){qo(l,f),u._memoizedTables={},h=!0;let E=Ii(k);x.del.forEach(H=>{E[H]=_[H]}),Vo(l,[l.Transaction.prototype]),jr(l,[l.Transaction.prototype],Ae(E),E),u.schema=E;const N=Os(I);let D;N&&yn();const R=oe.follow(()=>{if(D=I(u),D&&N){var H=xt.bind(null,null);D.then(H,H)}});return D&&typeof D.then=="function"?oe.resolve(D):R.then(()=>D)}}),p.push(_=>{(!h||!xf)&&function(k,x){[].slice.call(x.db.objectStoreNames).forEach(I=>k[I]==null&&x.db.deleteObjectStore(I))}(v._cfg.dbschema,_),Vo(l,[l.Transaction.prototype]),jr(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),u.schema=l._dbSchema})}),m().then(()=>{var v,_;_=f,Ae(v=w).forEach(k=>{_.db.objectStoreNames.contains(k)||vo(_,k,v[k].primKey,v[k].indexes)})})}(t,e,s,n).catch(a)})}function Yi(t,e){const n={del:[],add:[],change:[]};let r;for(r in t)e[r]||n.del.push(r);for(r in e){const o=t[r],s=e[r];if(o){const a={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto&&!to)a.recreate=!0,n.change.push(a);else{const i=o.idxByName,l=s.idxByName;let c;for(c in i)l[c]||a.del.push(c);for(c in l){const u=i[c],f=l[c];u?u.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([r,s])}return n}function vo(t,e,n,r){const o=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(s=>Zo(o,s)),o}function Zo(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Go(t,e,n){const r={};return Cr(e.objectStoreNames,0).forEach(o=>{const s=n.objectStore(o);let a=s.keyPath;const i=$o(Zi(a),a||"",!1,!1,!!s.autoIncrement,a&&typeof a!="string",!0),l=[];for(let u=0;u<s.indexNames.length;++u){const f=s.index(s.indexNames[u]);a=f.keyPath;var c=$o(f.name,a,!!f.unique,!!f.multiEntry,!1,a&&typeof a!="string",!1);l.push(c)}r[o]=Gi(o,i,l)}),r}function Yo({_novip:t},e,n){const r=n.db.objectStoreNames;for(let o=0;o<r.length;++o){const s=r[o],a=n.objectStore(s);t._hasGetAll="getAll"in a;for(let i=0;i<a.indexNames.length;++i){const l=a.indexNames[i],c=a.index(l).keyPath,u=typeof c=="string"?c:"["+Cr(c).join("+")+"]";if(e[s]){const f=e[s].idxByName[u];f&&(f.name=l,delete e[s].idxByName[u],e[s].idxByName[l]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Ee.WorkerGlobalScope&&Ee instanceof Ee.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Ff{_parseStoresSpec(e,n){Ae(e).forEach(r=>{if(e[r]!==null){var o=e[r].split(",").map((a,i)=>{const l=(a=a.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return $o(l,c||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),Le(c),i===0)}),s=o.shift();if(s.multi)throw new le.Schema("Primary key cannot be multi-valued");o.forEach(a=>{if(a.auto)throw new le.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new le.Schema("Index must have a name and cannot be an empty string")}),n[r]=Gi(r,s,o)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?Ue(this._cfg.storesSource,e):e;const r=n._versions,o={};let s={};return r.forEach(a=>{Ue(o,a._cfg.storesSource),s=a._cfg.dbschema={},a._parseStoresSpec(o,s)}),n._dbSchema=s,Vo(n,[n._allTables,n,n.Transaction.prototype]),jr(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Ae(s),s),n._storeNames=Ae(s),this}upgrade(e){return this._cfg.contentUpgrade=js(this._cfg.contentUpgrade||we,e),this}}function Rs(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new $t(no,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Ts(t){return t&&typeof t.databases=="function"}function Jo(t){return jt(function(){return ae.letThrough=!0,t()})}function Rf(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Tf(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?Fe(e.dbOpenError):t);dt&&(e.openCanceller._stackHolder=Gt()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const r=e.openCanceller;function o(){if(e.openCanceller!==r)throw new le.DatabaseClosed("db.open() was cancelled")}let s=e.dbReadyResolve,a=null,i=!1;return oe.race([r,(typeof navigator>"u"?oe.resolve():Rf()).then(()=>new oe((l,c)=>{if(o(),!n)throw new le.MissingAPI;const u=t.name,f=e.autoSchema?n.open(u):n.open(u,Math.round(10*t.verno));if(!f)throw new le.MissingAPI;f.onerror=st(c),f.onblocked=Ce(t._fireOnBlocked),f.onupgradeneeded=Ce(p=>{if(a=f.transaction,e.autoSchema&&!t._options.allowEmptyDB){f.onerror=Mn,a.abort(),f.result.close();const w=n.deleteDatabase(u);w.onsuccess=w.onerror=Ce(()=>{c(new le.NoSuchDatabase(`Database ${u} doesnt exist`))})}else{a.onerror=st(c);var d=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;i=d<1,t._novip.idbdb=f.result,Nf(t,d/10,a,c)}},c),f.onsuccess=Ce(()=>{a=null;const p=t._novip.idbdb=f.result,d=Cr(p.objectStoreNames);if(d.length>0)try{const h=p.transaction((w=d).length===1?w[0]:w,"readonly");e.autoSchema?function({_novip:y},m,v){y.verno=m.version/10;const _=y._dbSchema=Go(0,m,v);y._storeNames=Cr(m.objectStoreNames,0),jr(y,[y._allTables],Ae(_),_)}(t,p,h):(Yo(t,t._dbSchema,h),function(y,m){const v=Yi(Go(0,y.idbdb,m),y._dbSchema);return!(v.add.length||v.change.some(_=>_.add.length||_.change.length))}(t,h)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),qo(t,h)}catch{}var w;Dn.push(t),p.onversionchange=Ce(h=>{e.vcFired=!0,t.on("versionchange").fire(h)}),p.onclose=Ce(h=>{t.on("close").fire(h)}),i&&function({indexedDB:h,IDBKeyRange:y},m){!Ts(h)&&m!==no&&Rs(h,y).put({name:m}).catch(we)}(t._deps,u),l()},c)}))]).then(()=>(o(),e.onReadyBeingFired=[],oe.resolve(Jo(()=>t.on.ready.fire(t.vip))).then(function l(){if(e.onReadyBeingFired.length>0){let c=e.onReadyBeingFired.reduce(js,we);return e.onReadyBeingFired=[],oe.resolve(Jo(()=>c(t.vip))).then(l)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(l=>{e.dbOpenError=l;try{a&&a.abort()}catch{}return r===e.openCanceller&&t._close(),Fe(l)}).finally(()=>{e.openComplete=!0,s()})}function Xo(t){var e=s=>t.next(s),n=o(e),r=o(s=>t.throw(s));function o(s){return a=>{var i=s(a),l=i.value;return i.done?l:l&&typeof l.then=="function"?l.then(n,r):Le(l)?Promise.all(l).then(n,r):n(l)}}return o(e)()}function Bf(t,e,n){var r=arguments.length;if(r<2)throw new le.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[t,Oi(o),n]}function Ji(t,e,n,r,o){return oe.resolve().then(()=>{const s=ae.transless||ae,a=t._createTransaction(e,n,t._dbSchema,r),i={trans:a,transless:s};if(r)a.idbtrans=r.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(f){return f.name===Ps.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>Ji(t,e,n,null,o))):Fe(f)}const l=Os(o);let c;l&&yn();const u=oe.follow(()=>{if(c=o.call(a,a),c)if(l){var f=xt.bind(null,null);c.then(f,f)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=Xo(c))},i);return(c&&typeof c.then=="function"?oe.resolve(c).then(f=>a.active?f:Fe(new le.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>c)).then(f=>(r&&a._resolve(),a._completion.then(()=>f))).catch(f=>(a._reject(f),Fe(f)))})}function ir(t,e,n){const r=Le(t)?t.slice():[t];for(let o=0;o<n;++o)r.push(e);return r}const Mf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:r}=n,o={},s=[];function a(u,f,p){const d=jn(u),w=o[d]=o[d]||[],h=u==null?0:typeof u=="string"?1:u.length,y=f>0,m={...p,isVirtual:y,keyTail:f,keyLength:h,extractKey:Ho(u),unique:!y&&p.unique};return w.push(m),m.isPrimaryKey||s.push(m),h>1&&a(h===2?u[0]:u.slice(0,h-1),f+1,p),w.sort((v,_)=>v.keyTail-_.keyTail),m}const i=a(r.primaryKey.keyPath,0,r.primaryKey);o[":id"]=[i];for(const u of r.indexes)a(u.keyPath,0,u);function l(u){const f=u.query.index;return f.isVirtual?{...u,query:{index:f,range:(p=u.query.range,d=f.keyTail,{type:p.type===1?2:p.type,lower:ir(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,d),lowerOpen:!0,upper:ir(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,d),upperOpen:!0})}}:u;var p,d}return{...n,schema:{...r,primaryKey:i,indexes:s,getIndexByKeyPath:function(u){const f=o[jn(u)];return f&&f[0]}},count:u=>n.count(l(u)),query:u=>n.query(l(u)),openCursor(u){const{keyTail:f,isVirtual:p,keyLength:d}=u.query.index;return p?n.openCursor(l(u)).then(w=>w&&function(h){return Object.create(h,{continue:{value:function(m){m!=null?h.continue(ir(m,u.reverse?t.MAX_KEY:t.MIN_KEY,f)):u.unique?h.continue(h.key.slice(0,d).concat(u.reverse?t.MIN_KEY:t.MAX_KEY,f)):h.continue()}},continuePrimaryKey:{value(m,v){h.continuePrimaryKey(ir(m,t.MAX_KEY,f),v)}},primaryKey:{get:()=>h.primaryKey},key:{get(){const m=h.key;return d===1?m[0]:m.slice(0,d)}},value:{get:()=>h.value}})}(w)):n.openCursor(u)}}}}}};function Bs(t,e,n,r){return n=n||{},r=r||"",Ae(t).forEach(o=>{if(Ve(e,o)){var s=t[o],a=e[o];if(typeof s=="object"&&typeof a=="object"&&s&&a){const i=jo(s);i!==jo(a)?n[r+o]=e[o]:i==="Object"?Bs(s,a,n,r+o+"."):s!==a&&(n[r+o]=e[o])}else s!==a&&(n[r+o]=e[o])}else n[r+o]=void 0}),Ae(e).forEach(o=>{Ve(t,o)||(n[r+o]=e[o])}),n}const zf={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:r}=n.schema;return{...n,mutate(s){const a=ae.trans,{deleting:i,creating:l,updating:c}=a.table(e).hook;switch(s.type){case"add":if(l.fire===we)break;return a._promise("readwrite",()=>u(s),!0);case"put":if(l.fire===we&&c.fire===we)break;return a._promise("readwrite",()=>u(s),!0);case"delete":if(i.fire===we)break;return a._promise("readwrite",()=>u(s),!0);case"deleteRange":if(i.fire===we)break;return a._promise("readwrite",()=>function(p){return f(p.trans,p.range,1e4)}(s),!0)}return n.mutate(s);function u(p){const d=ae.trans,w=p.keys||function(h,y){return y.type==="delete"?y.keys:y.keys||y.values.map(h.extractKey)}(r,p);if(!w)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:w}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(h,y,m){return y.type==="add"?Promise.resolve([]):h.getMany({trans:y.trans,keys:m,cache:"immutable"})}(n,p,w).then(h=>{const y=w.map((m,v)=>{const _=h[v],k={onerror:null,onsuccess:null};if(p.type==="delete")i.fire.call(k,m,_,d);else if(p.type==="add"||_===void 0){const x=l.fire.call(k,m,p.values[v],d);m==null&&x!=null&&(m=x,p.keys[v]=m,r.outbound||nt(p.values[v],r.keyPath,m))}else{const x=Bs(_,p.values[v]),I=c.fire.call(k,x,m,_,d);if(I){const E=p.values[v];Object.keys(I).forEach(N=>{Ve(E,N)?E[N]=I[N]:nt(E,N,I[N])})}}return k});return n.mutate(p).then(({failures:m,results:v,numFailures:_,lastResult:k})=>{for(let x=0;x<w.length;++x){const I=v?v[x]:w[x],E=y[x];I==null?E.onerror&&E.onerror(m[x]):E.onsuccess&&E.onsuccess(p.type==="put"&&h[x]?p.values[x]:I)}return{failures:m,results:v,numFailures:_,lastResult:k}}).catch(m=>(y.forEach(v=>v.onerror&&v.onerror(m)),Promise.reject(m)))})}function f(p,d,w){return n.query({trans:p,values:!1,query:{index:r,range:d},limit:w}).then(({result:h})=>u({type:"delete",keys:h,trans:p}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):h.length<w?{failures:[],numFailures:0,lastResult:void 0}:f(p,{...d,lower:h[h.length-1],lowerOpen:!0},w)))}}}}})};function Xi(t,e,n){try{if(!e||e.keys.length<t.length)return null;const r=[];for(let o=0,s=0;o<e.keys.length&&s<t.length;++o)We(e.keys[o],t[s])===0&&(r.push(n?Vn(e.values[o]):e.values[o]),++s);return r.length===t.length?r:null}catch{return null}}const Lf={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:r=>{if(!r.cache)return n.getMany(r);const o=Xi(r.keys,r.trans._cache,r.cache==="clone");return o?oe.resolve(o):n.getMany(r).then(s=>(r.trans._cache={keys:r.keys,values:r.cache==="clone"?Vn(s):s},s))},mutate:r=>(r.type!=="add"&&(r.trans._cache=null),n.mutate(r))}}})};function Ms(t){return!("from"in t)}const mt=function(t,e){if(!this){const n=new mt;return t&&"d"in t&&Ue(n,t),n}Ue(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Wn(t,e,n){const r=We(e,n);if(isNaN(r))return;if(r>0)throw RangeError();if(Ms(t))return Ue(t,{from:e,to:n,d:1});const o=t.l,s=t.r;if(We(n,t.from)<0)return o?Wn(o,e,n):t.l={from:e,to:n,d:1,l:null,r:null},ga(t);if(We(e,t.to)>0)return s?Wn(s,e,n):t.r={from:e,to:n,d:1,l:null,r:null},ga(t);We(e,t.from)<0&&(t.from=e,t.l=null,t.d=s?s.d+1:1),We(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const a=!t.r;o&&!t.l&&Ar(t,o),s&&a&&Ar(t,s)}function Ar(t,e){Ms(e)||function n(r,{from:o,to:s,l:a,r:i}){Wn(r,o,s),a&&n(r,a),i&&n(r,i)}(t,e)}function Wf(t,e){const n=Qo(e);let r=n.next();if(r.done)return!1;let o=r.value;const s=Qo(t);let a=s.next(o.from),i=a.value;for(;!r.done&&!a.done;){if(We(i.from,o.to)<=0&&We(i.to,o.from)>=0)return!0;We(o.from,i.from)<0?o=(r=n.next(i.from)).value:i=(a=s.next(o.from)).value}return!1}function Qo(t){let e=Ms(t)?null:{s:0,n:t};return{next(n){const r=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&We(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||We(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function ga(t){var e,n;const r=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),o=r>1?"r":r<-1?"l":"";if(o){const s=o==="r"?"l":"r",a={...t},i=t[o];t.from=i.from,t.to=i.to,t[o]=i[o],a[o]=i[s],t[s]=a,a.d=wa(a)}t.d=wa(t)}function wa({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}hn(mt.prototype,{add(t){return Ar(this,t),this},addKey(t){return Wn(this,t,t),this},addKeys(t){return t.forEach(e=>Wn(this,e,e)),this},[Ao](){return Qo(this)}});const Uf={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new mt(t.MIN_KEY,t.MAX_KEY);return{...t,table:r=>{const o=t.table(r),{schema:s}=o,{primaryKey:a}=s,{extractKey:i,outbound:l}=a,c={...o,mutate:p=>{const d=p.trans,w=d.mutatedParts||(d.mutatedParts={}),h=I=>{const E=`idb://${e}/${r}/${I}`;return w[E]||(w[E]=new mt)},y=h(""),m=h(":dels"),{type:v}=p;let[_,k]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const x=p.trans._cache;return o.mutate(p).then(I=>{if(Le(_)){v!=="delete"&&(_=I.results),y.addKeys(_);const E=Xi(_,x);E||v==="add"||m.addKeys(_),(E||k)&&function(N,D,R,H){function j(T){const b=N(T.name||"");function $(P){return P!=null?T.extractKey(P):null}const ee=P=>T.multiEntry&&Le(P)?P.forEach(G=>b.addKey(G)):b.addKey(P);(R||H).forEach((P,G)=>{const L=R&&$(R[G]),J=H&&$(H[G]);We(L,J)!==0&&(L!=null&&ee(L),J!=null&&ee(J))})}D.indexes.forEach(j)}(h,s,E,k)}else if(_){const E={from:_.lower,to:_.upper};m.add(E),y.add(E)}else y.add(n),m.add(n),s.indexes.forEach(E=>h(E.name).add(n));return I})}},u=({query:{index:p,range:d}})=>{var w,h;return[p,new mt((w=d.lower)!==null&&w!==void 0?w:t.MIN_KEY,(h=d.upper)!==null&&h!==void 0?h:t.MAX_KEY)]},f={get:p=>[a,new mt(p.key)],getMany:p=>[a,new mt().addKeys(p.keys)],count:u,query:u,openCursor:u};return Ae(f).forEach(p=>{c[p]=function(d){const{subscr:w}=ae;if(w){const h=k=>{const x=`idb://${e}/${r}/${k}`;return w[x]||(w[x]=new mt)},y=h(""),m=h(":dels"),[v,_]=f[p](d);if(h(v.name||"").add(_),!v.isPrimaryKey){if(p!=="count"){const k=p==="query"&&l&&d.values&&o.query({...d,values:!1});return o[p].apply(this,arguments).then(x=>{if(p==="query"){if(l&&d.values)return k.then(({result:E})=>(y.addKeys(E),x));const I=d.values?x.result.map(i):x.result;d.values?y.addKeys(I):m.addKeys(I)}else if(p==="openCursor"){const I=x,E=d.values;return I&&Object.create(I,{key:{get:()=>(m.addKey(I.primaryKey),I.key)},primaryKey:{get(){const N=I.primaryKey;return m.addKey(N),N}},value:{get:()=>(E&&y.addKey(I.primaryKey),I.value)}})}return x})}m.add(n)}}return o[p].apply(this,arguments)}}),c}}}};class $t{constructor(e,n){this._middlewares={},this.verno=0;const r=$t.dependencies;this._options=n={addons:$t.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:o}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:we,dbReadyPromise:null,cancelOpen:we,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;s.dbReadyPromise=new oe(i=>{s.dbReadyResolve=i}),s.openCanceller=new oe((i,l)=>{s.cancelOpen=l}),this._state=s,this.name=e,this.on=Pn(this,"populate","blocked","versionchange","close",{ready:[js,we]}),this.on.ready.subscribe=Ei(this.on.ready.subscribe,i=>(l,c)=>{$t.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||oe.resolve().then(l),c&&i(l);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(l),c&&i(l);else{i(l);const f=this;c||i(function p(){f.on.ready.unsubscribe(l),f.on.ready.unsubscribe(p)})}})}),this.Collection=(a=this,xn(Cf.prototype,function(i,l){this.db=a;let c=Hi,u=null;if(l)try{c=l()}catch(w){u=w}const f=i._ctx,p=f.table,d=p.hook.reading.fire;this._ctx={table:p,index:f.index,isPrimKey:!f.index||p.schema.primKey.keyPath&&f.index===p.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:f.or,valueMapper:d!==Tn?d:null}})),this.Table=function(i){return xn(Ef.prototype,function(l,c,u){this.db=i,this._tx=u,this.name=l,this.schema=c,this.hook=i._allTables[l]?i._allTables[l].hook:Pn(null,{creating:[ff,we],reading:[df,Tn],updating:[pf,we],deleting:[hf,we]})})}(this),this.Transaction=function(i){return xn(Df.prototype,function(l,c,u,f,p){this.db=i,this.mode=l,this.storeNames=c,this.schema=u,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=Pn(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new oe((d,w)=>{this._resolve=d,this._reject=w}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},d=>{var w=this.active;return this.active=!1,this.on.error.fire(d),this.parent?this.parent._reject(d):w&&this.idbtrans&&this.idbtrans.abort(),Fe(d)})})}(this),this.Version=function(i){return xn(Ff.prototype,function(l){this.db=i,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(i){return xn(Vi.prototype,function(l,c,u){this.db=i,this._ctx={table:l,index:c===":id"?null:c,or:u};const f=i._deps.indexedDB;if(!f)throw new le.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(p,d)=>f.cmp(d,p),this._max=(p,d)=>f.cmp(p,d)>0?p:d,this._min=(p,d)=>f.cmp(p,d)<0?p:d,this._IDBKeyRange=i._deps.IDBKeyRange})}(this),this.on("versionchange",i=>{i.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",i=>{!i.newVersion||i.newVersion<i.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${i.oldVersion/10}`)}),this._maxKey=Ln(n.IDBKeyRange),this._createTransaction=(i,l,c,u)=>new this.Transaction(i,l,c,this._options.chromeTransactionDurability,u),this._fireOnBlocked=i=>{this.on("blocked").fire(i),Dn.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(i))},this.use(Mf),this.use(zf),this.use(Uf),this.use(Lf),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach(i=>i(this))}version(e){if(isNaN(e)||e<.1)throw new le.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new le.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var r=n.filter(o=>o._cfg.version===e)[0];return r||(r=new this.Version(e),n.push(r),n.sort(Af),r.stores({}),this._state.autoSchema=!1,r)}_whenReady(e){return this.idbdb&&(this._state.openComplete||ae.letThrough||this._vip)?e():new oe((n,r)=>{if(this._state.openComplete)return r(new le.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void r(new le.DatabaseClosed);this.open().catch(we)}this._state.dbReadyPromise.then(n,r)}).then(e)}use({stack:e,create:n,level:r,name:o}){o&&this.unuse({stack:e,name:o});const s=this._middlewares[e]||(this._middlewares[e]=[]);return s.push({stack:e,create:n,level:r??10,name:o}),s.sort((a,i)=>a.level-i.level),this}unuse({stack:e,name:n,create:r}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(o=>r?o.create!==r:!!n&&o.name!==n)),this}open(){return Tf(this)}_close(){const e=this._state,n=Dn.indexOf(this);if(n>=0&&Dn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new oe(r=>{e.dbReadyResolve=r}),e.openCanceller=new oe((r,o)=>{e.cancelOpen=o})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new le.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new oe((r,o)=>{const s=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=Ce(()=>{(function({indexedDB:i,IDBKeyRange:l},c){!Ts(i)&&c!==no&&Rs(i,l).delete(c).catch(we)})(this._deps,this.name),r()}),a.onerror=st(o),a.onblocked=this._fireOnBlocked};if(e)throw new le.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(s):s()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Ae(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Bf.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,r){let o=ae.trans;o&&o.db===this&&e.indexOf("!")===-1||(o=null);const s=e.indexOf("?")!==-1;let a,i;e=e.replace("!","").replace("?","");try{if(i=n.map(c=>{var u=c instanceof this.Table?c.name:c;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),e=="r"||e===fo)a=fo;else{if(e!="rw"&&e!=ho)throw new le.InvalidArgument("Invalid transaction mode: "+e);a=ho}if(o){if(o.mode===fo&&a===ho){if(!s)throw new le.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&i.forEach(c=>{if(o&&o.storeNames.indexOf(c)===-1){if(!s)throw new le.SubTransaction("Table "+c+" not included in parent transaction.");o=null}}),s&&o&&!o.active&&(o=null)}}catch(c){return o?o._promise(null,(u,f)=>{f(c)}):Fe(c)}const l=Ji.bind(null,this,a,i,o,r);return o?o._promise(a,l,"lock"):ae.trans?vn(ae.transless,()=>this._whenReady(l)):this._whenReady(l)}table(e){if(!Ve(this._allTables,e))throw new le.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Kf=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class $f{constructor(e){this._subscribe=e}subscribe(e,n,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:r})}[Kf](){return this}}function Qi(t,e){return Ae(e).forEach(n=>{Ar(t[n]||(t[n]=new mt),e[n])}),t}function Hf(t){let e,n=!1;const r=new $f(o=>{const s=Os(t);let a=!1,i={},l={};const c={get closed(){return a},unsubscribe:()=>{a=!0,Nt.storagemutated.unsubscribe(d)}};o.start&&o.start(c);let u=!1,f=!1;function p(){return Ae(l).some(h=>i[h]&&Wf(i[h],l[h]))}const d=h=>{Qi(i,h),p()&&w()},w=()=>{if(u||a)return;i={};const h={},y=function(m){s&&yn();const v=()=>jt(t,{subscr:m,trans:null}),_=ae.trans?vn(ae.transless,v):v();return s&&_.then(xt,xt),_}(h);f||(Nt(zn,d),f=!0),u=!0,Promise.resolve(y).then(m=>{n=!0,e=m,u=!1,a||(p()?w():(i={},l=h,o.next&&o.next(m)))},m=>{u=!1,n=!1,o.error&&o.error(m),c.unsubscribe()})};return w(),c});return r.hasValue=()=>n,r.getValue=()=>e,r}let es;try{es={indexedDB:Ee.indexedDB||Ee.mozIndexedDB||Ee.webkitIndexedDB||Ee.msIndexedDB,IDBKeyRange:Ee.IDBKeyRange||Ee.webkitIDBKeyRange}}catch{es={indexedDB:null,IDBKeyRange:null}}const Mt=$t;function vr(t){let e=gt;try{gt=!0,Nt.storagemutated.fire(t)}finally{gt=e}}hn(Mt,{...dr,delete:t=>new Mt(t,{addons:[]}).delete(),exists:t=>new Mt(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return Ts(e)?Promise.resolve(e.databases()).then(r=>r.map(o=>o.name).filter(o=>o!==no)):Rs(e,n).toCollection().primaryKeys()}(Mt.dependencies).then(t)}catch{return Fe(new le.MissingAPI)}},defineClass:()=>function(t){Ue(this,t)},ignoreTransaction:t=>ae.trans?vn(ae.transless,t):t(),vip:Jo,async:function(t){return function(){try{var e=Xo(t.apply(this,arguments));return e&&typeof e.then=="function"?e:oe.resolve(e)}catch(n){return Fe(n)}}},spawn:function(t,e,n){try{var r=Xo(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:oe.resolve(r)}catch(o){return Fe(o)}},currentTransaction:{get:()=>ae.trans||null},waitFor:function(t,e){const n=oe.resolve(typeof t=="function"?Mt.ignoreTransaction(t):t).timeout(e||6e4);return ae.trans?ae.trans.waitFor(n):n},Promise:oe,debug:{get:()=>dt,set:t=>{Pi(t,t==="dexie"?()=>!0:$i)}},derive:on,extend:Ue,props:hn,override:Ei,Events:Pn,on:Nt,liveQuery:Hf,extendObservabilitySet:Qi,getByKeyPath:bt,setByKeyPath:nt,delByKeyPath:function(t,e){typeof e=="string"?nt(t,e,void 0):"length"in e&&[].map.call(e,function(n){nt(t,n,void 0)})},shallowClone:Ii,deepClone:Vn,getObjectDiff:Bs,cmp:We,asap:Ci,minKey:Ko,addons:[],connections:Dn,errnames:Ps,dependencies:es,semVer:fa,version:fa.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Mt.maxKey=Ln(Mt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Nt(zn,t=>{if(!gt){let e;to?(e=document.createEvent("CustomEvent"),e.initCustomEvent(Ct,!0,!0,t)):e=new CustomEvent(Ct,{detail:t}),gt=!0,dispatchEvent(e),gt=!1}}),addEventListener(Ct,({detail:t})=>{gt||vr(t)}));let gt=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(Ct);typeof t.unref=="function"&&t.unref(),Nt(zn,e=>{gt||t.postMessage(e)}),t.onmessage=e=>{e.data&&vr(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Nt(zn,e=>{try{gt||(typeof localStorage<"u"&&localStorage.setItem(Ct,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:Ct,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===Ct){const n=JSON.parse(e.newValue);n&&vr(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===Ct&&vr(e.changedParts)})}oe.rejectionMapper=function(t,e){if(!t||t instanceof sn||t instanceof TypeError||t instanceof SyntaxError||!t.name||!la[t.name])return t;var n=new la[t.name](e||t.message,t);return"stack"in t&&wt(n,"stack",{get:function(){return this.inner.stack}}),n},Pi(dt,$i);var qf=(t=>(t.SAVE="save",t.SAVE_AS="saveAs",t.openSpotlightSearch="openSpotlightSearch",t))(qf||{}),gr=(t=>(t.MOVE_TO_ROOT_FOLDER="moveToRootFolder",t.DELETE="delete",t))(gr||{}),zs=(t=>(t.PRIVATE="PRIVATE",t.PUBLIC="PUBLIC",t.UNLISTED="UNLISTED",t))(zs||{});const Vf="comfyui_workspace_db";class Zf extends $t{constructor(){super(Vf);Oe(this,"workflows");Oe(this,"changelogs");Oe(this,"media");Oe(this,"folders");Oe(this,"tags");Oe(this,"userSettings");Oe(this,"models");Oe(this,"cache");Oe(this,"workflowVersions");this.version(1).stores({workflows:"&id, name, parentFolderID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id"}).upgrade(n=>{}),this.version(2).stores({workflows:"&id, name, parentFolderID,cloudID",changelogs:"&id, workflowID",media:"&id, workflowID",folders:"&id, name, parentFolderID",tags:"&name",userSettings:"&id",models:"&id, fileName, fileHash",cache:"&id",workflowVersions:"&id, name, workflowID,cloudID"}).upgrade(n=>{})}}const de=new Zf;class Yt{constructor(e){Oe(this,"tableName");this.tableName=e}async saveDiskDB(){}async add(e){return e.id||(e.id=fn()),e.createTime||(e.createTime=Date.now()),await de[this.tableName].add(e),e}async put(e){return await de[this.tableName].put(e),e}async bulkPut(e){await de[this.tableName].bulkPut(e)}async update(e,n){return await de[this.tableName].update(e,n),await this.get(e)??null}async listAll(){return await de[this.tableName].toArray()}async filter(e){return await de[this.tableName].filter(e).toArray()}async batchQuery(e){return await de[this.tableName].bulkGet(e)}async getRecords(){console.warn("[DEPRECATED] getRecords() call, should only be used for one-time backfill for indexdb",this.tableName);const e=await Zd(this.tableName);let n;try{n=e!=null?JSON.parse(e):null}catch{}if(n==null){const r=await Qd()??"{}";n=JSON.parse(r)[this.tableName]}return n??{}}async get(e){return await de[this.tableName].get(e)}async delete(e){await de[this.tableName].delete(e)}async listByIndex(e,n){return await de[this.tableName].where(e).equals(n).toArray()}}const Gf=80,Rr=class Rr extends Yt{constructor(){super("changelogs")}static async load(){return new Rr}async listByWorkflowID(e){return await de.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime")}async getLastestByWorkflowID(e){return(await this.listByWorkflowID(e))[0]}async create(e){const n=await this.getLastestByWorkflowID(e.workflowID);if(n!=null&&n.json===e.json)return null;const r={id:fn(),json:e.json,workflowID:e.workflowID,createTime:Date.now(),isAutoSave:e.isAutoSave};return await de.changelogs.add(r),await this.deleteLogsExceedLimit(e.workflowID),r}async deleteLogsExceedLimit(e){var o;const n=await de.changelogs.where("workflowID").equals(e).reverse().sortBy("createTime"),r=((o=V==null?void 0:V.settings)==null?void 0:o.maximumChangelogNumber)??Gf;if(n.length>r){const s=n.slice(r);await de.changelogs.bulkDelete(s.map(a=>a.id))}}};Oe(Rr,"TABLE_NAME","changelogs");let ts=Rr;const xp="CWM_WORKFLOWS_SORT_TYPE";var at=(t=>(t.RECENTLY_OPENED="recentlyOpened",t.RECENTLY_MODIFIED="newest",t.OLDEST_MODIFIED="oldest",t.AZ="name A-Z",t.ZA="name Z-A",t))(at||{});const kp=[{title:"Import Workflows",type:"file"},{title:"Import Folder",type:"folder"}];function Yf(t,e=!0,n=!1,r="-"){const o=new Date(t),s=String(o.getDate()).padStart(2,"0"),a=String(o.getMonth()+1).padStart(2,"0"),i=o.getFullYear(),l=String(o.getHours()).padStart(2,"0"),c=String(o.getMinutes()).padStart(2,"0"),u=String(o.getSeconds()).padStart(2,"0"),f=`${a}${r}${s}${r}${i}`;return e?f+` ${l}:${c}`:n?f+`:${u}`:f}const wr=(t,e=at.RECENTLY_MODIFIED)=>{const n=[...t];switch(e){case at.AZ:n.sort((r,o)=>r.name.localeCompare(o.name));break;case at.ZA:n.sort((r,o)=>o.name.localeCompare(r.name));break;case at.RECENTLY_MODIFIED:n.sort((r,o)=>o.updateTime-r.updateTime);break;case at.OLDEST_MODIFIED:n.sort((r,o)=>r.updateTime-o.updateTime);break;case at.RECENTLY_OPENED:n.sort((r,o)=>(o.lastOpenedTime??0)-(r.lastOpenedTime??0));break}return n};function Jf(t){const e=t.nodes,n=new Array,r=new Map,o=new Array;for(let s=0;s<t.nodes.length;++s){const a=t.nodes[s];if(a.inputs)for(const i of a.inputs)i.link&&(o.push(i.link),i.link=null);if(a.outputs)for(const i of a.outputs)i.links&&(o.concat(i.links),i.links=[]);r.set(a.id,s)}for(const s of t.links)o.includes(s[0])&&n.push([r.get(s[1]),s[2],r.get(s[3]),s[4],s[1]]);return JSON.stringify({nodes:e,links:n})}function Ep(t,e){let n=JSON.parse(t);if(!n||!n.nodes||n.nodes.length==0)return;const r=localStorage.getItem("litegrapheditor_clipboard");localStorage.setItem("litegrapheditor_clipboard",Jf(n));const o=Se.canvas.graph_mouse;e&&(e[0]-=15,e[1]-=15,Se.canvas.graph_mouse=e),Se.canvas.pasteFromClipboard(),Se.canvas.graph_mouse=o,r&&localStorage.setItem("litegrapheditor_clipboard",r)}const Cp=t=>{var n;const e=(n=V==null?void 0:V.settings)==null?void 0:n.shortcuts;if(!e)return!1;for(const r in e){const s=e[r].split("+"),a={Control:t.ctrlKey,Shift:t.shiftKey,Alt:t.altKey,Command:t.metaKey,[t.key.toUpperCase()]:!0};for(const i in a)a[i]||delete a[i];if(s.length===Object.keys(a).length&&s.every(i=>a[i]))return r}};function Sp(t){const e=["png","jpg","jpeg","gif","bmp","webp"],n=t.split(".").pop();return n!=null&&e.includes(n)}function Xf(t){return`/workspace/view_media?filename=${t}`}function ba(){const e=window.location.hash.slice(1).split("/").find(n=>n.includes("workspaceId@"));return e?e.split("@")[1]:null}function el(t){const e=window.location.hash.slice(1).split("/"),n=e.findIndex(o=>o.includes("workspaceId@")),r=`workspaceId@${t}`;return n>=0?e[n]=r:e.push(r),`${e.join("/")}`}const Qf=t=>{const e=el(t);window.open(`${window.location.origin}/#${e}`)},tl={last_node_id:9,last_link_id:9,nodes:[{id:7,type:"CLIPTextEncode",pos:[413,389],size:{0:425.27801513671875,1:180.6060791015625},flags:{},order:3,mode:0,inputs:[{name:"clip",type:"CLIP",link:5}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[6],slot_index:0}],properties:{},widgets_values:["text, watermark"]},{id:6,type:"CLIPTextEncode",pos:[415,186],size:{0:422.84503173828125,1:164.31304931640625},flags:{},order:2,mode:0,inputs:[{name:"clip",type:"CLIP",link:3}],outputs:[{name:"CONDITIONING",type:"CONDITIONING",links:[4],slot_index:0}],properties:{},widgets_values:["beautiful scenery nature glass bottle landscape, , purple galaxy bottle,"]},{id:5,type:"EmptyLatentImage",pos:[473,609],size:{0:315,1:106},flags:{},order:1,mode:0,outputs:[{name:"LATENT",type:"LATENT",links:[2],slot_index:0}],properties:{},widgets_values:[512,512,1]},{id:3,type:"KSampler",pos:[863,186],size:{0:315,1:262},flags:{},order:4,mode:0,inputs:[{name:"model",type:"MODEL",link:1},{name:"positive",type:"CONDITIONING",link:4},{name:"negative",type:"CONDITIONING",link:6},{name:"latent_image",type:"LATENT",link:2}],outputs:[{name:"LATENT",type:"LATENT",links:[7],slot_index:0}],properties:{},widgets_values:[0x8e7ff42ed37e,!0,20,8,"euler","normal",1]},{id:8,type:"VAEDecode",pos:[1209,188],size:{0:210,1:46},flags:{},order:5,mode:0,inputs:[{name:"samples",type:"LATENT",link:7},{name:"vae",type:"VAE",link:8}],outputs:[{name:"IMAGE",type:"IMAGE",links:[9],slot_index:0}],properties:{}},{id:9,type:"SaveImage",pos:[1451,189],size:{0:210,1:26},flags:{},order:6,mode:0,inputs:[{name:"images",type:"IMAGE",link:9}],properties:{}},{id:4,type:"CheckpointLoaderSimple",pos:[26,474],size:{0:315,1:98},flags:{},order:0,mode:0,outputs:[{name:"MODEL",type:"MODEL",links:[1],slot_index:0},{name:"CLIP",type:"CLIP",links:[3,5],slot_index:1},{name:"VAE",type:"VAE",links:[8],slot_index:2}],properties:{},widgets_values:["v1-5-pruned-emaonly.ckpt"]}],links:[[1,4,0,3,0,"MODEL"],[2,5,0,3,3,"LATENT"],[3,4,1,6,0,"CLIP"],[4,6,0,3,1,"CONDITIONING"],[5,4,1,7,0,"CLIP"],[6,7,0,3,2,"CONDITIONING"],[7,3,0,8,0,"LATENT"],[8,4,2,8,1,"VAE"],[9,8,0,9,0,"IMAGE"]],groups:[],config:{},extra:{},version:.4},Be="workspace_info",eh=9999999,_a="upgrade_to_2way_sync",Ls=28,Ip="SHORTCUT_TRIGGER_EVENT",Ws={os:null},Op=()=>Ws.os==="Windows"?"\\":"/";function br(...t){const e=t.filter(n=>n!=="").join("/");return Ft(e)}function Ft(t){const e=t.split("/").filter(r=>r!=="").join("/");let n=e.replace(/\\/g,"/");return n=n.replace(/^\/+/,""),Ws.os==="Windows"&&(n=e.replace(/\//g,"\\")),n}function go(t){return br(t.parentFolderID??"",t.name+".json")}var Ge;(t=>{async function e(l,c){try{const f=await(await ke("/workspace/file/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:go(l),newParentPath:c})})).json();return f.error?(alert("Error moving file: "+f.error),!1):!0}catch(u){console.error("Error deleting file:",u)}}t.moveWorkflow=e;async function n(l,c){try{const f=await(await ke("/workspace/file/gen_unique_name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:br(c??"",l)})})).json();return f.error?(console.error("Error getting unique name:",f.error),null):f.uniqueName}catch(u){console.error("Error deleting file:",u)}return null}t.genFileUniqueName=n;async function r({parentFolderID:l,name:c},u){try{const p=await(await ke("/workspace/file/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:br(l??"",c+".json"),newName:u})})).json();return p.error?(alert("Error rename file: "+p.error),!1):!0}catch(f){console.error("Error deleting file:",f)}}t.renameWorkflow=r;async function o(l){const c=l.json,u=JSON.parse(c);u.extra[Be]==null&&(u.extra[Be]={}),u.extra[Be].id=l.id,u.extra[Be].saveLock=l.saveLock,u.extra[Be].cloudID=l.cloudID,u.extra[Be].coverMediaPath=l.coverMediaPath;const p=await(await ke("/workspace/file/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:go(l),json:JSON.stringify(u)})})).json();if(p.error)throw console.error("Error saving file:",p.error),alert(`"Error saving file: ${p.error}
      
      👉Please try "Save as" from "Files" dropdown menu
      `),new Error(p.error);return p}t.saveWorkflow=o;async function s(l){try{return await(await ke("/workspace/delete_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:go(l),deleteEmptyFolder:!1})})).text()}catch(c){alert("Error deleting workflow .json file: "+c),console.error("Error deleting file:",c)}}t.deleteWorkflow=s;async function a(l){var h;const{parentFolderID:c,name:u,json:f,id:p}=l;let d=JSON.parse(f);d.extra==null&&(d.extra={}),d.extra[Be]==null&&(d.extra[Be]={}),d.extra[Be].id=p,d.extra[Be].saveLock=l.saveLock,d.extra[Be].cloudID=l.cloudID,d.extra[Be].coverMediaPath=l.coverMediaPath;const w={parentFolderPath:Ft(c??""),name:u,json:JSON.stringify(d)};try{const m=await(await ke("/workspace/create_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)})).json();return m.name&&await((h=de.workflows)==null?void 0:h.update(p,{name:m.name})),m}catch(y){return console.error(`Error creating file <${p}> at "${c}"`,y),alert(`Error creating file <${p}> at "${c}"`),{}}}t.createWorkflow=a;async function i({parentFolderID:l,name:c,id:u}){const f=br(l??"",c+".json");try{const d=await(await ke("/workspace/get_workflow_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f,id:u})})).json();return d.error&&(console.error(`Error getting file <${u}> at "${f}"`,d.error),alert({message:`Error getting file <${u}> at "${f}"`,level:"error"})),d}catch(p){return console.error(`Erro finding file <${u}> at "${f}"`,p),{}}}t.getFile=i})(Ge||(Ge={}));async function Us(t,e=!1,n=!1){try{return await(await ke("/workspace/file/scan_my_workflows_folder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Ft(t),recursive:e,metaInfoOnly:n})})).json()}catch(r){return console.error("Error scan local new files:",r),[]}}async function th(t,e){const n=Ft(t??""),o=(await Us(n)).map(async i=>{var u;const l=i.name,c=[n,l].join("/");if(nh(i))return{id:Ft(c),name:i.name,parentFolderID:n,type:"folder",createTime:Date.now(),updateTime:Date.now()};{const f=await((u=de.workflows)==null?void 0:u.get(i.id).catch(d=>(console.error("Error getting workflow from indexdb",i.id,c,d),null)));return{cloudID:i.cloudID,coverMediaPath:i.coverMediaPath,saveLock:i.saveLock,...f,id:i.id,json:i.json??"{}",name:l.replace(/\.json$/,""),parentFolderID:n,createTime:i.createTime,updateTime:i.updateTime}}}),s=await Promise.all(o);de.workflows.bulkPut(s.filter(i=>!sh(i)));const a=s.filter(i=>i!=null);return wr(a,e??at.RECENTLY_MODIFIED)}function nh(t){return"type"in t&&t.type==="folder"}const Tr=class Tr extends Yt{constructor(){super("workflows");Oe(this,"_curWorkflow",null)}get curWorkflow(){return this._curWorkflow}static async load(){return new Tr}updateCurWorkflowID(n){if(n==null){this._curWorkflow=null;return}this.get(n).then(r=>{this._curWorkflow=r??null})}updateCurWorkflow(n){this._curWorkflow=n}async latestVersionCheck(){if(this._curWorkflow){const n=await de.workflows.get(this._curWorkflow.id);return n?(n==null?void 0:n.updateTime)===this._curWorkflow.updateTime:!0}return!0}async listByIndex(n,r){const o=await super.listByIndex(n,r);return await(V==null?void 0:V.getSetting("twoWaySync"))?(await Promise.all(o.map(async i=>await this.get(i.id)))).filter(i=>i!=null):o}async generateUniqueName(n,r){if(await(V==null?void 0:V.getSetting("twoWaySync"))){const l=await Ge.genFileUniqueName((n??"Untitled Flow")+".json",r??"");return(l==null?void 0:l.replace(/\.json$/,""))??"Untitled Flow"}let s=n??"Untitled Flow";const i=(await this.listAll()??[]).filter(l=>l.parentFolderID==r).map(l=>l.name);if(i.includes(s)){let l=2,c=!0;for(;c;)i.includes(`${s} ${l}`)?l++:(s=`${s} ${l}`,c=!1)}return s}async createFlow(n){const{name:r}=n,o=await this.generateUniqueName(r,n.parentFolderID??void 0),s=Date.now(),a={...n,id:n.id??fn(),json:n.json??JSON.stringify(tl),name:o,updateTime:n.updateTime??s,createTime:n.createTime??s};return await de.workflows.add(a),await(V==null?void 0:V.getSetting("twoWaySync"))?(await Ge.createWorkflow(a),await this.get(a.id)):a}async update(n,r){throw new Error("Method not allowed.")}async updateTopFields(n,r){return this._update(n,r)}async updateMetaInfo(n,r){return this._update(n,r)}async _update(n,r){await de.workflows.update(n,r);const o=await de.workflows.get(n)??null;return this._curWorkflow&&this._curWorkflow.id===n&&(this._curWorkflow=o),o}async updateFolder(n,r){const o=await(V==null?void 0:V.getSetting("twoWaySync")),s=await this.get(n);!await this.updateMetaInfo(n,r)||!s||o&&await Ge.moveWorkflow(s,r.parentFolderID)}async genLastManualSavedJson(n){const r=await(ct==null?void 0:ct.getLastestByWorkflowID(n));return r==null?void 0:r.json}async updateName(n,r){const o=await this.get(n);return await(V==null?void 0:V.getSetting("twoWaySync"))&&o&&await Ge.renameWorkflow(o,r.name+".json"),await this.updateMetaInfo(n,r)}async updateFlow(n,r){const o=await this.get(n,!1);if(o==null)return;const s=JSON.stringify(o.json),a=JSON.stringify(r.json);if(s===a)return;const i=await this._update(n,{updateTime:Date.now(),json:r.json});await(V==null?void 0:V.getSetting("twoWaySync"))&&i&&await Ge.saveWorkflow(i)}async batchCreateFlows(n=[],r=!1,o){var a,i;const s=[];for(const l of n){const c=l.name&&r?l.name:await this.generateUniqueName(l.name,o),u=fn(),f=Date.now(),p={id:u,name:c,json:l.json,parentFolderID:o,updateTime:f,createTime:f,tags:[]};if(s.push(p),await(V==null?void 0:V.getSetting("twoWaySync")))try{const w=JSON.parse(l.json),h=(i=(a=w==null?void 0:w.extra)==null?void 0:a[Be])==null?void 0:i.id;h&&(await this.get(h)||(p.id=h)),Ge.createWorkflow(p)}catch(w){console.error("batchCreateFlows error",w)}}try{await de.workflows.bulkAdd(s)}catch(l){console.error("batchCreateFlows error",l)}}async deleteFlow(n){const r=await this.get(n);r&&await(V==null?void 0:V.getSetting("twoWaySync"))&&await Ge.deleteWorkflow(r),await de.workflows.delete(n)}async batchDeleteFlow(n){const r=await de.workflows.bulkGet(n);for(const o of r){if(!o)return;await(V==null?void 0:V.getSetting("twoWaySync"))&&await Ge.deleteWorkflow(o)}await de.workflows.bulkDelete(n)}async listFolderContent(n,r){if(await(V==null?void 0:V.getSetting("twoWaySync"))){const l=await th(n??null);return wr(l,r??at.RECENTLY_MODIFIED)}const s=await this.listAll().then(l=>l.filter(c=>c.parentFolderID==n))??[],a=await(lt==null?void 0:lt.listAll().then(l=>l.filter(c=>c.parentFolderID==n)))??[],i=[...s,...a];return wr(i,r??at.RECENTLY_MODIFIED)}async get(n,r=!0){const o=await(V==null?void 0:V.getSetting("twoWaySync")),s=await de.workflows.get(n);if(!o||!r)return s;if(s==null)return;const a=await Ge.getFile({parentFolderID:s.parentFolderID??null,name:s.name,id:s.id});if(a.json)return{...s,json:JSON.stringify(a.json)}}async listAll(n){const r=await(V==null?void 0:V.getSetting("twoWaySync"));let o;if(r){const a=(await Us("",!0)).filter(i=>(i==null?void 0:i.type)==="workflow").map(async i=>{const l=await de.workflows.get(i.id);return i.updateTime=(l==null?void 0:l.updateTime)??Date.now(),l!=null&&l.lastOpenedTime&&(i.lastOpenedTime=l==null?void 0:l.lastOpenedTime),i});o=await Promise.all(a)}else o=await de.workflows.toArray();return n?wr(o,n):o}async updateLastOpenedTime(n){await de.workflows.update(n,{lastOpenedTime:Date.now()})}};Oe(Tr,"TABLE_NAME","workflows");let ns=Tr;var St;(t=>{async function e({parentFolderID:i,name:l}){return Ft(`${i??""}/${l}`)}t.genFolderRelPath=e;async function n(i){await ke("/workspace/folder/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Ft(i.id)})})}t.createFolder=n;async function r(i,l){const u=await(await ke("/workspace/folder/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folder:i,newParentPath:l})})).json();u.error&&alert("Failed to move folder: "+u.error)}t.moveFolder=r;async function o(i){try{return await(await ke("/workspace/folder/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:i})})).text()}catch(l){console.error("Error deleting file:",l)}}t.deleteFolder=o;async function s(i){try{const c=await(await ke("/workspace/file/count_files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:i})})).json();return c.error&&console.error("Error counting files:",c.error),c.count}catch(l){console.error("Error renaming file:",l)}return null}t.genFilesCountInFolder=s;async function a(i,l){try{const u=await(await ke("/workspace/folder/rename",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({absPath:i,newName:l})})).json();u.error&&alert("Failed to rename folder: "+u.error)}catch(c){console.error("Error renaming file:",c)}}t.renameFolder=a})(St||(St={}));const Br=class Br extends Yt{constructor(){super("folders")}static async load(){return new Br}async create(e){const n=await this.generateUniqueName(e.name,e.parentFolderID),r=await(V==null?void 0:V.getSetting("twoWaySync")),o=await St.genFolderRelPath({name:n,parentFolderID:e.parentFolderID??""}),s={id:r?o:fn(),name:n,parentFolderID:e.parentFolderID??null,updateTime:Date.now(),createTime:Date.now(),type:"folder"};return r?await St.createFolder(s):(await de.folders.add(s),this.saveDiskDB()),s}async update(e,n){if(await(V==null?void 0:V.getSetting("twoWaySync")))return"parentFolderID"in n&&await St.moveFolder(e,n.parentFolderID??""),"name"in n&&await St.renameFolder(e,n.name??""),null;const o=await this.get(e);if(o==null)return null;"name"in n&&n.name!=o.name;const s="parentFolderID"in n&&n.parentFolderID!=o.parentFolderID,a={...o,...n};return n.name!=null&&(a.updateTime=Date.now()),s&&(n.name=await this.generateUniqueName(a.name,a.parentFolderID??void 0)),await de.folders.update(e,n),this.saveDiskDB(),a}async deleteFolder(e,n=gr.DELETE){if(await(V==null?void 0:V.getSetting("twoWaySync"))){await Us(e,!0,!0).then(i=>{i.forEach(l=>{l.type==="workflow"&&(K==null||K.deleteFlow(l.id))})}),await St.deleteFolder(e);return}const o=await(K==null?void 0:K.listAll())??[],s=await this.listAll(),a=[e];for(;a.length>0;){const i=a.shift();if(i){for(const c of o)if(c.parentFolderID===i)switch(n){case gr.DELETE:await(K==null?void 0:K.deleteFlow(c.id));break;case gr.MOVE_TO_ROOT_FOLDER:await(K==null?void 0:K.updateFolder(c.id,{parentFolderID:void 0}));break}await de.folders.delete(i);const l=s.filter(c=>c.parentFolderID===i).map(c=>c.id);l.length&&a.push(...l)}}this.saveDiskDB()}async generateUniqueName(e,n){if(await(V==null?void 0:V.getSetting("twoWaySync")))return await Ge.genFileUniqueName(e??"New folder",n??"")??"New folder";let o=e??"New folder";const s=await this.listAll().then(a=>a.filter(i=>i.parentFolderID==n).map(i=>i.name));if(s.includes(o)){let a=2,i=!0;for(;i;)s.includes(`${o} ${a}`)?a++:(o=`${o} ${a}`,i=!1)}return o}};Oe(Br,"TABLE_NAME","folders");let rs=Br;class nl extends Yt{constructor(){super("media")}async listByWorkflowID(e){return await de.media.where("workflowID").equals(e).reverse().sortBy("createTime")}async create(e){if(e.localPath.split(".").pop()==null)return null;const r={id:e.localPath,localPath:e.localPath,workflowID:e.workflowID,createTime:Date.now()};return await(K==null?void 0:K.updateMetaInfo(e.workflowID,{latestImage:r.localPath})),de.media.put(r),r}async delete(e){var n,r;super.delete(e),((n=K==null?void 0:K.curWorkflow)==null?void 0:n.coverMediaPath)===e&&(K==null||K.updateMetaInfo(K.curWorkflow.id,{coverMediaPath:void 0})),((r=K==null?void 0:K.curWorkflow)==null?void 0:r.latestImage)===e&&(K==null||K.updateMetaInfo(K.curWorkflow.id,{latestImage:void 0}))}}Oe(nl,"TABLE_NAME","media");const Dp=["Checkpoint","TextualInversion","Hypernetwork","LORA","Controlnet","Upscaler","VAE"],Pp=2,rh={Checkpoint:"checkpoints",TextualInversion:"embeddings",Hypernetwork:"hypernetworks",LORA:"loras",Controlnet:"controlnet",Upscaler:"upscale_models",VAE:"vae"};function jp(t){return t.modelVersions!==void 0}function oh(t){var e;return((e=t.files)==null?void 0:e[0])!==void 0}function Ap(t,e){var r,o,s,a,i,l;if(!t)return;let n;return oh(t)?n={id:t.id,SHA256:(o=(r=t.files)==null?void 0:r[0].hashes)==null?void 0:o.SHA256,name:(s=t.files)==null?void 0:s[0].name,sizeKB:(i=(a=t.files)==null?void 0:a[0])==null?void 0:i.sizeKB}:n={id:t.id,SHA256:(l=t.hashes)==null?void 0:l[2],name:`${e} ${t.name}`},n}const Mr=class Mr extends Yt{constructor(){super("userSettings");Oe(this,"defaultSettings");Oe(this,"DEFAULT_USER","guest");Oe(this,"_settings");this.defaultSettings={id:this.DEFAULT_USER,topBarStyle:{top:0,left:0},myWorkflowsDir:"",shortcuts:{save:"Shift+S",saveAs:"Control+Alt+S",openSpotlightSearch:"Control+P"},defaultFolders:rh,autoSave:!1,autoSaveDuration:3,twoWaySync:!1,foldersOnTop:!1,cloudHost:"https://www.nodecafe.co",maximumChangelogNumber:80,hideCoverImage:!1,disableUnsavedWarning:!1}}get settings(){return this._settings}async getSetting(n){const r=await this.get(this.DEFAULT_USER);return n==="shortcuts"&&(r!=null&&r.shortcuts)?{...this.defaultSettings.shortcuts,...r.shortcuts}:(r==null?void 0:r[n])??this.defaultSettings[n]}async get(n){return await ke("/workspace/get_settings",{headers:{"Content-Type":"application/json"}}).then(o=>o.json())}async upsert(n){const o={...await this.get(this.DEFAULT_USER)??this.defaultSettings,...n};await ke("/workspace/save_settings",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}),this._settings={...this.defaultSettings,...o}}static async load(){var o,s,a,i;const n=new Mr,r=await Gd();return n.defaultSettings.myWorkflowsDir=r.path,await n.get(n.DEFAULT_USER).then(l=>{n._settings={...n.defaultSettings,...l}}),((s=(o=n._settings)==null?void 0:o.cloudHost)!=null&&s.includes("nodecafe.org")||(i=(a=n._settings)==null?void 0:a.cloudHost)!=null&&i.includes("comfyspace.art"))&&await n.upsert({cloudHost:n.defaultSettings.cloudHost}),n}};Oe(Mr,"TABLE_NAME","userSettings");let os=Mr;const zr=class zr extends Yt{constructor(){super("tags")}static async load(){return new zr}};Oe(zr,"TABLE_NAME","tags");let ss=zr;const Lr=class Lr extends Yt{constructor(){super("workflowVersions")}static async load(){return new Lr}async listByWorkflowID(e){return await de[this.tableName].where("workflowID").equals(e).reverse().sortBy("createTime")??[]}async getLatestByWorkflowID(e){const n=await this.listByWorkflowID(e);return n!=null&&n.length?n[0]:null}};Oe(Lr,"TABLE_NAME","workflowVersions");let as=Lr;function sh(t){return"type"in t&&t.type==="folder"}let K=null,ah=null,V=null,lt=null,ct=null,_r=null,Ne=null;async function ih(){const t=async()=>{K=await ns.load()},e=async()=>{ah=await ss.load()},n=async()=>{V=await os.load()},r=async()=>{lt=await rs.load()},o=async()=>{ct=await ts.load()},s=async()=>{_r=new nl},a=async()=>{Ne=await as.load()};await Promise.all([t(),e(),n(),r(),o(),s(),a()])}const tt=A.createContext({curFlowID:null,loadWorkflowID:()=>{},saveCurWorkflow:async()=>{},discardUnsavedChanges:async()=>{},isDirty:!1,loadNewWorkflow:()=>{},loadFilePath:()=>{},setRoute:()=>{},route:"root",curVersion:null,setIsDirty:()=>{},setCurVersion:()=>{},setCurFlowIDAndName:()=>{},session:null,updateSession:()=>{}}),Np=A.createContext({refreshFolderStamp:0,setRefreshFolderStamp:()=>{}}),wo={x:0,y:0};function lh({children:t,onDragEnd:e,dragIconId:n}){const r=A.useRef(wo),o=A.useRef(!1),[s,a]=A.useState(wo),i=f=>{var p,d,w;if(!(!(f.target instanceof Element)||!(f.target.parentNode instanceof Element))&&[(p=f.target)==null?void 0:p.id,(w=(d=f.target)==null?void 0:d.parentNode)==null?void 0:w.id].includes(n)){r.current={x:f.clientX,y:f.clientY},o.current=!0,window.addEventListener("mousemove",l),window.addEventListener("mouseup",c);const h=document.getElementsByTagName("body")[0];h.style.userSelect="none"}},l=A.useCallback(f=>{const p={x:f.clientX-r.current.x,y:f.clientY-r.current.y};a(p)},[]),c=A.useCallback(()=>{a(p=>(setTimeout(()=>{e(p)},0),wo)),o.current=!1;const f=document.getElementsByTagName("body")[0];f.style.userSelect="auto",window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",c)},[e,l]),u={transform:`translate(${s.x}px, ${s.y}px)`,zIndex:o.current?1e3:1};return C.jsx("div",{style:u,onMouseDown:i,children:t})}var ch={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},uh=Object.defineProperty,dh=Object.defineProperties,fh=Object.getOwnPropertyDescriptors,Nr=Object.getOwnPropertySymbols,rl=Object.prototype.hasOwnProperty,ol=Object.prototype.propertyIsEnumerable,xa=(t,e,n)=>e in t?uh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ka=(t,e)=>{for(var n in e||(e={}))rl.call(e,n)&&xa(t,n,e[n]);if(Nr)for(var n of Nr(e))ol.call(e,n)&&xa(t,n,e[n]);return t},hh=(t,e)=>dh(t,fh(e)),ph=(t,e)=>{var n={};for(var r in t)rl.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Nr)for(var r of Nr(t))e.indexOf(r)<0&&ol.call(t,r)&&(n[r]=t[r]);return n},Re=(t,e,n)=>{const r=A.forwardRef((o,s)=>{var a=o,{color:i="currentColor",size:l=24,stroke:c=2,children:u}=a,f=ph(a,["color","size","stroke","children"]);return A.createElement("svg",ka(hh(ka({ref:s},ch),{width:l,height:l,stroke:i,strokeWidth:c,className:`tabler-icon tabler-icon-${t}`}),f),[...n.map(([p,d])=>A.createElement(p,d)),...u||[]])});return r.propTypes={color:Bt.string,size:Bt.oneOfType([Bt.string,Bt.number]),stroke:Bt.oneOfType([Bt.string,Bt.number])},r.displayName=`${e}`,r},mh=Re("arrow-back-up-double","IconArrowBackUpDouble",[["path",{d:"M13 14l-4 -4l4 -4",key:"svg-0"}],["path",{d:"M8 14l-4 -4l4 -4",key:"svg-1"}],["path",{d:"M9 10h7a4 4 0 1 1 0 8h-1",key:"svg-2"}]]),yh=Re("chevron-down","IconChevronDown",[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]]),Fr=Re("device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]]),vh=Re("download","IconDownload",[["path",{d:"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M7 11l5 5l5 -5",key:"svg-1"}],["path",{d:"M12 4l0 12",key:"svg-2"}]]),gh=Re("external-link","IconExternalLink",[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]]),wh=Re("folder","IconFolder",[["path",{d:"M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2",key:"svg-0"}]]),bh=Re("grip-vertical","IconGripVertical",[["path",{d:"M9 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M9 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-1"}],["path",{d:"M9 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-2"}],["path",{d:"M15 5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-3"}],["path",{d:"M15 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-4"}],["path",{d:"M15 19m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-5"}]]),_h=Re("history","IconHistory",[["path",{d:"M12 8l0 4l2 2",key:"svg-0"}],["path",{d:"M3.05 11a9 9 0 1 1 .5 4m-.5 5v-5h5",key:"svg-1"}]]),sl=Re("link","IconLink",[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]]),al=Re("lock","IconLock",[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]]),xh=Re("message","IconMessage",[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]]),kh=Re("photo","IconPhoto",[["path",{d:"M15 8h.01",key:"svg-0"}],["path",{d:"M3 6a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v12a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3v-12z",key:"svg-1"}],["path",{d:"M3 16l5 -5c.928 -.893 2.072 -.893 3 0l5 5",key:"svg-2"}],["path",{d:"M14 14l1 -1c.928 -.893 2.072 -.893 3 0l3 3",key:"svg-3"}]]),Eh=Re("share-2","IconShare2",[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]]),Ch=Re("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]),il=Re("triangle-inverted-filled","IconTriangleInvertedFilled",[["path",{d:"M20.118 3h-16.225a2.914 2.914 0 0 0 -2.503 4.371l8.116 13.549a2.917 2.917 0 0 0 4.987 .005l8.11 -13.539a2.914 2.914 0 0 0 -2.486 -4.386z",fill:"currentColor",key:"svg-0",strokeWidth:"0"}]]),Sh=Re("versions","IconVersions",[["path",{d:"M10 5m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M7 7l0 10",key:"svg-1"}],["path",{d:"M4 8l0 8",key:"svg-2"}]]),Ih=Re("world","IconWorld",[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M3.6 9h16.8",key:"svg-1"}],["path",{d:"M3.6 15h16.8",key:"svg-2"}],["path",{d:"M11.5 3a17 17 0 0 0 0 18",key:"svg-3"}],["path",{d:"M12.5 3a17 17 0 0 1 0 18",key:"svg-4"}]]),Oh=Re("x","IconX",[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]]);function Dh(t){const{promptMessage:e="Are you sure you want to delete this?",variant:n="ghost",onDelete:r,isDisabled:o=!1,tooltipText:s}=t;return C.jsx(di,{isLazy:!0,placement:"auto",gutter:0,children:({onClose:a})=>C.jsxs(C.Fragment,{children:[C.jsx(ui,{children:C.jsx(Dt,{children:C.jsx(Pt,{hasArrow:!0,label:s,placement:"bottom",children:C.jsx(An,{"aria-label":"Delete confirm",size:"sm",icon:C.jsx(Ch,{color:"#F56565",size:"20px"}),isDisabled:o,variant:n})})})}),C.jsxs(mi,{children:[C.jsx(hi,{onClick:a}),C.jsxs(fi,{children:[C.jsx(yt,{mb:4,pr:4,fontWeight:600,children:e}),C.jsx(Te,{colorScheme:"red",size:"sm",onClick:()=>{r(),a()},children:"Yes, delete"})]})]})]})})}function Ph({onClose:t}){var k;const{isDirty:e,loadWorkflowID:n,curVersion:r,session:o}=A.useContext(tt),[s,a]=A.useState(0),[i,l]=A.useState(null),[c,u]=A.useState([]),[f,p]=A.useState([]),d=K==null?void 0:K.curWorkflow,w=(k=V==null?void 0:V.settings)==null?void 0:k.cloudHost,[h,y]=A.useState(!1),m=async x=>{var R;const I=await(K==null?void 0:K.get(x)),E=await(ct==null?void 0:ct.listByWorkflowID(x));u(E??[]);const N=E==null?void 0:E.filter(H=>H.json===(I==null?void 0:I.json)),D=(R=N==null?void 0:N[0])==null?void 0:R.id;D&&l(D)},v=async()=>{var I;let x=await(Ne==null?void 0:Ne.listByWorkflowID(d.id))??[];o!=null&&o.shareKey&&(d!=null&&d.cloudID)&&(y(!0),await fetch(((I=V==null?void 0:V.settings)==null?void 0:I.cloudHost)+"/api/listWorkflowVersionsByWorkflowID?workflowID="+(d==null?void 0:d.cloudID),{headers:{authorization:`Bearer ${o==null?void 0:o.shareKey}`}}).then(E=>E.json()).then(E=>{if(E.items){const N=E.items.map(D=>({...D,isCloud:!0}));x=x.concat(N)}}).catch(E=>{console.error(E)}),y(!1)),p(x)},_=x=>{Ne==null||Ne.delete(x).then(()=>{v()})};return A.useEffect(()=>{switch(s){case 0:v();break;case 1:m(d.id);break}},[s]),A.useEffect(()=>(Se.canvasEl.addEventListener("click",t),()=>{Se.canvasEl.removeEventListener("click",t)}),[s]),C.jsxs(Gl,{width:430,height:"100vh",gap:0,position:"fixed",top:0,left:0,zIndex:1e3,children:[C.jsx(Zl,{pb:1,mb:0,children:C.jsxs(rn,{justifyContent:"space-between",alignItems:"center",children:[C.jsx(hs,{size:"md",children:"Version History"}),C.jsx(An,{size:"sm",icon:C.jsx(Oh,{}),onClick:t,variant:"ghost","aria-label":"close version history"})]})}),C.jsx(Vl,{overflowY:"auto",gap:0,children:C.jsxs(gi,{isFitted:!0,variant:"enclosed",onChange:a,colorScheme:"teal",children:[C.jsxs(wi,{mb:"1em",children:[C.jsx(Oo,{children:"Versions"}),C.jsx(Oo,{children:"Change History"})]}),C.jsxs(bi,{children:[C.jsxs(Io,{children:[(o==null?void 0:o.shareKey)&&C.jsxs(yt,{color:"GrayText",mb:3,children:["Connected to"," ",C.jsx("a",{href:w,target:"_blank",children:w})]}),C.jsxs(It,{divider:C.jsx(ko,{}),spacing:2,children:[h&&C.jsx(yt,{children:"Loading..."}),f==null?void 0:f.map(x=>C.jsxs(rn,{w:"100%",mb:1,justify:"space-between",backgroundColor:x.id===(r==null?void 0:r.id)?"teal.300":void 0,borderRadius:4,children:[C.jsxs(It,{textAlign:"left",gap:0,children:[x.isCloud?C.jsx("a",{target:"_blank",href:`${w}/workflow/${x.workflowID}/${x.id}`,children:x.name??"untitled"}):C.jsx(yt,{fontWeight:"500",children:x.name??"untitled"}),C.jsxs(yt,{color:"GrayText",fontSize:"sm",children:["Created:"," ",new Date(x.createTime??x.createdAt??x.created_at??"").toLocaleString()]})]}),C.jsxs(rn,{alignItems:"center",gap:2,children:[C.jsx(Te,{size:"sm",onClick:()=>{if(e){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}Se.loadGraphData(JSON.parse(x.json)),t()},children:"Load"}),!x.isCloud&&C.jsx(Dh,{promptMessage:"Are you sure you want to delete this version?",onDelete:()=>{_(x.id)}})]})]},x.id))]})]}),C.jsxs(Io,{children:[C.jsx(yt,{mb:4,children:"All the saved changes of this workflow"}),C.jsx(It,{divider:C.jsx(ko,{}),spacing:2,children:c==null?void 0:c.map(x=>C.jsxs(Ot,{justifyContent:"space-between",children:[C.jsxs(Te,{size:"sm",variant:"ghost",onClick:()=>{if(e){alert("You have unsaved changes, please save or discard your changes to proceed switching version, in case losing your changes.");return}Se.loadGraphData(JSON.parse(x.json)),t()},isActive:x.id===i,children:["Saved at ",new Date(x.createTime).toLocaleString()]},x.id),x.isAutoSave?C.jsx(eo,{colorScheme:"teal",size:"sm",children:"Auto save"}):null]},x.id))})]})]})]})})]})}var jh={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const ll=jh.VITE_SHARE_KEY_ENCODE_KEY;function Ah(t,e=ll){const n=Math.floor(Math.random()*13)+1,o=Math.random().toString(36).substring(2,2+n)+e+t;return btoa(encodeURIComponent(o))}function Nh(t,e=ll){const n=decodeURIComponent(atob(t)),r=n.indexOf(e);if(r===-1)throw new Error("Invalid encoded string or salt");return n.slice(r+e.length)}function Fh(t){const e=Ah(t);localStorage.setItem("workspace_manager_shareKey",e)}function Rh({onClose:t}){var o;const e=(o=V==null?void 0:V.settings)==null?void 0:o.cloudHost,n=Un(),{updateSession:r}=A.useContext(tt);return C.jsx($r,{isOpen:!0,onClose:t,size:"xl",children:C.jsx(Hr,{width:"90vw",children:C.jsx(qr,{children:C.jsxs(It,{p:"10px 10px",gap:3,children:[C.jsx("h2",{style:{fontSize:"1.2rem",fontWeight:"bold"},children:"✨New Version Control Exprience [beta]"}),C.jsxs("p",{children:["We have a new version control experience. Now your versions will be stored ",C.jsx("b",{children:"privately"})," and securely in cloud at"," ",C.jsx("a",{href:"www.nodecafe.co",children:"www.nodecafe.co"})]}),C.jsx("h3",{style:{fontWeight:"bold"},children:"Why cloud?"}),C.jsx("p",{children:"Previously workflow versions are stored locally in your browser storage. But people reported inconsistent versions when they switched browser or device. Therefore we are moving to cloud. So you can view your workflow versions from any devices, even your phone."}),C.jsx("h3",{style:{fontWeight:"bold"},children:"🤩Get Started"}),C.jsxs(rn,{alignItems:"center",gap:2,mb:3,children:[C.jsx("a",{href:e+"/auth/shareKey",target:"_blank",children:C.jsx(Te,{colorScheme:"blue",children:"Login"})}),C.jsx("p",{children:" then copy your share key to below"})]}),C.jsx(mn,{placeholder:"Paste your share key here",onChange:s=>{!s.target.value||s.target.value===""||s.target.value.length<20||(Fh(s.target.value),r({shareKey:s.target.value,username:null}),n({title:"Share key saved. You can create versions now.",status:"success",duration:5e3}))}})]})})})})}function Fp(t){const e=new Uint8Array(t);return window.crypto.getRandomValues(e),Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}const Rp=[{label:"Private",value:"PRIVATE",icon:C.jsx(al,{})},{label:"Unlisted, anyone with the link can view",value:"UNLISTED",icon:C.jsx(sl,{})},{label:"Public",value:"PUBLIC",icon:C.jsx(Ih,{})}],cl=()=>{const t=Se.graph._nodes,e={};for(let n of t)if(n.type in LiteGraph.registered_node_types){const r=structuredClone(LiteGraph.registered_node_types[n.type].nodeData);if(r==null)continue;for(let o in r.input){const s=r.input[o];for(let a in s){const i=s[a];Array.isArray(i[0])&&(i[0]=["value_1","value_2"])}}e[n.type]=r}return e};async function Th(t){var n;const e=(n=V==null?void 0:V.settings)==null?void 0:n.cloudHost;return fetch(e+`/api/getWorkflow?id=${t.cloudID}`).then(r=>r.json()).then(r=>{var s;return((s=r.data)==null?void 0:s.privacy)??"PRIVATE"})}function Tp({privacy:t,showEmoji:e=!1}){let n;return t==="PRIVATE"?(n="Private",e&&(n="🔒 Private")):t==="UNLISTED"?(n="Unlisted",e&&(n="🔗 Unlisted")):t==="PUBLIC"&&(n="Public",e&&(n="🌐 Public")),C.jsx("span",{children:n})}function Bh(){const t=new Date,e=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${n}`}function Mh({onClose:t}){var p;const[e,n]=A.useState("v"+Bh()),[r,o]=A.useState(""),{session:s}=A.useContext(tt),a=Un(),[i,l]=A.useState(!1),c=d=>{n(d.target.value),r&&o("")},u=async()=>{var m,v,_;const d=e.trim();if(n(d),!(K!=null&&K.curWorkflow))throw new Error("No workflow selected");l(!0);const w=await Se.graphToPrompt(),h=Se.graph.serialize();h.extra||(h.extra={}),h.extra.apiPrompt=w.output??null;const y={workflow:{name:(m=K==null?void 0:K.curWorkflow)==null?void 0:m.name,cloudID:(v=K==null?void 0:K.curWorkflow)==null?void 0:v.cloudID},version:{name:d,json:JSON.stringify(h)},nodeDefs:cl(),privacy:zs.PRIVATE};await fetch(((_=V==null?void 0:V.settings)==null?void 0:_.cloudHost)+"/api/createCloudflow",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s==null?void 0:s.shareKey}`},body:JSON.stringify(y)}).then(k=>k.json()).then(async k=>{var x;if(k!=null&&k.data){const I=k.data.workflowID;await(K==null?void 0:K.updateMetaInfo((x=K==null?void 0:K.curWorkflow)==null?void 0:x.id,{cloudID:I})),a({title:"Version created",status:"success",duration:3e3}),t()}else o("Failed to create version. "+((k==null?void 0:k.error)??""))}).catch(k=>(o("Failed to create version"),null)),l(!1)};if(!(s!=null&&s.shareKey))return C.jsx(Rh,{onClose:t});const f=new URL(V.settings.cloudHost).hostname;return C.jsx($r,{isOpen:!0,onClose:t,children:C.jsxs(Hr,{children:[C.jsx(cs,{}),C.jsxs(qr,{children:[C.jsxs(It,{mb:5,children:[C.jsx("p",{style:{fontSize:20,fontWeight:"bold"},children:"Create Version"}),C.jsxs("p",{style:{color:"GrayText"},children:["Saving to"," ",C.jsxs("a",{href:(p=V==null?void 0:V.settings)==null?void 0:p.cloudHost,children:[" ",f]})]})]}),C.jsxs(Vr,{isInvalid:!!r,children:[C.jsx(Gr,{children:"Name"}),C.jsx(mn,{value:e,onChange:c,autoFocus:!0,onKeyUp:d=>{d.code==="Enter"&&!r&&e&&u()}}),r&&C.jsx(Zr,{children:r})]})]}),C.jsxs(us,{children:[C.jsx(Te,{colorScheme:"teal",mr:3,onClick:u,isDisabled:!e,isLoading:i,children:"Create"}),C.jsx(Te,{onClick:t,children:"Cancel"})]})]})})}function zh({options:t,menuButton:e,isOpen:n,onClose:r}){const o=A.useRef(null);return bc({ref:o,handler:()=>r()}),C.jsxs(Dt,{position:"relative",children:[C.jsx(Dt,{children:e}),n&&C.jsx(Dt,{ref:o,mt:"8px",shadow:"md",p:"2",position:"absolute",zIndex:"dropdown",children:t})]})}function Lh({menuButton:t,menuContent:e,onClose:n}){const r=A.useRef(),[o,s]=A.useState(!1),a=()=>{r.current=setTimeout(()=>s(!1),400)},i=()=>{s(!0),clearTimeout(r.current),r.current=void 0};return C.jsx(zh,{isOpen:o,onClose:a,menuButton:C.jsx(Dt,{"aria-label":"menu",onClick:i,onMouseEnter:i,onMouseLeave:a,children:t}),options:C.jsx(Es,{isOpen:!0,children:C.jsx(Cs,{minWidth:150,zIndex:1e3,onMouseEnter:i,onMouseLeave:a,children:e})})})}function Wh(t,e){const n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=`${e}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}function Uh({}){const[t,e]=A.useState(),[n,r]=A.useState(),{curFlowID:o}=A.useContext(tt);return A.useEffect(()=>{o&&(K==null||K.get(o).then(s=>{s!=null&&s.cloudID?(e(s.cloudOrigin+"/workflow/"+s.cloudID),Th(s).then(a=>{r(a)})):e(void 0)}))},[o]),t?C.jsx("a",{href:t,style:{textDecoration:"none"},target:"_blank",children:C.jsx(Oa,{children:C.jsx(eo,{children:n==="PUBLIC"?"🌐":n==="UNLISTED"?"🔗":"🔒"})})}):null}async function Kh(t,e){var s,a;if(e.cloudID)return{link:((s=V==null?void 0:V.settings)==null?void 0:s.cloudHost)+"/workflow/"+e.cloudID};const n=await Se.graphToPrompt(),r=Se.graph.serialize();r.extra||(r.extra={}),r.extra.apiPrompt=n.output??null;const o={workflow:{name:(e==null?void 0:e.name)??"Untitled",cloudID:e==null?void 0:e.cloudID},version:{name:"v1",json:JSON.stringify(r)},nodeDefs:cl(),privacy:zs.UNLISTED};return await fetch(((a=V==null?void 0:V.settings)==null?void 0:a.cloudHost)+"/api/createCloudflow",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(o)}).then(i=>i.json()).then(i=>{var l;if(i!=null&&i.data){const c=i.data.workflowID;return K==null||K.updateMetaInfo(e==null?void 0:e.id,{cloudID:c}),{link:((l=V==null?void 0:V.settings)==null?void 0:l.cloudHost)+"/workflow/"+c}}else return{error:"Failed to create version. "+((i==null?void 0:i.error)??"")}}).catch(i=>({error:"Failed to create version. "+((i==null?void 0:i.error)??"")}))}function $h({curFlow:t}){const{session:e}=A.useContext(tt),n=Un(),[r,o]=A.useState(!1);return C.jsx(pt,{onClick:async()=>{if(!t)return;if(!(e!=null&&e.shareKey)){alert("Please set your share key first in Settings to enable cloud share.");return}o(!0);const s=await Kh(e.shareKey,t);s!=null&&s.link?(navigator.clipboard.writeText(s.link),n({title:"Link copied",status:"success",duration:2e3})):n({title:"Failed to copy link",status:"error",description:s==null?void 0:s.error,duration:null}),o(!1)},icon:r?C.jsx(Al,{}):C.jsx(sl,{size:20}),iconSpacing:1,alignItems:"center",isDisabled:r,children:C.jsx(Ot,{children:C.jsx("p",{children:"Copy share link"})})})}const Hh=A.lazy(()=>Zt(()=>import("./ShareDialog-fFfeioXS.js"),__vite__mapDeps([0,1,2,3,4,5])));function qh(){const{curFlowID:t,loadWorkflowID:e,discardUnsavedChanges:n,saveCurWorkflow:r,setRoute:o,route:s,session:a}=A.useContext(tt),[i,l]=A.useState(!1),[c,u]=A.useState(""),[f,p]=A.useState(""),[d,w]=A.useState(),[h,y]=A.useState({save:"",saveAs:""});A.useEffect(()=>{t&&(K==null||K.get(t).then(x=>{u((x==null?void 0:x.name)??""),w(x)})),V==null||V.getSetting("shortcuts").then(x=>{y(x)})},[t]);const m=x=>{u(x.target.value),f&&p("")};Un();const v=async()=>{if(!t){alert("Flow ID is required");return}const x=JSON.stringify(Se.graph.serialize()),I=await(K==null?void 0:K.createFlow({json:x,name:c,parentFolderID:d==null?void 0:d.parentFolderID}));I&&await e(I.id,null,!0),_()},_=()=>{o("root")},k=A.useCallback(async()=>{const x=K==null?void 0:K.curWorkflow;if(!x){alert("No current workflow!");return}const I=Se.graph.serialize(),E=JSON.stringify(I,null,2);Wh(E,x.name)},[t]);return C.jsxs(C.Fragment,{children:[C.jsx(Lh,{menuButton:C.jsx(Oa,{children:C.jsxs(Te,{px:1,height:Ls+"px","aria-label":"menu",size:"sm",backgroundColor:"#434554",children:["File",C.jsx(yh,{size:20})]})}),menuContent:C.jsx(Es,{isOpen:!0,children:C.jsxs(Cs,{minWidth:150,zIndex:1e3,children:[C.jsx(pt,{onClick:()=>r(),icon:C.jsx(Fr,{size:20}),iconSpacing:1,command:h.save,children:"Save"}),C.jsx(Pt,{label:"Revert workflow to your last saved version. You will lose all changes made since your last save.",children:C.jsx(pt,{onClick:n,icon:C.jsx(mh,{size:20}),iconSpacing:1,children:"Discard unsaved changes"})}),C.jsx(pt,{onClick:k,icon:C.jsx(vh,{size:20}),iconSpacing:1,children:"Download"}),C.jsx(pt,{onClick:()=>o("saveAsModal"),icon:C.jsx(Fr,{size:20}),iconSpacing:1,command:h.saveAs,children:"Save As"}),C.jsx(pt,{onClick:()=>l(!0),icon:C.jsx(Sh,{size:20}),iconSpacing:1,children:"Create Version"}),C.jsx(pt,{onClick:()=>o("versionHistory"),icon:C.jsx(_h,{size:20}),iconSpacing:1,children:"Versions History"}),C.jsx(pt,{onClick:()=>o("share"),icon:C.jsx(Eh,{size:20}),iconSpacing:1,alignItems:"center",children:C.jsxs(Ot,{children:[C.jsx("p",{children:"Share"})," ",C.jsx(eo,{size:"sm",children:"🧪beta"}),C.jsx(Uh,{})]})}),(K==null?void 0:K.curWorkflow)&&C.jsx($h,{curFlow:K==null?void 0:K.curWorkflow})]})})}),s==="share"&&C.jsx(Hh,{onClose:()=>o("root")}),s=="versionHistory"&&C.jsx(Ph,{onClose:()=>o("root")}),s==="saveAsModal"&&C.jsxs($r,{isOpen:!0,onClose:_,children:[C.jsx(Da,{}),C.jsxs(Hr,{children:[C.jsx(Pa,{children:"Save As"}),C.jsx(cs,{}),C.jsx(qr,{children:C.jsxs(Vr,{isInvalid:!!f,children:[C.jsx(Gr,{children:"Workflow name"}),C.jsx(mn,{value:c,onChange:m,autoFocus:!0,onKeyUp:x=>{x.code==="Enter"&&!f&&c&&v()}}),f&&C.jsx(Zr,{children:f})]})}),C.jsxs(us,{children:[C.jsx(Te,{colorScheme:"teal",mr:3,onClick:v,isDisabled:!c||!!f,children:"Save"}),C.jsx(Te,{onClick:_,children:"Cancel"})]})]})]}),i&&C.jsx(Mh,{workflowId:t,onClose:()=>l(!1)})]})}function Vh({displayName:t,updateFlowName:e,isDirty:n}){const{isOpen:r,onOpen:o,onClose:s}=kc(),{curFlowID:a}=A.useContext(tt),[i,l]=A.useState(t),[c,u]=A.useState(""),f=()=>{l(t),o()},p=h=>{l(h.target.value),c&&u("")},d=async()=>{var h;if(a){const y=i.trim();if(l(y),t===y)return w();await(K==null?void 0:K.generateUniqueName(y,((h=K.curWorkflow)==null?void 0:h.parentFolderID)??""))!==y?u("The name is duplicated, please modify it and submit again."):(await(K==null?void 0:K.updateName(a,{name:y})),e(y),w())}},w=()=>{u(""),s()};return a==null?null:C.jsxs(Ot,{children:[C.jsx(Pt,{label:t,placement:"bottom",children:C.jsxs(yt,{as:"div",color:"white",onClick:f,maxW:160,fontWeight:500,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:[C.jsx("div",{style:{width:8,display:"inline-block"},children:C.jsx(yt,{as:"span",children:n&&"* "})}),t]})}),C.jsxs($r,{isOpen:r,onClose:w,children:[C.jsx(Da,{}),C.jsxs(Hr,{children:[C.jsx(Pa,{children:"Edit workflow name"}),C.jsx(cs,{}),C.jsx(qr,{children:C.jsxs(Vr,{isInvalid:!!c,children:[C.jsx(Gr,{children:"Workflow name"}),C.jsx(mn,{value:i,onChange:p,autoFocus:!0,onKeyUp:h=>{h.code==="Enter"&&!c&&i&&d()}}),c&&C.jsx(Zr,{children:c})]})}),C.jsxs(us,{children:[C.jsx(Te,{colorScheme:"teal",mr:3,onClick:d,isDisabled:!i||!!c,children:"Save"}),C.jsx(Te,{onClick:w,children:"Cancel"})]})]})]})]})}function Zh({}){const{setRoute:t,curVersion:e,isDirty:n,setCurVersion:r}=A.useContext(tt);return A.useEffect(()=>{n&&e&&(e==null?void 0:e.name.endsWith("*"))===!1&&(r==null||r({...e,name:e.name+"*"}))},[n]),e?C.jsx(rn,{alignItems:"center",children:C.jsx(Ta,{size:"sm",isAttached:!0,variant:"outline",children:C.jsx(Te,{rightIcon:C.jsx(il,{size:10}),onClick:()=>t("versionHistory"),children:e.name})})}):null}function Gh(){const{setCurFlowIDAndName:t,curFlowID:e}=A.useContext(tt),n=async()=>{const r=prompt("Enter workflow name","Untitled");if(!r)return;const o=fn(),s=Se.graph.serialize();s.extra||(s.extra={}),s.extra[Be]||(s.extra[Be]={}),s.extra[Be].id=o;const a=await(K==null?void 0:K.createFlow({id:o,json:JSON.stringify(s),name:r}));a&&t(a)};return e?null:C.jsx(Pt,{label:"Save workflow",children:C.jsx(Te,{size:"sm",variant:"outline",colorScheme:"teal","aria-label":"new workflow",height:Ls+"px",onClick:()=>n(),px:1,children:C.jsx(Fr,{size:16,color:"white"})})})}const Yh=A.lazy(()=>Zt(()=>import("./AppIsDirtyEventListener-fgtmiWGE.js"),__vite__mapDeps([6,1,7]))),Jh=A.lazy(()=>Zt(()=>import("./ModelManagerTopbar-feTKvyin.js"),__vite__mapDeps([8,1,3,2,9,10,11]))),Xh=A.lazy(()=>Zt(()=>import("./SpotlightSearch-cM79l8wS.js"),__vite__mapDeps([12,1,7,13,14])));function Qh({curFlowName:t,setCurFlowName:e,onChatClick:n,showChat:r}){var p;const{isDirty:o,saveCurWorkflow:s,setRoute:a,curFlowID:i,route:l}=A.useContext(tt),[c,u]=A.useState(),f=A.useCallback((d,w=!1)=>{const{top:h=0,left:y=0}=c||{};let{top:m=0,left:v=0}=d??{};m+=h,v+=y;const _=document.documentElement.clientWidth,k=document.documentElement.clientHeight,x=document.getElementById("workspaceManagerPanel"),I=(x==null?void 0:x.offsetWidth)||392;m+36>k&&(m=k-36),v+I>=_&&(v=_-I),u({top:Math.max(0,m),left:Math.max(0,v)}),w&&(V==null||V.upsert({topBarStyle:{top:m,left:v}}))},[c]);return A.useEffect(()=>{V==null||V.getSetting("topBarStyle").then(d=>{f(d,!1)})},[]),c?C.jsx(lh,{onDragEnd:d=>{f({top:d.y,left:d.x},!0)},dragIconId:"dragPanelIcon",children:C.jsxs(Ot,{style:{padding:2,position:"fixed",...c},justifyContent:"space-between",alignItems:"center",gap:2,draggable:!1,id:"workspaceManagerPanel",className:"workspaceManagerPanel",children:[C.jsx(Te,{size:"sm","aria-label":"workspace folder",height:Ls+"px",onClick:()=>a("recentFlows"),px:2,children:C.jsxs(Ot,{gap:1,children:[C.jsx(wh,{size:21}),C.jsx(il,{size:8})]})}),C.jsx(A.Suspense,{fallback:C.jsx("div",{style:{width:"60px"}}),children:C.jsx(Jh,{})}),C.jsx(Gh,{}),C.jsx(Vh,{isDirty:o,displayName:t??"",updateFlowName:d=>{e(d),requestAnimationFrame(()=>{f()})}}),((p=K==null?void 0:K.curWorkflow)==null?void 0:p.saveLock)&&C.jsx(al,{color:"#FFF",size:20}),i&&C.jsxs(Ot,{gap:"4px",children:[C.jsx(Pt,{label:"Open gallery",children:C.jsx(An,{onClick:()=>a("gallery"),icon:C.jsx(kh,{size:22,color:"white"}),size:"sm","aria-label":"open gallery",variant:"ghost"})}),C.jsx(qh,{})]}),i&&o?C.jsx(Pt,{label:"Save workflow",children:C.jsx(An,{onClick:()=>s(),icon:C.jsx(Fr,{size:23,color:"white"}),size:"xs",paddingY:4,"aria-label":"save workspace",variant:"ghost"})}):C.jsx("div",{style:{width:1}}),C.jsx(Zh,{}),C.jsx(Yh,{}),C.jsx(bh,{id:"dragPanelIcon",className:"dragPanelIcon",cursor:"move",size:15,color:"#FFF"}),l==="spotlightSearch"&&C.jsx(Xh,{}),C.jsx(Pt,{label:"Chat with AI about this workflow",children:C.jsx(Te,{size:"sm",variant:"ghost",onClick:n,isActive:r,"aria-label":"Chat",children:C.jsx(xh,{size:20})})})]})}):null}function ep(){const{showDialog:t}=ja(),{loadWorkflowID:e}=A.useContext(tt),n=async(o,s)=>{var c,u;const{workflow:a,version:i}=o.detail;if(!a.id||!i.id)return;const l=(c=await(K==null?void 0:K.listByIndex("cloudID",a.id)))==null?void 0:c.at(0);if(l){const f=(u=await(Ne==null?void 0:Ne.listByIndex("cloudID",i.id)))==null?void 0:u.at(0);if(f)await e(l.id,f.id);else{const p=await(Ne==null?void 0:Ne.add({id:i.id,cloudID:i.id,workflowID:l.id,cloudOrigin:s,name:i.name,authorID:i.authorID,json:i.json}));p&&e(l.id,p.id)}}else{const f=await(K==null?void 0:K.createFlow({cloudID:a.id,cloudOrigin:s,name:a.name,json:i.json,updateTime:Date.now()}));if(!f){alert("Failed to add workflow to local db");return}const p=await(Ne==null?void 0:Ne.put({id:i.id,cloudID:i.id,workflowID:f.id,cloudOrigin:s,name:i.name,json:i.json,authorID:i.authorID,createTime:Date.now()}));await e(f.id,p==null?void 0:p.id)}},r=async o=>{const s=o.data;if(tp(s)){const a=o.origin;t(`Open workflow "${s.detail.workflow.name}", version "${s.detail.version.name}" from ${a}`,[{label:"Open",colorScheme:"teal",onClick:()=>{n(s,a)}}])}};return A.useEffect(()=>{window.opener&&window.opener.postMessage("comfyui_workspace_manager_connected","*"),window.addEventListener("message",r)},[]),null}function tp(t){return t.type==="workspace_open_workflow"}const np=t=>typeof t=="function",rp=t=>{const[e,n]=A.useState(t),r=A.useRef(e),o=A.useCallback(s=>{r.current=np(s)?s(r.current):s,n(r.current)},[]);return[e,o,r]};function lr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ul={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,s){function a(c,u){if(!o[c]){if(!r[c]){var f=typeof lr=="function"&&lr;if(!u&&f)return f(c,!0);if(i)return i(c,!0);var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}var d=o[c]={exports:{}};r[c][0].call(d.exports,function(w){var h=r[c][1][w];return a(h||w)},d,d.exports,n,r,o,s)}return o[c].exports}for(var i=typeof lr=="function"&&lr,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(n,r,o){var s=n("./utils"),a=n("./support"),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var c,u,f,p,d,w,h,y=[],m=0,v=l.length,_=v,k=s.getTypeOf(l)!=="string";m<l.length;)_=v-m,f=k?(c=l[m++],u=m<v?l[m++]:0,m<v?l[m++]:0):(c=l.charCodeAt(m++),u=m<v?l.charCodeAt(m++):0,m<v?l.charCodeAt(m++):0),p=c>>2,d=(3&c)<<4|u>>4,w=1<_?(15&u)<<2|f>>6:64,h=2<_?63&f:64,y.push(i.charAt(p)+i.charAt(d)+i.charAt(w)+i.charAt(h));return y.join("")},o.decode=function(l){var c,u,f,p,d,w,h=0,y=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var v,_=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===i.charAt(64)&&_--,l.charAt(l.length-2)===i.charAt(64)&&_--,_%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=a.uint8array?new Uint8Array(0|_):new Array(0|_);h<l.length;)c=i.indexOf(l.charAt(h++))<<2|(p=i.indexOf(l.charAt(h++)))>>4,u=(15&p)<<4|(d=i.indexOf(l.charAt(h++)))>>2,f=(3&d)<<6|(w=i.indexOf(l.charAt(h++))),v[y++]=c,d!==64&&(v[y++]=u),w!==64&&(v[y++]=f);return v}},{"./support":30,"./utils":32}],2:[function(n,r,o){var s=n("./external"),a=n("./stream/DataWorker"),i=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,f,p,d,w){this.compressedSize=u,this.uncompressedSize=f,this.crc32=p,this.compression=d,this.compressedContent=w}c.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,f,p){return u.pipe(new i).pipe(new l("uncompressedSize")).pipe(f.compressWorker(p)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,o){var s=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,o){var s=n("./utils"),a=function(){for(var i,l=[],c=0;c<256;c++){i=c;for(var u=0;u<8;u++)i=1&i?3988292384^i>>>1:i>>>1;l[c]=i}return l}();r.exports=function(i,l){return i!==void 0&&i.length?s.getTypeOf(i)!=="string"?function(c,u,f,p){var d=a,w=p+f;c^=-1;for(var h=p;h<w;h++)c=c>>>8^d[255&(c^u[h])];return-1^c}(0|l,i,i.length,0):function(c,u,f,p){var d=a,w=p+f;c^=-1;for(var h=p;h<w;h++)c=c>>>8^d[255&(c^u.charCodeAt(h))];return-1^c}(0|l,i,i.length,0):0}},{"./utils":32}],5:[function(n,r,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,r,o){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,o){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),i=n("./utils"),l=n("./stream/GenericWorker"),c=s?"uint8array":"array";function u(f,p){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=p,this.meta={}}o.magic="\b\0",i.inherits(u,l),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(i.transformTo(c,f.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(p){f.push({data:p,meta:f.meta})}},o.compressWorker=function(f){return new u("Deflate",f)},o.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,o){function s(d,w){var h,y="";for(h=0;h<w;h++)y+=String.fromCharCode(255&d),d>>>=8;return y}function a(d,w,h,y,m,v){var _,k,x=d.file,I=d.compression,E=v!==c.utf8encode,N=i.transformTo("string",v(x.name)),D=i.transformTo("string",c.utf8encode(x.name)),R=x.comment,H=i.transformTo("string",v(R)),j=i.transformTo("string",c.utf8encode(R)),T=D.length!==x.name.length,b=j.length!==R.length,$="",ee="",P="",G=x.dir,L=x.date,J={crc32:0,compressedSize:0,uncompressedSize:0};w&&!h||(J.crc32=d.crc32,J.compressedSize=d.compressedSize,J.uncompressedSize=d.uncompressedSize);var M=0;w&&(M|=8),E||!T&&!b||(M|=2048);var B=0,ne=0;G&&(B|=16),m==="UNIX"?(ne=798,B|=function(Z,me){var ge=Z;return Z||(ge=me?16893:33204),(65535&ge)<<16}(x.unixPermissions,G)):(ne=20,B|=function(Z){return 63&(Z||0)}(x.dosPermissions)),_=L.getUTCHours(),_<<=6,_|=L.getUTCMinutes(),_<<=5,_|=L.getUTCSeconds()/2,k=L.getUTCFullYear()-1980,k<<=4,k|=L.getUTCMonth()+1,k<<=5,k|=L.getUTCDate(),T&&(ee=s(1,1)+s(u(N),4)+D,$+="up"+s(ee.length,2)+ee),b&&(P=s(1,1)+s(u(H),4)+j,$+="uc"+s(P.length,2)+P);var X="";return X+=`
\0`,X+=s(M,2),X+=I.magic,X+=s(_,2),X+=s(k,2),X+=s(J.crc32,4),X+=s(J.compressedSize,4),X+=s(J.uncompressedSize,4),X+=s(N.length,2),X+=s($.length,2),{fileRecord:f.LOCAL_FILE_HEADER+X+N+$,dirRecord:f.CENTRAL_FILE_HEADER+s(ne,2)+X+s(H.length,2)+"\0\0\0\0"+s(B,4)+s(y,4)+N+$+H}}var i=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),f=n("../signature");function p(d,w,h,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=h,this.encodeFileName=y,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}i.inherits(p,l),p.prototype.push=function(d){var w=d.meta.percent||0,h=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:h?(w+100*(h-y-1))/h:100}}))},p.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var w=this.streamFiles&&!d.file.dir;if(w){var h=a(d,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(d){this.accumulate=!1;var w=this.streamFiles&&!d.file.dir,h=a(d,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),w)this.push({data:function(y){return f.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var d=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var h=this.bytesWritten-d,y=function(m,v,_,k,x){var I=i.transformTo("string",x(k));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(m,2)+s(m,2)+s(v,4)+s(_,4)+s(I.length,2)+I}(this.dirRecords.length,h,d,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(d){this._sources.push(d);var w=this;return d.on("data",function(h){w.processChunk(h)}),d.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),d.on("error",function(h){w.error(h)}),this},p.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(d){var w=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var h=0;h<w.length;h++)try{w[h].error(d)}catch{}return!0},p.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,w=0;w<d.length;w++)d[w].lock()},r.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,o){var s=n("../compressions"),a=n("./ZipFileWorker");o.generateWorker=function(i,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{i.forEach(function(p,d){f++;var w=function(v,_){var k=v||_,x=s[k];if(!x)throw new Error(k+" is not a valid compression method !");return x}(d.options.compression,l.compression),h=d.options.compressionOptions||l.compressionOptions||{},y=d.dir,m=d.date;d._compressWorker(w,h).withStreamInfo("file",{name:p,dir:y,date:m,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(p){u.error(p)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,o){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var i in this)typeof this[i]!="function"&&(a[i]=this[i]);return a}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(a,i){return new s().loadAsync(a,i)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,o){var s=n("./utils"),a=n("./external"),i=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function f(p){return new a.Promise(function(d,w){var h=p.decompressed.getContentWorker().pipe(new c);h.on("error",function(y){w(y)}).on("end",function(){h.streamInfo.crc32!==p.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}r.exports=function(p,d){var w=this;return d=s.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:i.utf8decode}),u.isNode&&u.isStream(p)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",p,!0,d.optimizedBinaryString,d.base64).then(function(h){var y=new l(d);return y.load(h),y}).then(function(h){var y=[a.Promise.resolve(h)],m=h.files;if(d.checkCRC32)for(var v=0;v<m.length;v++)y.push(f(m[v]));return a.Promise.all(y)}).then(function(h){for(var y=h.shift(),m=y.files,v=0;v<m.length;v++){var _=m[v],k=_.fileNameStr,x=s.resolve(_.fileNameStr);w.file(x,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:d.createFolders}),_.dir||(w.file(x).unsafeOriginalName=k)}return y.zipComment.length&&(w.comment=y.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,o){var s=n("../utils"),a=n("../stream/GenericWorker");function i(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(i,a),i.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},i.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,o){var s=n("readable-stream").Readable;function a(i,l,c){s.call(this,l),this._helper=i;var u=this;i.on("data",function(f,p){u.push(f)||u._helper.pause(),c&&c(p)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,o){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,o){function s(x,I,E){var N,D=i.getTypeOf(I),R=i.extend(E||{},u);R.date=R.date||new Date,R.compression!==null&&(R.compression=R.compression.toUpperCase()),typeof R.unixPermissions=="string"&&(R.unixPermissions=parseInt(R.unixPermissions,8)),R.unixPermissions&&16384&R.unixPermissions&&(R.dir=!0),R.dosPermissions&&16&R.dosPermissions&&(R.dir=!0),R.dir&&(x=m(x)),R.createFolders&&(N=y(x))&&v.call(this,N,!0);var H=D==="string"&&R.binary===!1&&R.base64===!1;E&&E.binary!==void 0||(R.binary=!H),(I instanceof f&&I.uncompressedSize===0||R.dir||!I||I.length===0)&&(R.base64=!1,R.binary=!0,I="",R.compression="STORE",D="string");var j=null;j=I instanceof f||I instanceof l?I:w.isNode&&w.isStream(I)?new h(x,I):i.prepareContent(x,I,R.binary,R.optimizedBinaryString,R.base64);var T=new p(x,j,R);this.files[x]=T}var a=n("./utf8"),i=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),f=n("./compressedObject"),p=n("./zipObject"),d=n("./generate"),w=n("./nodejsUtils"),h=n("./nodejs/NodejsStreamInputAdapter"),y=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var I=x.lastIndexOf("/");return 0<I?x.substring(0,I):""},m=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},v=function(x,I){return I=I!==void 0?I:u.createFolders,x=m(x),this.files[x]||s.call(this,x,null,{dir:!0,createFolders:I}),this.files[x]};function _(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var I,E,N;for(I in this.files)N=this.files[I],(E=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&x(E,N)},filter:function(x){var I=[];return this.forEach(function(E,N){x(E,N)&&I.push(N)}),I},file:function(x,I,E){if(arguments.length!==1)return x=this.root+x,s.call(this,x,I,E),this;if(_(x)){var N=x;return this.filter(function(R,H){return!H.dir&&N.test(R)})}var D=this.files[this.root+x];return D&&!D.dir?D:null},folder:function(x){if(!x)return this;if(_(x))return this.filter(function(D,R){return R.dir&&x.test(D)});var I=this.root+x,E=v.call(this,I),N=this.clone();return N.root=E.name,N},remove:function(x){x=this.root+x;var I=this.files[x];if(I||(x.slice(-1)!=="/"&&(x+="/"),I=this.files[x]),I&&!I.dir)delete this.files[x];else for(var E=this.filter(function(D,R){return R.name.slice(0,x.length)===x}),N=0;N<E.length;N++)delete this.files[E[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var I,E={};try{if((E=i.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");i.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var N=E.comment||this.comment||"";I=d.generateWorker(this,E,N)}catch(D){(I=new l("error")).error(D)}return new c(I,E.type||"string",E.mimeType)},generateAsync:function(x,I){return this.generateInternalStream(x).accumulate(I)},generateNodeStream:function(x,I){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(I)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,o){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,o){var s=n("./DataReader");function a(i){s.call(this,i);for(var l=0;l<this.data.length;l++)i[l]=255&i[l]}n("../utils").inherits(a,s),a.prototype.byteAt=function(i){return this.data[this.zero+i]},a.prototype.lastIndexOfSignature=function(i){for(var l=i.charCodeAt(0),c=i.charCodeAt(1),u=i.charCodeAt(2),f=i.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===l&&this.data[p+1]===c&&this.data[p+2]===u&&this.data[p+3]===f)return p-this.zero;return-1},a.prototype.readAndCheckSignature=function(i){var l=i.charCodeAt(0),c=i.charCodeAt(1),u=i.charCodeAt(2),f=i.charCodeAt(3),p=this.readData(4);return l===p[0]&&c===p[1]&&u===p[2]&&f===p[3]},a.prototype.readData=function(i){if(this.checkOffset(i),i===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,o){var s=n("../utils");function a(i){this.data=i,this.length=i.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(i){this.checkIndex(this.index+i)},checkIndex:function(i){if(this.length<this.zero+i||i<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+i+"). Corrupted zip ?")},setIndex:function(i){this.checkIndex(i),this.index=i},skip:function(i){this.setIndex(this.index+i)},byteAt:function(){},readInt:function(i){var l,c=0;for(this.checkOffset(i),l=this.index+i-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=i,c},readString:function(i){return s.transformTo("string",this.readData(i))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var i=this.readInt(4);return new Date(Date.UTC(1980+(i>>25&127),(i>>21&15)-1,i>>16&31,i>>11&31,i>>5&63,(31&i)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,o){var s=n("./Uint8ArrayReader");function a(i){s.call(this,i)}n("../utils").inherits(a,s),a.prototype.readData=function(i){this.checkOffset(i);var l=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,o){var s=n("./DataReader");function a(i){s.call(this,i)}n("../utils").inherits(a,s),a.prototype.byteAt=function(i){return this.data.charCodeAt(this.zero+i)},a.prototype.lastIndexOfSignature=function(i){return this.data.lastIndexOf(i)-this.zero},a.prototype.readAndCheckSignature=function(i){return i===this.readData(4)},a.prototype.readData=function(i){this.checkOffset(i);var l=this.data.slice(this.zero+this.index,this.zero+this.index+i);return this.index+=i,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,o){var s=n("./ArrayReader");function a(i){s.call(this,i)}n("../utils").inherits(a,s),a.prototype.readData=function(i){if(this.checkOffset(i),i===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+i);return this.index+=i,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,o){var s=n("../utils"),a=n("../support"),i=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(f){var p=s.getTypeOf(f);return s.checkSupport(p),p!=="string"||a.uint8array?p==="nodebuffer"?new c(f):a.uint8array?new u(s.transformTo("uint8array",f)):new i(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,o){var s=n("./GenericWorker"),a=n("../utils");function i(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(i,s),i.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,o){var s=n("./GenericWorker"),a=n("../crc32");function i(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(i,s),i.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,o){var s=n("../utils"),a=n("./GenericWorker");function i(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(i,a),i.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,o){var s=n("../utils"),a=n("./GenericWorker");function i(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(i,a),i.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,o){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,i){return this._listeners[a].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,i){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,i)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var i=this;return a.on("data",function(l){i.processChunk(l)}),a.on("end",function(){i.end()}),a.on("error",function(l){i.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,i){return this.extraStreamInfo[a]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(n,r,o){var s=n("../utils"),a=n("./ConvertWorker"),i=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),f=null;if(c.nodestream)try{f=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(w,h){return new u.Promise(function(y,m){var v=[],_=w._internalType,k=w._outputType,x=w._mimeType;w.on("data",function(I,E){v.push(I),h&&h(E)}).on("error",function(I){v=[],m(I)}).on("end",function(){try{var I=function(E,N,D){switch(E){case"blob":return s.newBlob(s.transformTo("arraybuffer",N),D);case"base64":return l.encode(N);default:return s.transformTo(E,N)}}(k,function(E,N){var D,R=0,H=null,j=0;for(D=0;D<N.length;D++)j+=N[D].length;switch(E){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(H=new Uint8Array(j),D=0;D<N.length;D++)H.set(N[D],R),R+=N[D].length;return H;case"nodebuffer":return Buffer.concat(N);default:throw new Error("concat : unsupported type '"+E+"'")}}(_,v),x);y(I)}catch(E){m(E)}v=[]}).resume()})}function d(w,h,y){var m=h;switch(h){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=h,this._mimeType=y,s.checkSupport(m),this._worker=w.pipe(new a(m)),w.lock()}catch(v){this._worker=new i("error"),this._worker.error(v)}}d.prototype={accumulate:function(w){return p(this,w)},on:function(w,h){var y=this;return w==="data"?this._worker.on(w,function(m){h.call(y,m.data,m.meta)}):this._worker.on(w,function(){s.delay(h,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},w)}},r.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var s=new ArrayBuffer(0);try{o.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),o.blob=a.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,o){for(var s=n("./utils"),a=n("./support"),i=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function p(){l.call(this,"utf-8 encode")}o.utf8encode=function(d){return a.nodebuffer?i.newBufferFrom(d,"utf-8"):function(w){var h,y,m,v,_,k=w.length,x=0;for(v=0;v<k;v++)(64512&(y=w.charCodeAt(v)))==55296&&v+1<k&&(64512&(m=w.charCodeAt(v+1)))==56320&&(y=65536+(y-55296<<10)+(m-56320),v++),x+=y<128?1:y<2048?2:y<65536?3:4;for(h=a.uint8array?new Uint8Array(x):new Array(x),v=_=0;_<x;v++)(64512&(y=w.charCodeAt(v)))==55296&&v+1<k&&(64512&(m=w.charCodeAt(v+1)))==56320&&(y=65536+(y-55296<<10)+(m-56320),v++),y<128?h[_++]=y:(y<2048?h[_++]=192|y>>>6:(y<65536?h[_++]=224|y>>>12:(h[_++]=240|y>>>18,h[_++]=128|y>>>12&63),h[_++]=128|y>>>6&63),h[_++]=128|63&y);return h}(d)},o.utf8decode=function(d){return a.nodebuffer?s.transformTo("nodebuffer",d).toString("utf-8"):function(w){var h,y,m,v,_=w.length,k=new Array(2*_);for(h=y=0;h<_;)if((m=w[h++])<128)k[y++]=m;else if(4<(v=c[m]))k[y++]=65533,h+=v-1;else{for(m&=v===2?31:v===3?15:7;1<v&&h<_;)m=m<<6|63&w[h++],v--;1<v?k[y++]=65533:m<65536?k[y++]=m:(m-=65536,k[y++]=55296|m>>10&1023,k[y++]=56320|1023&m)}return k.length!==y&&(k.subarray?k=k.subarray(0,y):k.length=y),s.applyFromCharCode(k)}(d=s.transformTo(a.uint8array?"uint8array":"array",d))},s.inherits(f,l),f.prototype.processChunk=function(d){var w=s.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var h=w;(w=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),w.set(h,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var y=function(v,_){var k;for((_=_||v.length)>v.length&&(_=v.length),k=_-1;0<=k&&(192&v[k])==128;)k--;return k<0||k===0?_:k+c[v[k]]>_?k:_}(w),m=w;y!==w.length&&(a.uint8array?(m=w.subarray(0,y),this.leftOver=w.subarray(y,w.length)):(m=w.slice(0,y),this.leftOver=w.slice(y,w.length))),this.push({data:o.utf8decode(m),meta:d.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=f,s.inherits(p,l),p.prototype.processChunk=function(d){this.push({data:o.utf8encode(d.data),meta:d.meta})},o.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,o){var s=n("./support"),a=n("./base64"),i=n("./nodejsUtils"),l=n("./external");function c(h){return h}function u(h,y){for(var m=0;m<h.length;++m)y[m]=255&h.charCodeAt(m);return y}n("setimmediate"),o.newBlob=function(h,y){o.checkSupport("blob");try{return new Blob([h],{type:y})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(h),m.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(h,y,m){var v=[],_=0,k=h.length;if(k<=m)return String.fromCharCode.apply(null,h);for(;_<k;)y==="array"||y==="nodebuffer"?v.push(String.fromCharCode.apply(null,h.slice(_,Math.min(_+m,k)))):v.push(String.fromCharCode.apply(null,h.subarray(_,Math.min(_+m,k)))),_+=m;return v.join("")},stringifyByChar:function(h){for(var y="",m=0;m<h.length;m++)y+=String.fromCharCode(h[m]);return y},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,i.allocBuffer(1)).length===1}catch{return!1}}()}};function p(h){var y=65536,m=o.getTypeOf(h),v=!0;if(m==="uint8array"?v=f.applyCanBeUsed.uint8array:m==="nodebuffer"&&(v=f.applyCanBeUsed.nodebuffer),v)for(;1<y;)try{return f.stringifyByChunk(h,m,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(h)}function d(h,y){for(var m=0;m<h.length;m++)y[m]=h[m];return y}o.applyFromCharCode=p;var w={};w.string={string:c,array:function(h){return u(h,new Array(h.length))},arraybuffer:function(h){return w.string.uint8array(h).buffer},uint8array:function(h){return u(h,new Uint8Array(h.length))},nodebuffer:function(h){return u(h,i.allocBuffer(h.length))}},w.array={string:p,array:c,arraybuffer:function(h){return new Uint8Array(h).buffer},uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return i.newBufferFrom(h)}},w.arraybuffer={string:function(h){return p(new Uint8Array(h))},array:function(h){return d(new Uint8Array(h),new Array(h.byteLength))},arraybuffer:c,uint8array:function(h){return new Uint8Array(h)},nodebuffer:function(h){return i.newBufferFrom(new Uint8Array(h))}},w.uint8array={string:p,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return h.buffer},uint8array:c,nodebuffer:function(h){return i.newBufferFrom(h)}},w.nodebuffer={string:p,array:function(h){return d(h,new Array(h.length))},arraybuffer:function(h){return w.nodebuffer.uint8array(h).buffer},uint8array:function(h){return d(h,new Uint8Array(h.length))},nodebuffer:c},o.transformTo=function(h,y){if(y=y||"",!h)return y;o.checkSupport(h);var m=o.getTypeOf(y);return w[m][h](y)},o.resolve=function(h){for(var y=h.split("/"),m=[],v=0;v<y.length;v++){var _=y[v];_==="."||_===""&&v!==0&&v!==y.length-1||(_===".."?m.pop():m.push(_))}return m.join("/")},o.getTypeOf=function(h){return typeof h=="string"?"string":Object.prototype.toString.call(h)==="[object Array]"?"array":s.nodebuffer&&i.isBuffer(h)?"nodebuffer":s.uint8array&&h instanceof Uint8Array?"uint8array":s.arraybuffer&&h instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(h){if(!s[h.toLowerCase()])throw new Error(h+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(h){var y,m,v="";for(m=0;m<(h||"").length;m++)v+="\\x"+((y=h.charCodeAt(m))<16?"0":"")+y.toString(16).toUpperCase();return v},o.delay=function(h,y,m){setImmediate(function(){h.apply(m||null,y||[])})},o.inherits=function(h,y){function m(){}m.prototype=y.prototype,h.prototype=new m},o.extend=function(){var h,y,m={};for(h=0;h<arguments.length;h++)for(y in arguments[h])Object.prototype.hasOwnProperty.call(arguments[h],y)&&m[y]===void 0&&(m[y]=arguments[h][y]);return m},o.prepareContent=function(h,y,m,v,_){return l.Promise.resolve(y).then(function(k){return s.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(x,I){var E=new FileReader;E.onload=function(N){x(N.target.result)},E.onerror=function(N){I(N.target.error)},E.readAsArrayBuffer(k)}):k}).then(function(k){var x=o.getTypeOf(k);return x?(x==="arraybuffer"?k=o.transformTo("uint8array",k):x==="string"&&(_?k=a.decode(k):m&&v!==!0&&(k=function(I){return u(I,s.uint8array?new Uint8Array(I.length):new Array(I.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+h+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,o){var s=n("./reader/readerFor"),a=n("./utils"),i=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(p)+", expected "+a.pretty(f)+")")}},isSignature:function(f,p){var d=this.reader.index;this.reader.setIndex(f);var w=this.reader.readString(4)===p;return this.reader.setIndex(d),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),p=c.uint8array?"uint8array":"array",d=a.transformTo(p,f);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,p,d,w=this.zip64EndOfCentralSize-44;0<w;)f=this.reader.readInt(2),p=this.reader.readInt(4),d=this.reader.readData(p),this.zip64ExtensibleData[f]={id:f,length:p,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,p;for(f=0;f<this.files.length;f++)p=this.files[f],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(i.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(i.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(i.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,i.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var p=f;if(this.checkSignature(i.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,i.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(i.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var w=p-d;if(0<w)this.isSignature(p,i.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,o){var s=n("./reader/readerFor"),a=n("./utils"),i=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),f=n("./support");function p(d,w){this.options=d,this.loadOptions=w}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var w,h;if(d.skip(22),this.fileNameLength=d.readInt(2),h=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(y){for(var m in u)if(Object.prototype.hasOwnProperty.call(u,m)&&u[m].magic===y)return u[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,w,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var w=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(w),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var w,h,y,m=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<m;)w=d.readInt(2),h=d.readInt(2),y=d.readData(h),this.extraFields[w]={id:w,length:h,value:y};d.setIndex(m)},handleUTF8:function(){var d=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var h=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var m=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var w=s(d.value);return w.readInt(1)!==1||l(this.fileName)!==w.readInt(4)?null:c.utf8decode(w.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var w=s(d.value);return w.readInt(1)!==1||l(this.fileComment)!==w.readInt(4)?null:c.utf8decode(w.readData(d.length-5))}return null}},r.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,o){function s(w,h,y){this.name=w,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=h,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var a=n("./stream/StreamHelper"),i=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(w){var h=null,y="string";try{if(!w)throw new Error("No output type specified.");var m=(y=w.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),h=this._decompressWorker();var v=!this._dataBinary;v&&!m&&(h=h.pipe(new l.Utf8EncodeWorker)),!v&&m&&(h=h.pipe(new l.Utf8DecodeWorker))}catch(_){(h=new u("error")).error(_)}return new a(h,y,"")},async:function(w,h){return this.internalStream(w).accumulate(h)},nodeStream:function(w,h){return this.internalStream(w||"nodebuffer").toNodejsStream(h)},_compressWorker:function(w,h){if(this._data instanceof c&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,w,h)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new i(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<f.length;d++)s.prototype[f[d]]=p;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,o){(function(s){var a,i,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(w),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),a=function(){f.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var h=s.document.createElement("script");h.onreadystatechange=function(){w(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},s.document.documentElement.appendChild(h)}:function(){setTimeout(w,0)};else{var p=new s.MessageChannel;p.port1.onmessage=w,a=function(){p.port2.postMessage(0)}}var d=[];function w(){var h,y;i=!0;for(var m=d.length;m;){for(y=d,d=[],h=-1;++h<m;)y[h]();m=d.length}i=!1}r.exports=function(h){d.push(h)!==1||i||a()}}).call(this,typeof Xn<"u"?Xn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,o){var s=n("immediate");function a(){}var i={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,m!==a&&h(this,m)}function p(m,v,_){this.promise=m,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function d(m,v,_){s(function(){var k;try{k=v(_)}catch(x){return i.reject(m,x)}k===m?i.reject(m,new TypeError("Cannot resolve promise with itself")):i.resolve(m,k)})}function w(m){var v=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof v=="function")return function(){v.apply(m,arguments)}}function h(m,v){var _=!1;function k(E){_||(_=!0,i.reject(m,E))}function x(E){_||(_=!0,i.resolve(m,E))}var I=y(function(){v(x,k)});I.status==="error"&&k(I.value)}function y(m,v){var _={};try{_.value=m(v),_.status="success"}catch(k){_.status="error",_.value=k}return _}(r.exports=f).prototype.finally=function(m){if(typeof m!="function")return this;var v=this.constructor;return this.then(function(_){return v.resolve(m()).then(function(){return _})},function(_){return v.resolve(m()).then(function(){throw _})})},f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,v){if(typeof m!="function"&&this.state===c||typeof v!="function"&&this.state===l)return this;var _=new this.constructor(a);return this.state!==u?d(_,this.state===c?m:v,this.outcome):this.queue.push(new p(_,m,v)),_},p.prototype.callFulfilled=function(m){i.resolve(this.promise,m)},p.prototype.otherCallFulfilled=function(m){d(this.promise,this.onFulfilled,m)},p.prototype.callRejected=function(m){i.reject(this.promise,m)},p.prototype.otherCallRejected=function(m){d(this.promise,this.onRejected,m)},i.resolve=function(m,v){var _=y(w,v);if(_.status==="error")return i.reject(m,_.value);var k=_.value;if(k)h(m,k);else{m.state=c,m.outcome=v;for(var x=-1,I=m.queue.length;++x<I;)m.queue[x].callFulfilled(v)}return m},i.reject=function(m,v){m.state=l,m.outcome=v;for(var _=-1,k=m.queue.length;++_<k;)m.queue[_].callRejected(v);return m},f.resolve=function(m){return m instanceof this?m:i.resolve(new this(a),m)},f.reject=function(m){var v=new this(a);return i.reject(v,m)},f.all=function(m){var v=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,k=!1;if(!_)return this.resolve([]);for(var x=new Array(_),I=0,E=-1,N=new this(a);++E<_;)D(m[E],E);return N;function D(R,H){v.resolve(R).then(function(j){x[H]=j,++I!==_||k||(k=!0,i.resolve(N,x))},function(j){k||(k=!0,i.reject(N,j))})}},f.race=function(m){var v=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,k=!1;if(!_)return this.resolve([]);for(var x=-1,I=new this(a);++x<_;)E=m[x],v.resolve(E).then(function(N){k||(k=!0,i.resolve(I,N))},function(N){k||(k=!0,i.reject(I,N))});var E;return I}},{immediate:36}],38:[function(n,r,o){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,o){var s=n("./zlib/deflate"),a=n("./utils/common"),i=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,f=0,p=-1,d=0,w=8;function h(m){if(!(this instanceof h))return new h(m);this.options=a.assign({level:p,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},m||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=s.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(_!==f)throw new Error(l[_]);if(v.header&&s.deflateSetHeader(this.strm,v.header),v.dictionary){var k;if(k=typeof v.dictionary=="string"?i.string2buf(v.dictionary):u.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(_=s.deflateSetDictionary(this.strm,k))!==f)throw new Error(l[_]);this._dict_set=!0}}function y(m,v){var _=new h(v);if(_.push(m,!0),_.err)throw _.msg||l[_.err];return _.result}h.prototype.push=function(m,v){var _,k,x=this.strm,I=this.options.chunkSize;if(this.ended)return!1;k=v===~~v?v:v===!0?4:0,typeof m=="string"?x.input=i.string2buf(m):u.call(m)==="[object ArrayBuffer]"?x.input=new Uint8Array(m):x.input=m,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new a.Buf8(I),x.next_out=0,x.avail_out=I),(_=s.deflate(x,k))!==1&&_!==f)return this.onEnd(_),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(i.buf2binstring(a.shrinkBuf(x.output,x.next_out))):this.onData(a.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&_!==1);return k===4?(_=s.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===f):k!==2||(this.onEnd(f),!(x.avail_out=0))},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},o.Deflate=h,o.deflate=y,o.deflateRaw=function(m,v){return(v=v||{}).raw=!0,y(m,v)},o.gzip=function(m,v){return(v=v||{}).gzip=!0,y(m,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,o){var s=n("./zlib/inflate"),a=n("./utils/common"),i=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),f=n("./zlib/gzheader"),p=Object.prototype.toString;function d(h){if(!(this instanceof d))return new d(h);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},h||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||h&&h.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var m=s.inflateInit2(this.strm,y.windowBits);if(m!==l.Z_OK)throw new Error(c[m]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function w(h,y){var m=new d(y);if(m.push(h,!0),m.err)throw m.msg||c[m.err];return m.result}d.prototype.push=function(h,y){var m,v,_,k,x,I,E=this.strm,N=this.options.chunkSize,D=this.options.dictionary,R=!1;if(this.ended)return!1;v=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof h=="string"?E.input=i.binstring2buf(h):p.call(h)==="[object ArrayBuffer]"?E.input=new Uint8Array(h):E.input=h,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(N),E.next_out=0,E.avail_out=N),(m=s.inflate(E,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&D&&(I=typeof D=="string"?i.string2buf(D):p.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,m=s.inflateSetDictionary(this.strm,I)),m===l.Z_BUF_ERROR&&R===!0&&(m=l.Z_OK,R=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&m!==l.Z_STREAM_END&&(E.avail_in!==0||v!==l.Z_FINISH&&v!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=i.utf8border(E.output,E.next_out),k=E.next_out-_,x=i.buf2string(E.output,_),E.next_out=k,E.avail_out=N-k,k&&a.arraySet(E.output,E.output,_,k,0),this.onData(x)):this.onData(a.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(R=!0)}while((0<E.avail_in||E.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(v=l.Z_FINISH),v===l.Z_FINISH?(m=s.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):v!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(E.avail_out=0))},d.prototype.onData=function(h){this.chunks.push(h)},d.prototype.onEnd=function(h){h===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},o.Inflate=d,o.inflate=w,o.inflateRaw=function(h,y){return(y=y||{}).raw=!0,w(h,y)},o.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,o){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(l[f]=u[f])}}return l},o.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,f,p){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+f),p);else for(var d=0;d<f;d++)l[p+d]=c[u+d]},flattenChunks:function(l){var c,u,f,p,d,w;for(c=f=0,u=l.length;c<u;c++)f+=l[c].length;for(w=new Uint8Array(f),c=p=0,u=l.length;c<u;c++)d=l[c],w.set(d,p),p+=d.length;return w}},i={arraySet:function(l,c,u,f,p){for(var d=0;d<f;d++)l[p+d]=c[u+d]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,a)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,i))},o.setTyped(s)},{}],42:[function(n,r,o){var s=n("./common"),a=!0,i=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{i=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(f,p){if(p<65537&&(f.subarray&&i||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,p));for(var d="",w=0;w<p;w++)d+=String.fromCharCode(f[w]);return d}l[254]=l[254]=1,o.string2buf=function(f){var p,d,w,h,y,m=f.length,v=0;for(h=0;h<m;h++)(64512&(d=f.charCodeAt(h)))==55296&&h+1<m&&(64512&(w=f.charCodeAt(h+1)))==56320&&(d=65536+(d-55296<<10)+(w-56320),h++),v+=d<128?1:d<2048?2:d<65536?3:4;for(p=new s.Buf8(v),h=y=0;y<v;h++)(64512&(d=f.charCodeAt(h)))==55296&&h+1<m&&(64512&(w=f.charCodeAt(h+1)))==56320&&(d=65536+(d-55296<<10)+(w-56320),h++),d<128?p[y++]=d:(d<2048?p[y++]=192|d>>>6:(d<65536?p[y++]=224|d>>>12:(p[y++]=240|d>>>18,p[y++]=128|d>>>12&63),p[y++]=128|d>>>6&63),p[y++]=128|63&d);return p},o.buf2binstring=function(f){return u(f,f.length)},o.binstring2buf=function(f){for(var p=new s.Buf8(f.length),d=0,w=p.length;d<w;d++)p[d]=f.charCodeAt(d);return p},o.buf2string=function(f,p){var d,w,h,y,m=p||f.length,v=new Array(2*m);for(d=w=0;d<m;)if((h=f[d++])<128)v[w++]=h;else if(4<(y=l[h]))v[w++]=65533,d+=y-1;else{for(h&=y===2?31:y===3?15:7;1<y&&d<m;)h=h<<6|63&f[d++],y--;1<y?v[w++]=65533:h<65536?v[w++]=h:(h-=65536,v[w++]=55296|h>>10&1023,v[w++]=56320|1023&h)}return u(v,w)},o.utf8border=function(f,p){var d;for((p=p||f.length)>f.length&&(p=f.length),d=p-1;0<=d&&(192&f[d])==128;)d--;return d<0||d===0?p:d+l[f[d]]>p?d:p}},{"./common":41}],43:[function(n,r,o){r.exports=function(s,a,i,l){for(var c=65535&s|0,u=s>>>16&65535|0,f=0;i!==0;){for(i-=f=2e3<i?2e3:i;u=u+(c=c+a[l++]|0)|0,--f;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,o){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,o){var s=function(){for(var a,i=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;i[l]=a}return i}();r.exports=function(a,i,l,c){var u=s,f=c+l;a^=-1;for(var p=c;p<f;p++)a=a>>>8^u[255&(a^i[p])];return-1^a}},{}],46:[function(n,r,o){var s,a=n("../utils/common"),i=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),f=0,p=4,d=0,w=-2,h=-1,y=4,m=2,v=8,_=9,k=286,x=30,I=19,E=2*k+1,N=15,D=3,R=258,H=R+D+1,j=42,T=113,b=1,$=2,ee=3,P=4;function G(g,U){return g.msg=u[U],U}function L(g){return(g<<1)-(4<g?9:0)}function J(g){for(var U=g.length;0<=--U;)g[U]=0}function M(g){var U=g.state,W=U.pending;W>g.avail_out&&(W=g.avail_out),W!==0&&(a.arraySet(g.output,U.pending_buf,U.pending_out,W,g.next_out),g.next_out+=W,U.pending_out+=W,g.total_out+=W,g.avail_out-=W,U.pending-=W,U.pending===0&&(U.pending_out=0))}function B(g,U){i._tr_flush_block(g,0<=g.block_start?g.block_start:-1,g.strstart-g.block_start,U),g.block_start=g.strstart,M(g.strm)}function ne(g,U){g.pending_buf[g.pending++]=U}function X(g,U){g.pending_buf[g.pending++]=U>>>8&255,g.pending_buf[g.pending++]=255&U}function Z(g,U){var W,O,S=g.max_chain_length,F=g.strstart,q=g.prev_length,Y=g.nice_match,z=g.strstart>g.w_size-H?g.strstart-(g.w_size-H):0,Q=g.window,re=g.w_mask,te=g.prev,se=g.strstart+R,ve=Q[F+q-1],he=Q[F+q];g.prev_length>=g.good_match&&(S>>=2),Y>g.lookahead&&(Y=g.lookahead);do if(Q[(W=U)+q]===he&&Q[W+q-1]===ve&&Q[W]===Q[F]&&Q[++W]===Q[F+1]){F+=2,W++;do;while(Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&Q[++F]===Q[++W]&&F<se);if(O=R-(se-F),F=se-R,q<O){if(g.match_start=U,Y<=(q=O))break;ve=Q[F+q-1],he=Q[F+q]}}while((U=te[U&re])>z&&--S!=0);return q<=g.lookahead?q:g.lookahead}function me(g){var U,W,O,S,F,q,Y,z,Q,re,te=g.w_size;do{if(S=g.window_size-g.lookahead-g.strstart,g.strstart>=te+(te-H)){for(a.arraySet(g.window,g.window,te,te,0),g.match_start-=te,g.strstart-=te,g.block_start-=te,U=W=g.hash_size;O=g.head[--U],g.head[U]=te<=O?O-te:0,--W;);for(U=W=te;O=g.prev[--U],g.prev[U]=te<=O?O-te:0,--W;);S+=te}if(g.strm.avail_in===0)break;if(q=g.strm,Y=g.window,z=g.strstart+g.lookahead,Q=S,re=void 0,re=q.avail_in,Q<re&&(re=Q),W=re===0?0:(q.avail_in-=re,a.arraySet(Y,q.input,q.next_in,re,z),q.state.wrap===1?q.adler=l(q.adler,Y,re,z):q.state.wrap===2&&(q.adler=c(q.adler,Y,re,z)),q.next_in+=re,q.total_in+=re,re),g.lookahead+=W,g.lookahead+g.insert>=D)for(F=g.strstart-g.insert,g.ins_h=g.window[F],g.ins_h=(g.ins_h<<g.hash_shift^g.window[F+1])&g.hash_mask;g.insert&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[F+D-1])&g.hash_mask,g.prev[F&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=F,F++,g.insert--,!(g.lookahead+g.insert<D)););}while(g.lookahead<H&&g.strm.avail_in!==0)}function ge(g,U){for(var W,O;;){if(g.lookahead<H){if(me(g),g.lookahead<H&&U===f)return b;if(g.lookahead===0)break}if(W=0,g.lookahead>=D&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),W!==0&&g.strstart-W<=g.w_size-H&&(g.match_length=Z(g,W)),g.match_length>=D)if(O=i._tr_tally(g,g.strstart-g.match_start,g.match_length-D),g.lookahead-=g.match_length,g.match_length<=g.max_lazy_match&&g.lookahead>=D){for(g.match_length--;g.strstart++,g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart,--g.match_length!=0;);g.strstart++}else g.strstart+=g.match_length,g.match_length=0,g.ins_h=g.window[g.strstart],g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+1])&g.hash_mask;else O=i._tr_tally(g,0,g.window[g.strstart]),g.lookahead--,g.strstart++;if(O&&(B(g,!1),g.strm.avail_out===0))return b}return g.insert=g.strstart<D-1?g.strstart:D-1,U===p?(B(g,!0),g.strm.avail_out===0?ee:P):g.last_lit&&(B(g,!1),g.strm.avail_out===0)?b:$}function ie(g,U){for(var W,O,S;;){if(g.lookahead<H){if(me(g),g.lookahead<H&&U===f)return b;if(g.lookahead===0)break}if(W=0,g.lookahead>=D&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),g.prev_length=g.match_length,g.prev_match=g.match_start,g.match_length=D-1,W!==0&&g.prev_length<g.max_lazy_match&&g.strstart-W<=g.w_size-H&&(g.match_length=Z(g,W),g.match_length<=5&&(g.strategy===1||g.match_length===D&&4096<g.strstart-g.match_start)&&(g.match_length=D-1)),g.prev_length>=D&&g.match_length<=g.prev_length){for(S=g.strstart+g.lookahead-D,O=i._tr_tally(g,g.strstart-1-g.prev_match,g.prev_length-D),g.lookahead-=g.prev_length-1,g.prev_length-=2;++g.strstart<=S&&(g.ins_h=(g.ins_h<<g.hash_shift^g.window[g.strstart+D-1])&g.hash_mask,W=g.prev[g.strstart&g.w_mask]=g.head[g.ins_h],g.head[g.ins_h]=g.strstart),--g.prev_length!=0;);if(g.match_available=0,g.match_length=D-1,g.strstart++,O&&(B(g,!1),g.strm.avail_out===0))return b}else if(g.match_available){if((O=i._tr_tally(g,0,g.window[g.strstart-1]))&&B(g,!1),g.strstart++,g.lookahead--,g.strm.avail_out===0)return b}else g.match_available=1,g.strstart++,g.lookahead--}return g.match_available&&(O=i._tr_tally(g,0,g.window[g.strstart-1]),g.match_available=0),g.insert=g.strstart<D-1?g.strstart:D-1,U===p?(B(g,!0),g.strm.avail_out===0?ee:P):g.last_lit&&(B(g,!1),g.strm.avail_out===0)?b:$}function ce(g,U,W,O,S){this.good_length=g,this.max_lazy=U,this.nice_length=W,this.max_chain=O,this.func=S}function be(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*E),this.dyn_dtree=new a.Buf16(2*(2*x+1)),this.bl_tree=new a.Buf16(2*(2*I+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*k+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ye(g){var U;return g&&g.state?(g.total_in=g.total_out=0,g.data_type=m,(U=g.state).pending=0,U.pending_out=0,U.wrap<0&&(U.wrap=-U.wrap),U.status=U.wrap?j:T,g.adler=U.wrap===2?0:1,U.last_flush=f,i._tr_init(U),d):G(g,w)}function pe(g){var U=ye(g);return U===d&&function(W){W.window_size=2*W.w_size,J(W.head),W.max_lazy_match=s[W.level].max_lazy,W.good_match=s[W.level].good_length,W.nice_match=s[W.level].nice_length,W.max_chain_length=s[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=D-1,W.match_available=0,W.ins_h=0}(g.state),U}function xe(g,U,W,O,S,F){if(!g)return w;var q=1;if(U===h&&(U=6),O<0?(q=0,O=-O):15<O&&(q=2,O-=16),S<1||_<S||W!==v||O<8||15<O||U<0||9<U||F<0||y<F)return G(g,w);O===8&&(O=9);var Y=new be;return(g.state=Y).strm=g,Y.wrap=q,Y.gzhead=null,Y.w_bits=O,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=S+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+D-1)/D),Y.window=new a.Buf8(2*Y.w_size),Y.head=new a.Buf16(Y.hash_size),Y.prev=new a.Buf16(Y.w_size),Y.lit_bufsize=1<<S+6,Y.pending_buf_size=4*Y.lit_bufsize,Y.pending_buf=new a.Buf8(Y.pending_buf_size),Y.d_buf=1*Y.lit_bufsize,Y.l_buf=3*Y.lit_bufsize,Y.level=U,Y.strategy=F,Y.method=W,pe(g)}s=[new ce(0,0,0,0,function(g,U){var W=65535;for(W>g.pending_buf_size-5&&(W=g.pending_buf_size-5);;){if(g.lookahead<=1){if(me(g),g.lookahead===0&&U===f)return b;if(g.lookahead===0)break}g.strstart+=g.lookahead,g.lookahead=0;var O=g.block_start+W;if((g.strstart===0||g.strstart>=O)&&(g.lookahead=g.strstart-O,g.strstart=O,B(g,!1),g.strm.avail_out===0)||g.strstart-g.block_start>=g.w_size-H&&(B(g,!1),g.strm.avail_out===0))return b}return g.insert=0,U===p?(B(g,!0),g.strm.avail_out===0?ee:P):(g.strstart>g.block_start&&(B(g,!1),g.strm.avail_out),b)}),new ce(4,4,8,4,ge),new ce(4,5,16,8,ge),new ce(4,6,32,32,ge),new ce(4,4,16,16,ie),new ce(8,16,32,32,ie),new ce(8,16,128,128,ie),new ce(8,32,128,256,ie),new ce(32,128,258,1024,ie),new ce(32,258,258,4096,ie)],o.deflateInit=function(g,U){return xe(g,U,v,15,8,0)},o.deflateInit2=xe,o.deflateReset=pe,o.deflateResetKeep=ye,o.deflateSetHeader=function(g,U){return g&&g.state?g.state.wrap!==2?w:(g.state.gzhead=U,d):w},o.deflate=function(g,U){var W,O,S,F;if(!g||!g.state||5<U||U<0)return g?G(g,w):w;if(O=g.state,!g.output||!g.input&&g.avail_in!==0||O.status===666&&U!==p)return G(g,g.avail_out===0?-5:w);if(O.strm=g,W=O.last_flush,O.last_flush=U,O.status===j)if(O.wrap===2)g.adler=0,ne(O,31),ne(O,139),ne(O,8),O.gzhead?(ne(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),ne(O,255&O.gzhead.time),ne(O,O.gzhead.time>>8&255),ne(O,O.gzhead.time>>16&255),ne(O,O.gzhead.time>>24&255),ne(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),ne(O,255&O.gzhead.os),O.gzhead.extra&&O.gzhead.extra.length&&(ne(O,255&O.gzhead.extra.length),ne(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(g.adler=c(g.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=69):(ne(O,0),ne(O,0),ne(O,0),ne(O,0),ne(O,0),ne(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),ne(O,3),O.status=T);else{var q=v+(O.w_bits-8<<4)<<8;q|=(2<=O.strategy||O.level<2?0:O.level<6?1:O.level===6?2:3)<<6,O.strstart!==0&&(q|=32),q+=31-q%31,O.status=T,X(O,q),O.strstart!==0&&(X(O,g.adler>>>16),X(O,65535&g.adler)),g.adler=1}if(O.status===69)if(O.gzhead.extra){for(S=O.pending;O.gzindex<(65535&O.gzhead.extra.length)&&(O.pending!==O.pending_buf_size||(O.gzhead.hcrc&&O.pending>S&&(g.adler=c(g.adler,O.pending_buf,O.pending-S,S)),M(g),S=O.pending,O.pending!==O.pending_buf_size));)ne(O,255&O.gzhead.extra[O.gzindex]),O.gzindex++;O.gzhead.hcrc&&O.pending>S&&(g.adler=c(g.adler,O.pending_buf,O.pending-S,S)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=73)}else O.status=73;if(O.status===73)if(O.gzhead.name){S=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>S&&(g.adler=c(g.adler,O.pending_buf,O.pending-S,S)),M(g),S=O.pending,O.pending===O.pending_buf_size)){F=1;break}F=O.gzindex<O.gzhead.name.length?255&O.gzhead.name.charCodeAt(O.gzindex++):0,ne(O,F)}while(F!==0);O.gzhead.hcrc&&O.pending>S&&(g.adler=c(g.adler,O.pending_buf,O.pending-S,S)),F===0&&(O.gzindex=0,O.status=91)}else O.status=91;if(O.status===91)if(O.gzhead.comment){S=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>S&&(g.adler=c(g.adler,O.pending_buf,O.pending-S,S)),M(g),S=O.pending,O.pending===O.pending_buf_size)){F=1;break}F=O.gzindex<O.gzhead.comment.length?255&O.gzhead.comment.charCodeAt(O.gzindex++):0,ne(O,F)}while(F!==0);O.gzhead.hcrc&&O.pending>S&&(g.adler=c(g.adler,O.pending_buf,O.pending-S,S)),F===0&&(O.status=103)}else O.status=103;if(O.status===103&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&M(g),O.pending+2<=O.pending_buf_size&&(ne(O,255&g.adler),ne(O,g.adler>>8&255),g.adler=0,O.status=T)):O.status=T),O.pending!==0){if(M(g),g.avail_out===0)return O.last_flush=-1,d}else if(g.avail_in===0&&L(U)<=L(W)&&U!==p)return G(g,-5);if(O.status===666&&g.avail_in!==0)return G(g,-5);if(g.avail_in!==0||O.lookahead!==0||U!==f&&O.status!==666){var Y=O.strategy===2?function(z,Q){for(var re;;){if(z.lookahead===0&&(me(z),z.lookahead===0)){if(Q===f)return b;break}if(z.match_length=0,re=i._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,re&&(B(z,!1),z.strm.avail_out===0))return b}return z.insert=0,Q===p?(B(z,!0),z.strm.avail_out===0?ee:P):z.last_lit&&(B(z,!1),z.strm.avail_out===0)?b:$}(O,U):O.strategy===3?function(z,Q){for(var re,te,se,ve,he=z.window;;){if(z.lookahead<=R){if(me(z),z.lookahead<=R&&Q===f)return b;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=D&&0<z.strstart&&(te=he[se=z.strstart-1])===he[++se]&&te===he[++se]&&te===he[++se]){ve=z.strstart+R;do;while(te===he[++se]&&te===he[++se]&&te===he[++se]&&te===he[++se]&&te===he[++se]&&te===he[++se]&&te===he[++se]&&te===he[++se]&&se<ve);z.match_length=R-(ve-se),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=D?(re=i._tr_tally(z,1,z.match_length-D),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(re=i._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),re&&(B(z,!1),z.strm.avail_out===0))return b}return z.insert=0,Q===p?(B(z,!0),z.strm.avail_out===0?ee:P):z.last_lit&&(B(z,!1),z.strm.avail_out===0)?b:$}(O,U):s[O.level].func(O,U);if(Y!==ee&&Y!==P||(O.status=666),Y===b||Y===ee)return g.avail_out===0&&(O.last_flush=-1),d;if(Y===$&&(U===1?i._tr_align(O):U!==5&&(i._tr_stored_block(O,0,0,!1),U===3&&(J(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),M(g),g.avail_out===0))return O.last_flush=-1,d}return U!==p?d:O.wrap<=0?1:(O.wrap===2?(ne(O,255&g.adler),ne(O,g.adler>>8&255),ne(O,g.adler>>16&255),ne(O,g.adler>>24&255),ne(O,255&g.total_in),ne(O,g.total_in>>8&255),ne(O,g.total_in>>16&255),ne(O,g.total_in>>24&255)):(X(O,g.adler>>>16),X(O,65535&g.adler)),M(g),0<O.wrap&&(O.wrap=-O.wrap),O.pending!==0?d:1)},o.deflateEnd=function(g){var U;return g&&g.state?(U=g.state.status)!==j&&U!==69&&U!==73&&U!==91&&U!==103&&U!==T&&U!==666?G(g,w):(g.state=null,U===T?G(g,-3):d):w},o.deflateSetDictionary=function(g,U){var W,O,S,F,q,Y,z,Q,re=U.length;if(!g||!g.state||(F=(W=g.state).wrap)===2||F===1&&W.status!==j||W.lookahead)return w;for(F===1&&(g.adler=l(g.adler,U,re,0)),W.wrap=0,re>=W.w_size&&(F===0&&(J(W.head),W.strstart=0,W.block_start=0,W.insert=0),Q=new a.Buf8(W.w_size),a.arraySet(Q,U,re-W.w_size,W.w_size,0),U=Q,re=W.w_size),q=g.avail_in,Y=g.next_in,z=g.input,g.avail_in=re,g.next_in=0,g.input=U,me(W);W.lookahead>=D;){for(O=W.strstart,S=W.lookahead-(D-1);W.ins_h=(W.ins_h<<W.hash_shift^W.window[O+D-1])&W.hash_mask,W.prev[O&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=O,O++,--S;);W.strstart=O,W.lookahead=D-1,me(W)}return W.strstart+=W.lookahead,W.block_start=W.strstart,W.insert=W.lookahead,W.lookahead=0,W.match_length=W.prev_length=D-1,W.match_available=0,g.next_in=Y,g.input=z,g.avail_in=q,W.wrap=F,d},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,o){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,o){r.exports=function(s,a){var i,l,c,u,f,p,d,w,h,y,m,v,_,k,x,I,E,N,D,R,H,j,T,b,$;i=s.state,l=s.next_in,b=s.input,c=l+(s.avail_in-5),u=s.next_out,$=s.output,f=u-(a-s.avail_out),p=u+(s.avail_out-257),d=i.dmax,w=i.wsize,h=i.whave,y=i.wnext,m=i.window,v=i.hold,_=i.bits,k=i.lencode,x=i.distcode,I=(1<<i.lenbits)-1,E=(1<<i.distbits)-1;e:do{_<15&&(v+=b[l++]<<_,_+=8,v+=b[l++]<<_,_+=8),N=k[v&I];t:for(;;){if(v>>>=D=N>>>24,_-=D,(D=N>>>16&255)===0)$[u++]=65535&N;else{if(!(16&D)){if(!(64&D)){N=k[(65535&N)+(v&(1<<D)-1)];continue t}if(32&D){i.mode=12;break e}s.msg="invalid literal/length code",i.mode=30;break e}R=65535&N,(D&=15)&&(_<D&&(v+=b[l++]<<_,_+=8),R+=v&(1<<D)-1,v>>>=D,_-=D),_<15&&(v+=b[l++]<<_,_+=8,v+=b[l++]<<_,_+=8),N=x[v&E];n:for(;;){if(v>>>=D=N>>>24,_-=D,!(16&(D=N>>>16&255))){if(!(64&D)){N=x[(65535&N)+(v&(1<<D)-1)];continue n}s.msg="invalid distance code",i.mode=30;break e}if(H=65535&N,_<(D&=15)&&(v+=b[l++]<<_,(_+=8)<D&&(v+=b[l++]<<_,_+=8)),d<(H+=v&(1<<D)-1)){s.msg="invalid distance too far back",i.mode=30;break e}if(v>>>=D,_-=D,(D=u-f)<H){if(h<(D=H-D)&&i.sane){s.msg="invalid distance too far back",i.mode=30;break e}if(T=m,(j=0)===y){if(j+=w-D,D<R){for(R-=D;$[u++]=m[j++],--D;);j=u-H,T=$}}else if(y<D){if(j+=w+y-D,(D-=y)<R){for(R-=D;$[u++]=m[j++],--D;);if(j=0,y<R){for(R-=D=y;$[u++]=m[j++],--D;);j=u-H,T=$}}}else if(j+=y-D,D<R){for(R-=D;$[u++]=m[j++],--D;);j=u-H,T=$}for(;2<R;)$[u++]=T[j++],$[u++]=T[j++],$[u++]=T[j++],R-=3;R&&($[u++]=T[j++],1<R&&($[u++]=T[j++]))}else{for(j=u-H;$[u++]=$[j++],$[u++]=$[j++],$[u++]=$[j++],2<(R-=3););R&&($[u++]=$[j++],1<R&&($[u++]=$[j++]))}break}}break}}while(l<c&&u<p);l-=R=_>>3,v&=(1<<(_-=R<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<p?p-u+257:257-(u-p),i.hold=v,i.bits=_}},{}],49:[function(n,r,o){var s=n("../utils/common"),a=n("./adler32"),i=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,f=2,p=0,d=-2,w=1,h=852,y=592;function m(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _(j){var T;return j&&j.state?(T=j.state,j.total_in=j.total_out=T.total=0,j.msg="",T.wrap&&(j.adler=1&T.wrap),T.mode=w,T.last=0,T.havedict=0,T.dmax=32768,T.head=null,T.hold=0,T.bits=0,T.lencode=T.lendyn=new s.Buf32(h),T.distcode=T.distdyn=new s.Buf32(y),T.sane=1,T.back=-1,p):d}function k(j){var T;return j&&j.state?((T=j.state).wsize=0,T.whave=0,T.wnext=0,_(j)):d}function x(j,T){var b,$;return j&&j.state?($=j.state,T<0?(b=0,T=-T):(b=1+(T>>4),T<48&&(T&=15)),T&&(T<8||15<T)?d:($.window!==null&&$.wbits!==T&&($.window=null),$.wrap=b,$.wbits=T,k(j))):d}function I(j,T){var b,$;return j?($=new v,(j.state=$).window=null,(b=x(j,T))!==p&&(j.state=null),b):d}var E,N,D=!0;function R(j){if(D){var T;for(E=new s.Buf32(512),N=new s.Buf32(32),T=0;T<144;)j.lens[T++]=8;for(;T<256;)j.lens[T++]=9;for(;T<280;)j.lens[T++]=7;for(;T<288;)j.lens[T++]=8;for(c(u,j.lens,0,288,E,0,j.work,{bits:9}),T=0;T<32;)j.lens[T++]=5;c(f,j.lens,0,32,N,0,j.work,{bits:5}),D=!1}j.lencode=E,j.lenbits=9,j.distcode=N,j.distbits=5}function H(j,T,b,$){var ee,P=j.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new s.Buf8(P.wsize)),$>=P.wsize?(s.arraySet(P.window,T,b-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):($<(ee=P.wsize-P.wnext)&&(ee=$),s.arraySet(P.window,T,b-$,ee,P.wnext),($-=ee)?(s.arraySet(P.window,T,b-$,$,0),P.wnext=$,P.whave=P.wsize):(P.wnext+=ee,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=ee))),0}o.inflateReset=k,o.inflateReset2=x,o.inflateResetKeep=_,o.inflateInit=function(j){return I(j,15)},o.inflateInit2=I,o.inflate=function(j,T){var b,$,ee,P,G,L,J,M,B,ne,X,Z,me,ge,ie,ce,be,ye,pe,xe,g,U,W,O,S=0,F=new s.Buf8(4),q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return d;(b=j.state).mode===12&&(b.mode=13),G=j.next_out,ee=j.output,J=j.avail_out,P=j.next_in,$=j.input,L=j.avail_in,M=b.hold,B=b.bits,ne=L,X=J,U=p;e:for(;;)switch(b.mode){case w:if(b.wrap===0){b.mode=13;break}for(;B<16;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(2&b.wrap&&M===35615){F[b.check=0]=255&M,F[1]=M>>>8&255,b.check=i(b.check,F,2,0),B=M=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&M)<<8)+(M>>8))%31){j.msg="incorrect header check",b.mode=30;break}if((15&M)!=8){j.msg="unknown compression method",b.mode=30;break}if(B-=4,g=8+(15&(M>>>=4)),b.wbits===0)b.wbits=g;else if(g>b.wbits){j.msg="invalid window size",b.mode=30;break}b.dmax=1<<g,j.adler=b.check=1,b.mode=512&M?10:12,B=M=0;break;case 2:for(;B<16;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(b.flags=M,(255&b.flags)!=8){j.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){j.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=M>>8&1),512&b.flags&&(F[0]=255&M,F[1]=M>>>8&255,b.check=i(b.check,F,2,0)),B=M=0,b.mode=3;case 3:for(;B<32;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}b.head&&(b.head.time=M),512&b.flags&&(F[0]=255&M,F[1]=M>>>8&255,F[2]=M>>>16&255,F[3]=M>>>24&255,b.check=i(b.check,F,4,0)),B=M=0,b.mode=4;case 4:for(;B<16;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}b.head&&(b.head.xflags=255&M,b.head.os=M>>8),512&b.flags&&(F[0]=255&M,F[1]=M>>>8&255,b.check=i(b.check,F,2,0)),B=M=0,b.mode=5;case 5:if(1024&b.flags){for(;B<16;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}b.length=M,b.head&&(b.head.extra_len=M),512&b.flags&&(F[0]=255&M,F[1]=M>>>8&255,b.check=i(b.check,F,2,0)),B=M=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(L<(Z=b.length)&&(Z=L),Z&&(b.head&&(g=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),s.arraySet(b.head.extra,$,P,Z,g)),512&b.flags&&(b.check=i(b.check,$,Z,P)),L-=Z,P+=Z,b.length-=Z),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(L===0)break e;for(Z=0;g=$[P+Z++],b.head&&g&&b.length<65536&&(b.head.name+=String.fromCharCode(g)),g&&Z<L;);if(512&b.flags&&(b.check=i(b.check,$,Z,P)),L-=Z,P+=Z,g)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(L===0)break e;for(Z=0;g=$[P+Z++],b.head&&g&&b.length<65536&&(b.head.comment+=String.fromCharCode(g)),g&&Z<L;);if(512&b.flags&&(b.check=i(b.check,$,Z,P)),L-=Z,P+=Z,g)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;B<16;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(M!==(65535&b.check)){j.msg="header crc mismatch",b.mode=30;break}B=M=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),j.adler=b.check=0,b.mode=12;break;case 10:for(;B<32;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}j.adler=b.check=m(M),B=M=0,b.mode=11;case 11:if(b.havedict===0)return j.next_out=G,j.avail_out=J,j.next_in=P,j.avail_in=L,b.hold=M,b.bits=B,2;j.adler=b.check=1,b.mode=12;case 12:if(T===5||T===6)break e;case 13:if(b.last){M>>>=7&B,B-=7&B,b.mode=27;break}for(;B<3;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}switch(b.last=1&M,B-=1,3&(M>>>=1)){case 0:b.mode=14;break;case 1:if(R(b),b.mode=20,T!==6)break;M>>>=2,B-=2;break e;case 2:b.mode=17;break;case 3:j.msg="invalid block type",b.mode=30}M>>>=2,B-=2;break;case 14:for(M>>>=7&B,B-=7&B;B<32;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if((65535&M)!=(M>>>16^65535)){j.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&M,B=M=0,b.mode=15,T===6)break e;case 15:b.mode=16;case 16:if(Z=b.length){if(L<Z&&(Z=L),J<Z&&(Z=J),Z===0)break e;s.arraySet(ee,$,P,Z,G),L-=Z,P+=Z,J-=Z,G+=Z,b.length-=Z;break}b.mode=12;break;case 17:for(;B<14;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(b.nlen=257+(31&M),M>>>=5,B-=5,b.ndist=1+(31&M),M>>>=5,B-=5,b.ncode=4+(15&M),M>>>=4,B-=4,286<b.nlen||30<b.ndist){j.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;B<3;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}b.lens[q[b.have++]]=7&M,M>>>=3,B-=3}for(;b.have<19;)b.lens[q[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,W={bits:b.lenbits},U=c(0,b.lens,0,19,b.lencode,0,b.work,W),b.lenbits=W.bits,U){j.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;ce=(S=b.lencode[M&(1<<b.lenbits)-1])>>>16&255,be=65535&S,!((ie=S>>>24)<=B);){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(be<16)M>>>=ie,B-=ie,b.lens[b.have++]=be;else{if(be===16){for(O=ie+2;B<O;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(M>>>=ie,B-=ie,b.have===0){j.msg="invalid bit length repeat",b.mode=30;break}g=b.lens[b.have-1],Z=3+(3&M),M>>>=2,B-=2}else if(be===17){for(O=ie+3;B<O;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}B-=ie,g=0,Z=3+(7&(M>>>=ie)),M>>>=3,B-=3}else{for(O=ie+7;B<O;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}B-=ie,g=0,Z=11+(127&(M>>>=ie)),M>>>=7,B-=7}if(b.have+Z>b.nlen+b.ndist){j.msg="invalid bit length repeat",b.mode=30;break}for(;Z--;)b.lens[b.have++]=g}}if(b.mode===30)break;if(b.lens[256]===0){j.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,W={bits:b.lenbits},U=c(u,b.lens,0,b.nlen,b.lencode,0,b.work,W),b.lenbits=W.bits,U){j.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,W={bits:b.distbits},U=c(f,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,W),b.distbits=W.bits,U){j.msg="invalid distances set",b.mode=30;break}if(b.mode=20,T===6)break e;case 20:b.mode=21;case 21:if(6<=L&&258<=J){j.next_out=G,j.avail_out=J,j.next_in=P,j.avail_in=L,b.hold=M,b.bits=B,l(j,X),G=j.next_out,ee=j.output,J=j.avail_out,P=j.next_in,$=j.input,L=j.avail_in,M=b.hold,B=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;ce=(S=b.lencode[M&(1<<b.lenbits)-1])>>>16&255,be=65535&S,!((ie=S>>>24)<=B);){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(ce&&!(240&ce)){for(ye=ie,pe=ce,xe=be;ce=(S=b.lencode[xe+((M&(1<<ye+pe)-1)>>ye)])>>>16&255,be=65535&S,!(ye+(ie=S>>>24)<=B);){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}M>>>=ye,B-=ye,b.back+=ye}if(M>>>=ie,B-=ie,b.back+=ie,b.length=be,ce===0){b.mode=26;break}if(32&ce){b.back=-1,b.mode=12;break}if(64&ce){j.msg="invalid literal/length code",b.mode=30;break}b.extra=15&ce,b.mode=22;case 22:if(b.extra){for(O=b.extra;B<O;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}b.length+=M&(1<<b.extra)-1,M>>>=b.extra,B-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;ce=(S=b.distcode[M&(1<<b.distbits)-1])>>>16&255,be=65535&S,!((ie=S>>>24)<=B);){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(!(240&ce)){for(ye=ie,pe=ce,xe=be;ce=(S=b.distcode[xe+((M&(1<<ye+pe)-1)>>ye)])>>>16&255,be=65535&S,!(ye+(ie=S>>>24)<=B);){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}M>>>=ye,B-=ye,b.back+=ye}if(M>>>=ie,B-=ie,b.back+=ie,64&ce){j.msg="invalid distance code",b.mode=30;break}b.offset=be,b.extra=15&ce,b.mode=24;case 24:if(b.extra){for(O=b.extra;B<O;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}b.offset+=M&(1<<b.extra)-1,M>>>=b.extra,B-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){j.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(J===0)break e;if(Z=X-J,b.offset>Z){if((Z=b.offset-Z)>b.whave&&b.sane){j.msg="invalid distance too far back",b.mode=30;break}me=Z>b.wnext?(Z-=b.wnext,b.wsize-Z):b.wnext-Z,Z>b.length&&(Z=b.length),ge=b.window}else ge=ee,me=G-b.offset,Z=b.length;for(J<Z&&(Z=J),J-=Z,b.length-=Z;ee[G++]=ge[me++],--Z;);b.length===0&&(b.mode=21);break;case 26:if(J===0)break e;ee[G++]=b.length,J--,b.mode=21;break;case 27:if(b.wrap){for(;B<32;){if(L===0)break e;L--,M|=$[P++]<<B,B+=8}if(X-=J,j.total_out+=X,b.total+=X,X&&(j.adler=b.check=b.flags?i(b.check,ee,X,G-X):a(b.check,ee,X,G-X)),X=J,(b.flags?M:m(M))!==b.check){j.msg="incorrect data check",b.mode=30;break}B=M=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;B<32;){if(L===0)break e;L--,M+=$[P++]<<B,B+=8}if(M!==(4294967295&b.total)){j.msg="incorrect length check",b.mode=30;break}B=M=0}b.mode=29;case 29:U=1;break e;case 30:U=-3;break e;case 31:return-4;case 32:default:return d}return j.next_out=G,j.avail_out=J,j.next_in=P,j.avail_in=L,b.hold=M,b.bits=B,(b.wsize||X!==j.avail_out&&b.mode<30&&(b.mode<27||T!==4))&&H(j,j.output,j.next_out,X-j.avail_out)?(b.mode=31,-4):(ne-=j.avail_in,X-=j.avail_out,j.total_in+=ne,j.total_out+=X,b.total+=X,b.wrap&&X&&(j.adler=b.check=b.flags?i(b.check,ee,X,j.next_out-X):a(b.check,ee,X,j.next_out-X)),j.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(ne==0&&X===0||T===4)&&U===p&&(U=-5),U)},o.inflateEnd=function(j){if(!j||!j.state)return d;var T=j.state;return T.window&&(T.window=null),j.state=null,p},o.inflateGetHeader=function(j,T){var b;return j&&j.state&&2&(b=j.state).wrap?((b.head=T).done=!1,p):d},o.inflateSetDictionary=function(j,T){var b,$=T.length;return j&&j.state?(b=j.state).wrap!==0&&b.mode!==11?d:b.mode===11&&a(1,T,$,0)!==b.check?-3:H(j,T,$,$)?(b.mode=31,-4):(b.havedict=1,p):d},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,o){var s=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,p,d,w,h,y,m){var v,_,k,x,I,E,N,D,R,H=m.bits,j=0,T=0,b=0,$=0,ee=0,P=0,G=0,L=0,J=0,M=0,B=null,ne=0,X=new s.Buf16(16),Z=new s.Buf16(16),me=null,ge=0;for(j=0;j<=15;j++)X[j]=0;for(T=0;T<d;T++)X[f[p+T]]++;for(ee=H,$=15;1<=$&&X[$]===0;$--);if($<ee&&(ee=$),$===0)return w[h++]=20971520,w[h++]=20971520,m.bits=1,0;for(b=1;b<$&&X[b]===0;b++);for(ee<b&&(ee=b),j=L=1;j<=15;j++)if(L<<=1,(L-=X[j])<0)return-1;if(0<L&&(u===0||$!==1))return-1;for(Z[1]=0,j=1;j<15;j++)Z[j+1]=Z[j]+X[j];for(T=0;T<d;T++)f[p+T]!==0&&(y[Z[f[p+T]]++]=T);if(E=u===0?(B=me=y,19):u===1?(B=a,ne-=257,me=i,ge-=257,256):(B=l,me=c,-1),j=b,I=h,G=T=M=0,k=-1,x=(J=1<<(P=ee))-1,u===1&&852<J||u===2&&592<J)return 1;for(;;){for(N=j-G,R=y[T]<E?(D=0,y[T]):y[T]>E?(D=me[ge+y[T]],B[ne+y[T]]):(D=96,0),v=1<<j-G,b=_=1<<P;w[I+(M>>G)+(_-=v)]=N<<24|D<<16|R|0,_!==0;);for(v=1<<j-1;M&v;)v>>=1;if(v!==0?(M&=v-1,M+=v):M=0,T++,--X[j]==0){if(j===$)break;j=f[p+y[T]]}if(ee<j&&(M&x)!==k){for(G===0&&(G=ee),I+=b,L=1<<(P=j-G);P+G<$&&!((L-=X[P+G])<=0);)P++,L<<=1;if(J+=1<<P,u===1&&852<J||u===2&&592<J)return 1;w[k=M&x]=ee<<24|P<<16|I-h|0}}return M!==0&&(w[I+M]=j-G<<24|64<<16|0),m.bits=ee,0}},{"../utils/common":41}],51:[function(n,r,o){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,o){var s=n("../utils/common"),a=0,i=1;function l(S){for(var F=S.length;0<=--F;)S[F]=0}var c=0,u=29,f=256,p=f+1+u,d=30,w=19,h=2*p+1,y=15,m=16,v=7,_=256,k=16,x=17,I=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],H=new Array(2*(p+2));l(H);var j=new Array(2*d);l(j);var T=new Array(512);l(T);var b=new Array(256);l(b);var $=new Array(u);l($);var ee,P,G,L=new Array(d);function J(S,F,q,Y,z){this.static_tree=S,this.extra_bits=F,this.extra_base=q,this.elems=Y,this.max_length=z,this.has_stree=S&&S.length}function M(S,F){this.dyn_tree=S,this.max_code=0,this.stat_desc=F}function B(S){return S<256?T[S]:T[256+(S>>>7)]}function ne(S,F){S.pending_buf[S.pending++]=255&F,S.pending_buf[S.pending++]=F>>>8&255}function X(S,F,q){S.bi_valid>m-q?(S.bi_buf|=F<<S.bi_valid&65535,ne(S,S.bi_buf),S.bi_buf=F>>m-S.bi_valid,S.bi_valid+=q-m):(S.bi_buf|=F<<S.bi_valid&65535,S.bi_valid+=q)}function Z(S,F,q){X(S,q[2*F],q[2*F+1])}function me(S,F){for(var q=0;q|=1&S,S>>>=1,q<<=1,0<--F;);return q>>>1}function ge(S,F,q){var Y,z,Q=new Array(y+1),re=0;for(Y=1;Y<=y;Y++)Q[Y]=re=re+q[Y-1]<<1;for(z=0;z<=F;z++){var te=S[2*z+1];te!==0&&(S[2*z]=me(Q[te]++,te))}}function ie(S){var F;for(F=0;F<p;F++)S.dyn_ltree[2*F]=0;for(F=0;F<d;F++)S.dyn_dtree[2*F]=0;for(F=0;F<w;F++)S.bl_tree[2*F]=0;S.dyn_ltree[2*_]=1,S.opt_len=S.static_len=0,S.last_lit=S.matches=0}function ce(S){8<S.bi_valid?ne(S,S.bi_buf):0<S.bi_valid&&(S.pending_buf[S.pending++]=S.bi_buf),S.bi_buf=0,S.bi_valid=0}function be(S,F,q,Y){var z=2*F,Q=2*q;return S[z]<S[Q]||S[z]===S[Q]&&Y[F]<=Y[q]}function ye(S,F,q){for(var Y=S.heap[q],z=q<<1;z<=S.heap_len&&(z<S.heap_len&&be(F,S.heap[z+1],S.heap[z],S.depth)&&z++,!be(F,Y,S.heap[z],S.depth));)S.heap[q]=S.heap[z],q=z,z<<=1;S.heap[q]=Y}function pe(S,F,q){var Y,z,Q,re,te=0;if(S.last_lit!==0)for(;Y=S.pending_buf[S.d_buf+2*te]<<8|S.pending_buf[S.d_buf+2*te+1],z=S.pending_buf[S.l_buf+te],te++,Y===0?Z(S,z,F):(Z(S,(Q=b[z])+f+1,F),(re=E[Q])!==0&&X(S,z-=$[Q],re),Z(S,Q=B(--Y),q),(re=N[Q])!==0&&X(S,Y-=L[Q],re)),te<S.last_lit;);Z(S,_,F)}function xe(S,F){var q,Y,z,Q=F.dyn_tree,re=F.stat_desc.static_tree,te=F.stat_desc.has_stree,se=F.stat_desc.elems,ve=-1;for(S.heap_len=0,S.heap_max=h,q=0;q<se;q++)Q[2*q]!==0?(S.heap[++S.heap_len]=ve=q,S.depth[q]=0):Q[2*q+1]=0;for(;S.heap_len<2;)Q[2*(z=S.heap[++S.heap_len]=ve<2?++ve:0)]=1,S.depth[z]=0,S.opt_len--,te&&(S.static_len-=re[2*z+1]);for(F.max_code=ve,q=S.heap_len>>1;1<=q;q--)ye(S,Q,q);for(z=se;q=S.heap[1],S.heap[1]=S.heap[S.heap_len--],ye(S,Q,1),Y=S.heap[1],S.heap[--S.heap_max]=q,S.heap[--S.heap_max]=Y,Q[2*z]=Q[2*q]+Q[2*Y],S.depth[z]=(S.depth[q]>=S.depth[Y]?S.depth[q]:S.depth[Y])+1,Q[2*q+1]=Q[2*Y+1]=z,S.heap[1]=z++,ye(S,Q,1),2<=S.heap_len;);S.heap[--S.heap_max]=S.heap[1],function(he,Ze){var gn,rt,wn,Pe,Yn,ro,ft=Ze.dyn_tree,Ks=Ze.max_code,dl=Ze.stat_desc.static_tree,fl=Ze.stat_desc.has_stree,hl=Ze.stat_desc.extra_bits,$s=Ze.stat_desc.extra_base,bn=Ze.stat_desc.max_length,Jn=0;for(Pe=0;Pe<=y;Pe++)he.bl_count[Pe]=0;for(ft[2*he.heap[he.heap_max]+1]=0,gn=he.heap_max+1;gn<h;gn++)bn<(Pe=ft[2*ft[2*(rt=he.heap[gn])+1]+1]+1)&&(Pe=bn,Jn++),ft[2*rt+1]=Pe,Ks<rt||(he.bl_count[Pe]++,Yn=0,$s<=rt&&(Yn=hl[rt-$s]),ro=ft[2*rt],he.opt_len+=ro*(Pe+Yn),fl&&(he.static_len+=ro*(dl[2*rt+1]+Yn)));if(Jn!==0){do{for(Pe=bn-1;he.bl_count[Pe]===0;)Pe--;he.bl_count[Pe]--,he.bl_count[Pe+1]+=2,he.bl_count[bn]--,Jn-=2}while(0<Jn);for(Pe=bn;Pe!==0;Pe--)for(rt=he.bl_count[Pe];rt!==0;)Ks<(wn=he.heap[--gn])||(ft[2*wn+1]!==Pe&&(he.opt_len+=(Pe-ft[2*wn+1])*ft[2*wn],ft[2*wn+1]=Pe),rt--)}}(S,F),ge(Q,ve,S.bl_count)}function g(S,F,q){var Y,z,Q=-1,re=F[1],te=0,se=7,ve=4;for(re===0&&(se=138,ve=3),F[2*(q+1)+1]=65535,Y=0;Y<=q;Y++)z=re,re=F[2*(Y+1)+1],++te<se&&z===re||(te<ve?S.bl_tree[2*z]+=te:z!==0?(z!==Q&&S.bl_tree[2*z]++,S.bl_tree[2*k]++):te<=10?S.bl_tree[2*x]++:S.bl_tree[2*I]++,Q=z,ve=(te=0)===re?(se=138,3):z===re?(se=6,3):(se=7,4))}function U(S,F,q){var Y,z,Q=-1,re=F[1],te=0,se=7,ve=4;for(re===0&&(se=138,ve=3),Y=0;Y<=q;Y++)if(z=re,re=F[2*(Y+1)+1],!(++te<se&&z===re)){if(te<ve)for(;Z(S,z,S.bl_tree),--te!=0;);else z!==0?(z!==Q&&(Z(S,z,S.bl_tree),te--),Z(S,k,S.bl_tree),X(S,te-3,2)):te<=10?(Z(S,x,S.bl_tree),X(S,te-3,3)):(Z(S,I,S.bl_tree),X(S,te-11,7));Q=z,ve=(te=0)===re?(se=138,3):z===re?(se=6,3):(se=7,4)}}l(L);var W=!1;function O(S,F,q,Y){X(S,(c<<1)+(Y?1:0),3),function(z,Q,re,te){ce(z),te&&(ne(z,re),ne(z,~re)),s.arraySet(z.pending_buf,z.window,Q,re,z.pending),z.pending+=re}(S,F,q,!0)}o._tr_init=function(S){W||(function(){var F,q,Y,z,Q,re=new Array(y+1);for(z=Y=0;z<u-1;z++)for($[z]=Y,F=0;F<1<<E[z];F++)b[Y++]=z;for(b[Y-1]=z,z=Q=0;z<16;z++)for(L[z]=Q,F=0;F<1<<N[z];F++)T[Q++]=z;for(Q>>=7;z<d;z++)for(L[z]=Q<<7,F=0;F<1<<N[z]-7;F++)T[256+Q++]=z;for(q=0;q<=y;q++)re[q]=0;for(F=0;F<=143;)H[2*F+1]=8,F++,re[8]++;for(;F<=255;)H[2*F+1]=9,F++,re[9]++;for(;F<=279;)H[2*F+1]=7,F++,re[7]++;for(;F<=287;)H[2*F+1]=8,F++,re[8]++;for(ge(H,p+1,re),F=0;F<d;F++)j[2*F+1]=5,j[2*F]=me(F,5);ee=new J(H,E,f+1,p,y),P=new J(j,N,0,d,y),G=new J(new Array(0),D,0,w,v)}(),W=!0),S.l_desc=new M(S.dyn_ltree,ee),S.d_desc=new M(S.dyn_dtree,P),S.bl_desc=new M(S.bl_tree,G),S.bi_buf=0,S.bi_valid=0,ie(S)},o._tr_stored_block=O,o._tr_flush_block=function(S,F,q,Y){var z,Q,re=0;0<S.level?(S.strm.data_type===2&&(S.strm.data_type=function(te){var se,ve=4093624447;for(se=0;se<=31;se++,ve>>>=1)if(1&ve&&te.dyn_ltree[2*se]!==0)return a;if(te.dyn_ltree[18]!==0||te.dyn_ltree[20]!==0||te.dyn_ltree[26]!==0)return i;for(se=32;se<f;se++)if(te.dyn_ltree[2*se]!==0)return i;return a}(S)),xe(S,S.l_desc),xe(S,S.d_desc),re=function(te){var se;for(g(te,te.dyn_ltree,te.l_desc.max_code),g(te,te.dyn_dtree,te.d_desc.max_code),xe(te,te.bl_desc),se=w-1;3<=se&&te.bl_tree[2*R[se]+1]===0;se--);return te.opt_len+=3*(se+1)+5+5+4,se}(S),z=S.opt_len+3+7>>>3,(Q=S.static_len+3+7>>>3)<=z&&(z=Q)):z=Q=q+5,q+4<=z&&F!==-1?O(S,F,q,Y):S.strategy===4||Q===z?(X(S,2+(Y?1:0),3),pe(S,H,j)):(X(S,4+(Y?1:0),3),function(te,se,ve,he){var Ze;for(X(te,se-257,5),X(te,ve-1,5),X(te,he-4,4),Ze=0;Ze<he;Ze++)X(te,te.bl_tree[2*R[Ze]+1],3);U(te,te.dyn_ltree,se-1),U(te,te.dyn_dtree,ve-1)}(S,S.l_desc.max_code+1,S.d_desc.max_code+1,re+1),pe(S,S.dyn_ltree,S.dyn_dtree)),ie(S),Y&&ce(S)},o._tr_tally=function(S,F,q){return S.pending_buf[S.d_buf+2*S.last_lit]=F>>>8&255,S.pending_buf[S.d_buf+2*S.last_lit+1]=255&F,S.pending_buf[S.l_buf+S.last_lit]=255&q,S.last_lit++,F===0?S.dyn_ltree[2*q]++:(S.matches++,F--,S.dyn_ltree[2*(b[q]+f+1)]++,S.dyn_dtree[2*B(F)]++),S.last_lit===S.lit_bufsize-1},o._tr_align=function(S){X(S,2,3),Z(S,_,H),function(F){F.bi_valid===16?(ne(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):8<=F.bi_valid&&(F.pending_buf[F.pending++]=255&F.bi_buf,F.bi_buf>>=8,F.bi_valid-=8)}(S)}},{"../utils/common":41}],53:[function(n,r,o){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,o){(function(s){(function(a,i){if(!a.setImmediate){var l,c,u,f,p=1,d={},w=!1,h=a.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(a);y=y&&y.setTimeout?y:a,l={}.toString.call(a.process)==="[object process]"?function(k){process.nextTick(function(){v(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,x=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=x,k}}()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",_,!1):a.attachEvent("onmessage",_),function(k){a.postMessage(f+k,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(k){v(k.data)},function(k){u.port2.postMessage(k)}):h&&"onreadystatechange"in h.createElement("script")?(c=h.documentElement,function(k){var x=h.createElement("script");x.onreadystatechange=function(){v(k),x.onreadystatechange=null,c.removeChild(x),x=null},c.appendChild(x)}):function(k){setTimeout(v,0,k)},y.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var x=new Array(arguments.length-1),I=0;I<x.length;I++)x[I]=arguments[I+1];var E={callback:k,args:x};return d[p]=E,l(p),p++},y.clearImmediate=m}function m(k){delete d[k]}function v(k){if(w)setTimeout(v,0,k);else{var x=d[k];if(x){w=!0;try{(function(I){var E=I.callback,N=I.args;switch(N.length){case 0:E();break;case 1:E(N[0]);break;case 2:E(N[0],N[1]);break;case 3:E(N[0],N[1],N[2]);break;default:E.apply(i,N)}})(x)}finally{m(k),w=!1}}}}function _(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(f)===0&&v(+k.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Xn<"u"?Xn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ul);var op=ul.exports;const sp=Ea(op);async function ap(t){let e="",n=t;for(;n!=null;){const r=await(lt==null?void 0:lt.get(n));if(r==null)break;e=`${r.name}/${e}`,n=r.parentFolderID??null}return e}async function Bp(t){if(await(V==null?void 0:V.getSetting("twoWaySync")))return await St.genFilesCountInFolder(t)??0;const n=await(K==null?void 0:K.listAll())??[],r=await(lt==null?void 0:lt.listAll())??[],o=[t];let s=0;for(;o.length>0;){const a=o.shift();if(a){for(const l of n)l.parentFolderID===a&&s++;const i=r.filter(l=>l.parentFolderID===a).map(l=>l.id);i.length&&o.push(...i)}}return s}const ip=async t=>{const e=`ComfyUI workspace workflows ${Yf(Date.now())}`,n=new sp,r=await(V==null?void 0:V.getSetting("twoWaySync"));for(const o of t){let s;r?s=o.parentFolderID??"":s=await ap(o.parentFolderID??null).then(async i=>Ft(i??""));const a=n.folder(s);a==null||a.file(`${o.name}.json`,o.json)}n.generateAsync({type:"blob"}).then(function(o){const s=document.createElement("a");s.href=window.URL.createObjectURL(o),s.download=`${e}.zip`,document.body.appendChild(s),s.click(),document.body.removeChild(s)})};function lp({myWorkflowsDir:t}){return C.jsxs(It,{gap:3,children:[C.jsx(hs,{size:"md",children:"🦄 Upgrade to 2.0 - enable two way sync!"}),C.jsx("p",{children:"Your workflows will be synced to and from path:"}),C.jsx("p",{children:C.jsx("b",{children:t})}),C.jsxs("p",{children:["You can manually put workflow files into this folder using File Explorer to sync them with your workspace. You can change this path anytime in Settings ",">"," Workspace Save Directory"]}),C.jsxs("p",{children:[C.jsx("b",{children:"Please download all your workflows before enabling two way sync as a backup!"})," ","So you can manually import some workflows into your workspace in case something unexpected happens."]}),C.jsx(Te,{colorScheme:"teal",variant:"outline",width:"fit-content",onClick:async()=>{const e=await(K==null?void 0:K.listAll());ip(e??[])},children:"👉 Download All My Workflows"})]})}ds.lazy(()=>Zt(()=>import("./RecentFilesDrawer-qVaC94nF.js"),__vite__mapDeps([15,1,9,2,14,16,13,5])));const cp=ds.lazy(()=>Zt(()=>import("./workflowChat-nB5bokwg.js"),__vite__mapDeps([17,1])));ds.lazy(()=>Zt(()=>import("./GalleryModal-BLf4vB6R.js"),__vite__mapDeps([18,1,16,13,2,10,9,4])));function up(){const[t,e]=A.useState(null),[n,r]=A.useState("root"),[o,s]=A.useState(!0),[a,i]=A.useState(null),l=A.useRef(null),[c,u]=A.useState(null),[f,p]=A.useState(!1),d=A.useRef(null),{showDialog:w}=ja(),[h,y]=A.useState(!1);A.useRef(!1);const m=Un(),[v,_]=rp(null),[k,x]=A.useState(!1),I=A.useCallback(async(P=!1)=>{var L;const G=K==null?void 0:K.curWorkflow;if(G){if(!P&&((L=K==null?void 0:K.curWorkflow)!=null&&L.saveLock)){m({title:"The workflow is locked and cannot be saved",status:"warning",duration:3e3});return}const J=JSON.stringify(Se.graph.serialize());await Promise.all([K==null?void 0:K.updateFlow(G.id,{json:J}),ct==null?void 0:ct.create({workflowID:G.id,json:J,isAutoSave:!1})]),p(!1)}},[]),E=async()=>{var G,L;if(confirm("Are you sure you want to discard unsaved changes? This will revert current workflow to your last saved version. You will lose all changes made since your last save.")){const J=(G=K==null?void 0:K.curWorkflow)==null?void 0:G.id;if(J==null)return;const M=(L=await(K==null?void 0:K.get(J)))==null?void 0:L.json;M?(K==null||K.updateCurWorkflow({...K.curWorkflow,json:M}),await Se.loadGraphData(JSON.parse(M)),p(!1)):alert("Error: No last saved version found")}},N=P=>{const G=(P==null?void 0:P.id)??null;if(K==null||K.updateCurWorkflow(P),l.current=G,i(G),e((P==null?void 0:P.name)??""),G==null){document.title="ComfyUI",window.location.hash="",localStorage.removeItem("curFlowID");return}if(ba()){const L=el(G);window.location.hash=L,document.title=P.name+" - ComfyUI"}else localStorage.setItem("curFlowID",G),document.title="ComfyUI - "+P.name;P&&(K==null||K.updateLastOpenedTime(P.id))},D=async()=>{localStorage.removeItem("workspace"),localStorage.removeItem("comfyspace");try{await ih()}catch(J){console.error("🦄Workspace Manager - Error loading db",J)}s(!1);const P=ba();if(P!=null&&R(P),ke("/workspace/deduplicate_workflow_ids"),ke("/workspace/get_os").then(J=>J.json()).then(J=>{J.os&&(Ws.os=J.os)}),!await(V==null?void 0:V.getSetting("twoWaySync"))){if(await de.workflows.count()==0){await(V==null?void 0:V.upsert({twoWaySync:!0})),await de.cache.put({id:_a,value:"true"});return}const M=await(V==null?void 0:V.getSetting("myWorkflowsDir"));w(C.jsx(lp,{myWorkflowsDir:M??"undefined"}),[{label:"I have downloaded all my workflows and ready to enable",onClick:async()=>{await(V==null?void 0:V.upsert({twoWaySync:!0})),await(V==null?void 0:V.getSetting("twoWaySync"))&&(de.cache.put({id:_a,value:"true"}),location.reload())},colorScheme:"red"}],{closeOnOverlayClick:!1})}const L=localStorage.getItem("workspace_manager_shareKey");if(L){const J=Nh(L);J&&u({shareKey:J,username:null})}},R=async(P,G)=>{if(Se.graph==null)return;const L=await(K==null?void 0:K.get(P));if(L==null){alert("Error: Workflow not found! id: "+P),N(null);return}const J=G?await(Ne==null?void 0:Ne.get(G)):null;Se.ui.dialog.close(),J?(_(J),N({...L,json:J.json}),Se.loadGraphData(JSON.parse(J.json))):(N(L),_(null),Se.loadGraphData(JSON.parse(L.json))),r("root"),f&&p(!1)},H=async(P,G,L=!1)=>{var J;if(P===null){N(null),Se.graph.clear();return}if(!f||L||(K==null?void 0:K.curWorkflow)==null||(J=V==null?void 0:V.settings)!=null&&J.disableUnsavedWarning){R(P,G);return}j(P)},j=async P=>{var L;const G=[P?{label:"Open in new tab",icon:C.jsx(gh,{}),onClick:()=>{Qf(P)}}:null,{label:"Save",colorScheme:"teal",onClick:async()=>{await I(),P&&R(P)}}];G.push({label:"Discard",colorScheme:"red",onClick:async()=>{P&&R(P)}}),w(`Please save or discard your changes to "${(L=K==null?void 0:K.curWorkflow)==null?void 0:L.name}" before leaving, or your changes will be lost.`,G)},T=async P=>{const G=(P==null?void 0:P.json)??JSON.stringify(tl),L=await(K==null?void 0:K.createFlow({json:G,name:P==null?void 0:P.name}));L&&await H(L.id),r("root")},b=async(P,G=!1)=>{const L=P.split("/").pop()??P;G?I():T({name:L});const J=await fetch(Xf(P)),M=await J.blob(),B=new File([M],L,{type:J.headers.get("Content-Type")||""});await Se.handleFile(B),r("root")},$=async(P,G)=>{const L=await(K==null?void 0:K.get(P));if(L==null)return;const J=await(K==null?void 0:K.createFlow({json:L.json,name:G||L.name,parentFolderID:L.parentFolderID}));J&&await H(J.id)},ee=A.useCallback(P=>{if(l.current==null)return;let G=P.filename;P.subfolder!=null&&P.subfolder!==""&&(G=P.subfolder+"/"+G),_r==null||_r.create({workflowID:l.current,localPath:G})},[]);return A.useEffect(()=>{D(),y(!0);const P=G=>{var L,J,M,B,ne,X;(M=(J=(L=G.detail)==null?void 0:L.output)==null?void 0:J.images)==null||M.forEach(Z=>{Z.type==="output"&&ee(Z)}),(X=(ne=(B=G.detail)==null?void 0:B.output)==null?void 0:ne.gifs)==null||X.forEach(Z=>{Z.type==="output"&&ee(Z)})};return bo.addEventListener("executed",P),()=>{window.removeEventListener("executed",P)}},[]),o?null:C.jsx(tt.Provider,{value:{curFlowID:a,onDuplicateWorkflow:$,loadWorkflowID:H,discardUnsavedChanges:E,saveCurWorkflow:I,isDirty:f,setIsDirty:p,loadNewWorkflow:T,loadFilePath:b,setRoute:r,route:n,curVersion:v,setCurVersion:_,setCurFlowIDAndName:N,session:c,updateSession:u},children:C.jsx("div",{ref:d,className:"workspace_manager",children:C.jsxs(Ia,{containerRef:d,children:[C.jsxs(Dt,{style:{position:"absolute",top:0,right:0,left:0},zIndex:eh,draggable:!1,children:[C.jsx(Qh,{curFlowName:t,setCurFlowName:e,onChatClick:()=>x(!0),showChat:k}),k&&C.jsx(cp,{onClose:()=>x(!1)})]}),C.jsx(ep,{})]})})})}const Mp=Object.freeze(Object.defineProperty({__proto__:null,default:up},Symbol.toStringTag,{value:"Module"}));export{al as $,ah as A,Dt as B,kp as C,Dh as D,qf as E,rn as F,wh as G,Ot as H,mn as I,lt as J,Vr as K,Gr as L,ci as M,Zr as N,Ch as O,tl as P,Bp as Q,Np as R,pd as S,yt as T,gr as U,Op as V,tt as W,sh as X,xp as Y,gh as Z,Qf as _,mp as a,$h as a0,ke as a1,_r as a2,Yf as a3,at as a4,Gl as a5,eh as a6,vp as a7,wr as a8,Ep as a9,Dp as aA,Ls as aB,fs as aC,Bh as aD,Rp as aE,Fp as aF,cl as aG,Th as aH,Tp as aI,Mp as aJ,Ra as aa,rc as ab,Sp as ac,hs as ad,nn as ae,oc as af,Be as ag,Ip as ah,Cp as ai,Tl as aj,qn as ak,Ss as al,de as am,gp as an,jp as ao,Ap as ap,wp as aq,bp as ar,kc as as,di as at,ui as au,mi as av,hi as aw,Pp as ax,rp as ay,rh as az,hp as b,pp as c,Re as d,Un as e,It as f,Pt as g,V as h,lp as i,Gd as j,eo as k,An as l,Ec as m,yp as n,_p as o,ko as p,Es as q,Cs as r,Fh as s,pt as t,Jr as u,vh as v,K as w,Oh as x,ip as y,yh as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["workspace_web/ShareDialog-fFfeioXS.js","workspace_web/input.js","workspace_web/chunk-7D6N5TE5-g85hrhBT.js","workspace_web/civitUtils-MvenoBWp.js","workspace_web/chunk-VTV6N5LE-Gb3pqt6B.js","workspace_web/IconCopy-rk-TpGrF.js","workspace_web/AppIsDirtyEventListener-fgtmiWGE.js","workspace_web/useDebounceFn-ld478fd0.js","workspace_web/ModelManagerTopbar-feTKvyin.js","workspace_web/chunk-JARCRF6W-lX6Qjipv.js","workspace_web/chunk-3RSXBRAN-Rn6RuJQl.js","workspace_web/assets/ModelManagerTopbar--iv3sdjQ.css","workspace_web/SpotlightSearch-cM79l8wS.js","workspace_web/IconSearch-TFFp4TLY.js","workspace_web/chunk-NTCQBYKE-ly4hZSe1.js","workspace_web/RecentFilesDrawer-qVaC94nF.js","workspace_web/MediaPreview-Yk8lQEM4.js","workspace_web/workflowChat-nB5bokwg.js","workspace_web/GalleryModal-BLf4vB6R.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}